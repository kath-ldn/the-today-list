/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={99:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var r,i,o=n(655),s=n(589),a=n(909),u=n(594),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),h=new s.LL("app","Firebase",c),l="@firebase/app",f="[DEFAULT]",p=((i={})[l]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),d=new u.Yd("@firebase/app"),v=function(){function t(t,e,n){var r,i,u=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,s.p$)(t),this.container=new a.H0(e.name),this._addComponent(new a.wA("app",(function(){return u}),"PUBLIC"));try{for(var c=(0,o.XA)(this.firebase_.INTERNAL.components.values()),h=c.next();!h.done;h=c.next()){var l=h.value;this._addComponent(l)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw h.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var y=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var a=o.name;if("string"!=typeof a||!a)throw h.create("bad-app-name",{appName:String(a)});if((0,s.r3)(e,a))throw h.create("duplicate-app",{appName:a});var u=new t(n,o,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=p[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(u.join(" "))}c(new a.wA(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.Ub,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw h.create("invalid-log-argument",{appName:name});(0,u.Am)(t,e)},apps:null,SDK_VERSION:"8.2.5",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,s.r3)(e,t))throw h.create("no-app",{appName:t});return e[t]}function c(a){var u,c,l=a.name;if(n.has(l))return d.debug("There were multiple attempts to register component "+l+"."),"PUBLIC"===a.type?r[l]:null;if(n.set(l,a),"PUBLIC"===a.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[l])throw h.create("invalid-app-argument",{appName:l});return t[l]()};void 0!==a.serviceProps&&(0,s.ZB)(f,a.serviceProps),r[l]=f,t.prototype[l]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,l).apply(this,a.multipleInstances?t:[])}}try{for(var p=(0,o.XA)(Object.keys(e)),v=p.next();!v.done;v=p.next()){var y=v.value;e[y]._addComponent(a)}}catch(t){u={error:t}}finally{try{v&&!v.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return"PUBLIC"===a.type?r[l]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=(0,o.pi)((0,o.pi)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,s.ZB)(e,t)},createSubscribe:s.ne,ErrorFactory:s.LL,deepExtend:s.ZB}),e}(),g=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,s.jU)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=y.initializeApp;y.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,s.UG)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),b.apply(void 0,t)};var _=y;!function(t,e){t.INTERNAL.registerComponent(new a.wA("platform-logger",(function(t){return new g(t)}),"PRIVATE")),t.registerVersion(l,"0.6.14",void 0),t.registerVersion("fire-js","")}(_);const w=_},481:(t,e,n)=>{"use strict";var r=n(99);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function s(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var s=t[o];s in r||(r[s]={}),r=r[s]}(n=n(o=r[t=t[t.length-1]]))!=o&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)a.b(this.a[t]);this.a=null}};var a=new n;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,s=new e((function(t,e){i=t,o=e}));return this.Qa(r(t,i),r(n,o)),s},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=s(t),o=i.next();!o.done;o=i.next())r(o.value).Qa(e,n)}))},e.all=function(t){var n=s(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){s[e]=n,0==--a&&t(s)}}var s=[],a=0;do{s.push(void 0),a++,r(i.value).Qa(o(s.length-1),e),i=n.next()}while(!i.done)}))},e}));var a=a||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,h=null;function l(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function p(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function d(t){var e=p(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==p(t)}function y(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function g(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++b)}var m="closure_uid_"+(1e9*Math.random()>>>0),b=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function E(t,e,n){return(E=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:w).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function A(t,e,n){this.code=P+t,this.message=e||D[t]||"",this.a=n||null}function N(t){var e=t&&t.code;return e?new A(e.substring(P.length),t.message,t.serverResponse):null}S(A,Error),A.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},A.prototype.toJSON=function(){return this.w()};var k,P="auth/",D={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},O={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function R(t){for(var e in O)if(O[e].id===t)return{firebaseEndpoint:(t=O[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function x(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function M(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function F(t,e){throw new M("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function j(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function U(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function V(){this.b=this.a=null}k=R("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(M,L),M.prototype.name="AssertionError",j.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var q=new j((function(){return new G}),(function(t){t.reset()}));function B(){var t=_e,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function G(){this.next=this.b=this.a=null}V.prototype.add=function(t,e){var n=q.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},G.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},G.prototype.reset=function(){this.next=this.b=this.a=null};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},z=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,s=0;s<n;s++)if(s in o){var a=o[s];e.call(void 0,a,s,t)&&(r[i++]=a)}return r},K=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},J=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Q(t,e){return 0<=W(t,e)}function Y(t,e){var n;return(n=0<=(e=W(t,e)))&&Array.prototype.splice.call(t,e,1),n}function X(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function Z(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,st=/'/g,at=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function ht(t,e){return t<e?-1:t>e?1:0}t:{var lt=u.navigator;if(lt){var ft=lt.userAgent;if(ft){tt=ft;break t}}tt=""}function pt(t){return ct(tt,t)}function dt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function yt(t){var e,n={};for(e in t)n[e]=t[e];return n}var gt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<gt.length;o++)n=gt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(y(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function _t(t,e){this.a=t===Tt&&e||"",this.b=It}function wt(t){return t instanceof _t&&t.constructor===_t&&t.b===It?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a},_t.prototype.toString=function(){return"Const{"+this.a+"}"};var Et,It={},Tt={};function St(){if(void 0===Et){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){u.console&&u.console.error(t.message)}Et=t}else Et=t}return Et}function Ct(t,e){this.a=e===Dt?t:""}function At(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+p(t)),"type_error:TrustedResourceUrl")}function Nt(t,e){var n=wt(t);if(!Pt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,Dt)}(t=n.replace(kt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof _t?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.sa=!0,Ct.prototype.ra=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,Pt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Dt={};function Ot(t,e){this.a=e===Ut?t:""}function Rt(t){return t instanceof Ot&&t.constructor===Ot?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+p(t)),"type_error:SafeUrl")}Ot.prototype.sa=!0,Ot.prototype.ra=function(){return this.a.toString()},Ot.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var xt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof Ot)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t))t=new Ot(t,Ut);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&xt.test(e[1])?new Ot(t,Ut):null}return t}function jt(t){return t instanceof Ot?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new Ot(t,Ut))}var Ut={},Vt=new Ot("about:invalid#zClosurez",Ut);function qt(t,e,n){this.a=n===Bt?t:""}qt.prototype.sa=!0,qt.prototype.ra=function(){return this.a.toString()},qt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Gt(t,e,n,r){return t=t instanceof Ot?t:jt(t),e=e||u,n=n instanceof _t?wt(n):n||"",e.open(Rt(t),n,r,void 0)}function Wt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ht(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(st,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(at,"&#0;"))),t}function zt(t){return zt[" "](t),t}zt[" "]=f;var Kt,Jt,Qt=pt("Opera"),Yt=pt("Trident")||pt("MSIE"),Xt=pt("Edge"),Zt=Xt||Yt,$t=pt("Gecko")&&!(ct(tt.toLowerCase(),"webkit")&&!pt("Edge"))&&!(pt("Trident")||pt("MSIE"))&&!pt("Edge"),te=ct(tt.toLowerCase(),"webkit")&&!pt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=(Jt=tt,$t?/rv:([^\);]+)(\)|;)/.exec(Jt):Xt?/Edge\/([\d\.]+)/.exec(Jt):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Jt):te?/WebKit\/(\S+)/.exec(Jt):Qt?/(?:Version)[ \/]?(\S+)/.exec(Jt):void 0);if(re&&(ne=re?re[1]:""),Yt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){Kt=String(ie);break t}}Kt=ne}var oe,se={};function ae(t){return function(t,e){var n=se;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=et(String(Kt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ht(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ht(0==s[2].length,0==a[2].length)||ht(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}u.document&&Yt?oe=ee()||parseInt(Kt,10)||void 0:oe=void 0;var ue=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Jt){}var ce=!Yt||9<=Number(ue);function he(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function le(t,e){dt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:de.hasOwnProperty(n)?t.setAttribute(de[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,pe,de={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||y(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(y(o)){var s="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){s="function"==typeof o.item;break t}}s=!1}H(s?$(o):o,r)}}}function ye(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ge(t){u.setTimeout((function(){throw t}),0)}function me(t,e){pe||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);pe=function(){t.then(we)}}else pe=function(){var t=we;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!pt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(fe||(fe=function(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!pt("Presto")&&(t=function(){var t=ye(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=E((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!pt("Trident")&&!pt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){r.next={Gb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),fe(t)):u.setImmediate(t)}}(),be||(pe(),be=!0),_e.add(t,e)}var be=!1,_e=new V;function we(){for(var t;t=B();){try{t.a.call(t.b)}catch(t){ge(t)}U(q,t)}be=!1}function Ee(t,e){if(this.a=Ie,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Me(n,Te,t)}),(function(t){if(!(t instanceof Ge))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Me(n,Se,t)}))}catch(t){Me(this,Se,t)}}var Ie=0,Te=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ae=new j((function(){return new Ce}),(function(t){t.reset()}));function Ne(t,e,n){var r=Ae.get();return r.g=t,r.b=e,r.f=n,r}function ke(t){if(t instanceof Ee)return t;var e=new Ee(f);return Me(e,Te,t),e}function Pe(t){return new Ee((function(e,n){n(t)}))}function De(t,e,n){Fe(t,e,n,null)||me(I(e,t))}function Oe(t){return new Ee((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)De(t[o],I(i,o,!0),I(i,o,!1));else e(r)}))}function Re(t,e){if(t.a==Ie)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,s=n.b;s&&(s.c||(r++,s.a==t&&(i=s),!(i&&1<r)));s=s.next)i||(o=s);i&&(n.a==Ie&&1==r?Re(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):Ue(n),Ve(n,i,Se,e)))}t.c=null}else Me(t,Se,e)}function xe(t,e){t.b||t.a!=Te&&t.a!=Se||je(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ne(null,null,null);return i.a=new Ee((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ge?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,xe(t,i),i.a}function Me(t,e,n){t.a==Ie&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,je(t),e!=Se||n instanceof Ge||function(t,e){t.g=!0,me((function(){t.g&&Be.call(null,e)}))}(t,n)))}function Fe(t,e,n,r){if(t instanceof Ee)return xe(t,Ne(e||f,n||null,r)),!0;if(x(t))return t.then(e,n,r),!0;if(y(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,(function(t){s||(s=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function je(t){t.h||(t.h=!0,me(t.gc,t))}function Ue(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Ve(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,qe(e,n,r);else try{e.c?e.g.call(e.f):qe(e,n,r)}catch(t){Be.call(null,t)}U(Ae,e)}function qe(t,e,n){e==Te?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ee.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},Ee.prototype.$goog_Thenable=!0,(t=Ee.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,xe(this,t),this},t.o=function(t,e){return Le(this,null,t,e)},t.cancel=function(t){if(this.a==Ie){var e=new Ge(t);me((function(){Re(this,e)}),this)}},t.$c=function(t){this.a=Ie,Me(this,Te,t)},t.ad=function(t){this.a=Ie,Me(this,Se,t)},t.gc=function(){for(var t;t=Ue(this);)Ve(this,t,this.a,this.i);this.h=!1};var Be=ge;function Ge(t){L.call(this,t)}function We(){0!=He&&(ze[g(this)]=this),this.xa=this.xa,this.pa=this.pa}S(Ge,L),Ge.prototype.name="cancel";var He=0,ze={};function Ke(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=He)){var e=g(t);if(0!=He&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}We.prototype.xa=!1,We.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Je=Object.freeze||function(t){return t},Qe=!Yt||9<=Number(ue),Ye=Yt&&!ae("9"),Xe=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function Ze(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function $e(t,e){if(Ze.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if($t){t:{try{zt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ze.prototype.preventDefault=function(){this.defaultPrevented=!0},S($e,Ze);var tn=Je({2:"touch",3:"pen",4:"mouse"});$e.prototype.preventDefault=function(){$e.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ye)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},$e.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Va=i,this.key=++nn,this.va=this.Pa=!1}function on(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function sn(t){this.src=t,this.a={},this.b=0}function an(t,e){var n=e.type;n in t.a&&Y(t.a[n],e)&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function un(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Va==r)return i}return-1}sn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=un(t,e,r,i);return-1<s?(e=t[s],n||(e.Pa=!1)):((e=new rn(e,this.src,o,!!r,i)).Pa=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),hn={};function ln(t,e,n,r,i){if(r&&r.once)pn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);else n=En(n),t&&t[en]?Tn(t,e,n,y(r)?!!r.capture:!!r,i):fn(t,e,n,!1,r,i)}function fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=y(i)?!!i.capture:!!i,a=_n(t);if(a||(t[cn]=a=new sn(t)),!(n=a.add(e,n,r,s,o)).proxy)if(r=function(){var t=bn,e=Qe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Xe||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else n=En(n),t&&t[en]?Sn(t,e,n,y(r)?!!r.capture:!!r,i):fn(t,e,n,!0,r,i)}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else r=y(r)?!!r.capture:!!r,n=En(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=un(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=_n(t))&&(e=t.a[e.toString()],t=-1,e&&(t=un(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[en])an(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_n(e))?(an(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function yn(t){return t in hn?hn[t]:hn[t]="on"+t}function gn(t,e,n,r){var i=!0;if((t=_n(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=mn(o,r),i=i&&!1!==o)}return i}function mn(t,e){var n=t.listener,r=t.Va||t.src;return t.Pa&&vn(t),n.call(r,e)}function bn(t,e){if(t.va)return!0;if(!Qe){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new $e(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=gn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=gn(r[i],t,!1,e),n=n&&o}return n}return mn(t,new $e(e,this))}function _n(t){return(t=t[cn])instanceof sn?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function En(t){return v(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function In(){We.call(this),this.v=new sn(this),this.ac=this,this.gb=null}function Tn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Sn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Cn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.va&&s.capture==n){var a=s.listener,u=s.Va||s.src;s.Pa&&an(t.v,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}function An(t,e,n){if(v(t))n&&(t=E(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=E(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Nn(t){var e=null;return new Ee((function(n,r){-1==(e=An((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function kn(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Pn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Dn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Dn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function On(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Rn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Rn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(In,We),In.prototype[en]=!0,In.prototype.addEventListener=function(t,e,n,r){ln(this,t,e,n,r)},In.prototype.removeEventListener=function(t,e,n,r){dn(this,t,e,n,r)},In.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var r=t.type||t;if("string"==typeof t)t=new Ze(t,n);else if(t instanceof Ze)t.target=t.target||n;else{var i=t;mt(t=new Ze(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=Cn(s,r,!0,t)&&i}if(i=Cn(s=t.b=n,r,!0,t)&&i,i=Cn(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Cn(s=t.b=e[o],r,!1,t)&&i;return i},In.prototype.Da=function(){if(In.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.gb=null},(t=Dn.prototype).W=function(){On(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return On(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Rn(this.b,t)?this.b[t]:e},t.set=function(t,e){Rn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Mn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,jn(this,rr(t.b)),this.h=t.h):t&&(n=String(t).match(xn))?(this.i=!!e,Mn(this,n[1]||"",!0),this.l=Gn(n[2]||""),this.a=Gn(n[3]||"",!0),Fn(this,n[4]),this.f=Gn(n[5]||"",!0),jn(this,n[6]||"",!0),this.h=Gn(n[7]||"")):(this.i=!!e,this.b=new Xn(null,this.i))}function Mn(t,e,n){t.c=n?Gn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function jn(t,e,n){e instanceof Xn?(t.b=e,function(t,e){e&&!t.f&&(Zn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(tr(this,e),nr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Wn(e,Qn)),t.b=new Xn(e,t.i))}function Un(t,e,n){t.b.set(e,n)}function Vn(t,e){return t.b.get(e)}function qn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Bn(t,e,n,r){var i=new Ln(null,void 0);return t&&Mn(i,t),e&&(i.a=e),n&&Fn(i,n),r&&(i.f=r),i}function Gn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Wn(e,zn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Wn(e,zn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Wn(n,"/"==n.charAt(0)?Jn:Kn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Wn(n,Yn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Mn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?jn(e,rr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var zn=/[#\/\?@]/g,Kn=/[#\?:]/g,Jn=/[#\?]/g,Qn=/[#\?@]/g,Yn=/#/g;function Xn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Zn(t){t.a||(t.a=new Dn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $n(t){var e=Pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Xn(null,void 0);t=kn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function tr(t,e){Zn(t),e=ir(t,e),Rn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Rn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&On(t)))}function er(t,e){return Zn(t),e=ir(t,e),Rn(t.a.b,e)}function nr(t,e,n){tr(t,e),0<n.length&&(t.c=null,t.a.set(ir(t,e),$(n)),t.b+=n.length)}function rr(t){var e=new Xn;return e.c=t.c,t.a&&(e.a=new Dn(t.a),e.b=t.b),e}function ir(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function or(t){var e=[];return ar(new sr,t,e),e.join("")}function sr(){}function ar(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),ar(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),hr(r,n),n.push(":"),ar(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":hr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Xn.prototype).add=function(t,e){Zn(this),this.c=null,t=ir(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Zn(this),this.a.forEach((function(n,r){H(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Zn(this);for(var t=this.a.W(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.W=function(t){Zn(this);var e=[];if("string"==typeof t)er(this,t)&&(e=Z(e,this.a.get(ir(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=Z(e,t[n])}return e},t.set=function(t,e){return Zn(this),this.c=null,er(this,t=ir(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.W(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var ur={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},cr=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function hr(t,e){e.push('"',t.replace(cr,(function(t){var e=ur[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ur[t]=e),e})),'"')}function lr(){var t=Dr();return Yt&&!!ue&&11==ue||/Edge\/\d+/.test(t)}function fr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function pr(t,e){e=e||u.window;var n="about:blank";t&&(n=Rt(Ft(t)||Vt)),e.location.href=n}function dr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<dr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function vr(t){return!!((t=(t||Dr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function yr(t){t=t||u.window;try{t.close()}catch(t){}}function gr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Dr().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Nr(Dr())==Cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Ot?n:Ft(void 0!==n.href?n.href:String(n))||Vt,n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((pt("iPhone")&&!pt("iPod")&&!pt("iPad")||pt("iPad")||pt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(s=ye(document,"A"),"HTMLAnchorElement"),e=e instanceof Ot?e:jt(e),s.href=Rt(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=Gt("",r,n,s),t=Rt(e),s&&(Zt&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ht(t)+'">',t=new qt(t=(r=St())?r.createHTML(t):t,null,Bt),r=s.document)&&(r.write(function(t){return t instanceof qt&&t.constructor===qt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+p(t)),"type_error:SafeHtml")}(t)),r.close())):(s=Gt(e,r,n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^[^@]+@[^@]+$/;function _r(){var t=null;return new Ee((function(e){"complete"==u.document.readyState?e():(t=function(){e()},pn(window,"load",t))})).o((function(e){throw dn(window,"load",t),e}))}function wr(t){return t=t||Dr(),!("file:"!==Mr()&&"ionic:"!==Mr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Er(){var t=u.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Ir(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function Tr(){return r.Z.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.Z.INTERNAL.hasOwnProperty("node")?"Node":Ir()?"Worker":"Browser"}function Sr(){var t=Tr();return"ReactNative"===t||"Node"===t}var Cr="Firefox",Ar="Chrome";function Nr(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?Cr:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Ar:"Safari"}var kr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Pr(t,e){e=e||[];var n,r=[],i={};for(n in kr)i[kr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Tr())?r=Nr(i=Dr()):"Worker"===r&&(r=Nr(i=Dr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Dr(){return u.navigator&&u.navigator.userAgent||""}function Or(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Rr(){try{var t=u.localStorage,e=qr();if(t)return t.setItem(e,"1"),t.removeItem(e),!lr()||!!u.indexedDB}catch(t){return Ir()&&!!u.indexedDB}return!1}function xr(){return(Lr()||"chrome-extension:"===Mr()||wr())&&!Sr()&&Rr()&&!Ir()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return u.location&&u.location.protocol||null}function Fr(t){return!vr(t=t||Dr())&&Nr(t)!=Cr}function jr(t){return void 0===t?null:or(t)}function Ur(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Vr(t){if(null!==t)return JSON.parse(t)}function qr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return"Safari"!=Nr(t=t||Dr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Gr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Wr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Dr(),e=Tr(),this.b=vr(t)||"ReactNative"===e}function Hr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function zr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Kr(){return!(!Or("fireauth.oauthhelper",u)&&!Or("fireauth.iframe",u))}Wr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Lr()&&"chrome-extension:"!==Mr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Jr,Qr={};function Yr(t){Qr[t]||(Qr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Xr={};Object.defineProperty(Xr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Xr,"abcd",{configurable:!0,enumerable:!0,value:2}),Jr=2==Xr.abcd}catch(Jt){Jr=!1}function Zr(t,e,n){Jr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function $r(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Zr(t,n,e[n])}function ti(t){var e={};return $r(e,t),e}function ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Zr(e,n,ei(t[n]));return e}function ni(t){var e=t&&(t[ai]?"phone":null);if(!(e&&t&&t[si]))throw new A("internal-error","Internal assert: invalid MultiFactorInfo object");Zr(this,"uid",t[si]),Zr(this,"displayName",t[ii]||null);var n=null;t[oi]&&(n=new Date(t[oi]).toUTCString()),Zr(this,"enrollmentTime",n),Zr(this,"factorId",e)}function ri(t){try{var e=new ui(t)}catch(t){e=null}return e}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",si="mfaEnrollmentId",ai="phoneInfo";function ui(t){ni.call(this,t),Zr(this,"phoneNumber",t[ai])}function ci(t){var e={},n=t[pi],r=t[vi],i=t[yi];if(t=ri(t[di]),!i||i!=li&&i!=fi&&!n||i==fi&&!r||i==hi&&!t)throw Error("Invalid checkActionCode response!");i==fi?(e[mi]=n||null,e[_i]=n||null,e[gi]=r):(e[mi]=r||null,e[_i]=r||null,e[gi]=n||null),e[bi]=t||null,Zr(this,Ei,i),Zr(this,wi,ei(e))}S(ui,ni),ui.prototype.w=function(){var t=ui.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var hi="REVERT_SECOND_FACTOR_ADDITION",li="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",pi="email",di="mfaInfo",vi="newEmail",yi="requestType",gi="email",mi="fromEmail",bi="multiFactorInfo",_i="previousEmail",wi="data",Ei="operation";function Ii(t){var e=Vn(t=qn(t),Ti)||null,n=Vn(t,Si)||null,r=Vn(t,Ni)||null;if(r=r&&Pi[r]||null,!e||!n||!r)throw new A("argument-error",Ti+", "+Si+"and "+Ni+" are required in a valid action code URL.");$r(this,{apiKey:e,operation:r,code:n,continueUrl:Vn(t,Ci)||null,languageCode:Vn(t,Ai)||null,tenantId:Vn(t,ki)||null})}var Ti="apiKey",Si="oobCode",Ci="continueUrl",Ai="languageCode",Ni="mode",ki="tenantId",Pi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:hi,signIn:li,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Di(t){try{return new Ii(t)}catch(t){return null}}function Oi(t){var e=t[Fi];if(void 0===e)throw new A("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new A("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Ri];if(n&&"object"==typeof n){e=n[Vi];var r=n[ji];if(n=n[Ui],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new A("argument-error",ji+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new A("argument-error",Ui+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new A("argument-error",Vi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new A("missing-android-pkg-name")}}else if(void 0!==n)throw new A("argument-error",Ri+" property must be a non null object when specified.");if(this.f=null,(e=t[Mi])&&"object"==typeof e){if("string"==typeof(e=e[qi])&&e.length)this.f=e;else if(void 0!==e)throw new A("argument-error",qi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new A("argument-error",Mi+" property must be a non null object when specified.");if(void 0!==(e=t[Li])&&"boolean"!=typeof e)throw new A("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[xi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new A("argument-error",xi+" property must be a non empty string when specified.");this.i=t||null}var Ri="android",xi="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Fi="url",ji="installApp",Ui="minimumVersion",Vi="packageName",qi="bundleId";function Bi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Gi=null;function Wi(t){var e=zi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Hi(t){try{return new Wi(t)}catch(t){return null}}function zi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=function(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Gi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Gi){Gi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Gi[o]&&(Gi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;e(i<<2|o>>4),64!=s&&(e(o<<4&240|s>>2),64!=a&&e(s<<6&192|a))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var s=r[e++],a=((7&i)<<18|(63&o)<<12|(63&s)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(a>>10)),t[n++]=String.fromCharCode(56320+(1023&a))}else o=r[e++],s=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}return JSON.parse(t.join(""))}catch(t){}return null}Wi.prototype.T=function(){return this.f},Wi.prototype.l=function(){return this.c},Wi.prototype.toString=function(){return this.h};var Ki="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Ji=["client_id","response_type","scope","redirect_uri","state"],Qi={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Ji},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Ji},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Ji},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:Ki},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Yi(t){for(var e in Qi)if(Qi[e].fa==t)return Qi[e];return null}function Xi(t){var e={};e["facebook.com"]=no,e["google.com"]=io,e["github.com"]=ro,e["twitter.com"]=oo;var n=t&&t[$i];try{if(n)return e[n]?new e[n](t):new eo(t);if(void 0!==t[Zi])return new to(t)}catch(t){}return null}var Zi="idToken",$i="providerId";function to(t){var e=t[$i];if(!e&&t[Zi]){var n=Hi(t[Zi]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Zr(this,"providerId",e),Zr(this,"isNewUser",n)}function eo(t){to.call(this,t),Zr(this,"profile",ei((t=Vr(t.rawUserInfo||"{}"))||{}))}function no(t){if(eo.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ro(t){if(eo.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",this.profile&&this.profile.login||null)}function io(t){if(eo.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function oo(t){if(eo.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",t.screenName||null)}function so(t){var e=qn(t),n=Vn(e,"link"),r=Vn(qn(n),"link");return e=Vn(e,"deep_link_id"),Vn(qn(e),"link")||e||r||n||t}function ao(t,e){if(!t&&!e)throw new A("internal-error","Internal assert: no raw session string available");if(t&&e)throw new A("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?uo:co}S(eo,to),S(no,eo),S(ro,eo),S(io,eo),S(oo,eo);var uo="enroll",co="signin";function ho(){}function lo(t,e){return t.then((function(t){if(t[$s]){var n=Hi(t[$s]);if(!n||e!=n.i)throw new A("user-mismatch");return t}throw new A("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==P+"user-not-found"?new A("user-mismatch"):t}))}function fo(t,e){if(!e)throw new A("internal-error","failed to construct a credential");this.a=e,Zr(this,"providerId",t),Zr(this,"signInMethod",t)}function po(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function vo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new fo(t.providerId,t.pendingToken)}catch(t){}return null}function yo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Zr(this,"idToken",e.idToken),e.accessToken&&Zr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Zr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new A("internal-error","failed to construct a credential");Zr(this,"accessToken",e.oauthToken),Zr(this,"secret",e.oauthTokenSecret)}Zr(this,"providerId",t),Zr(this,"signInMethod",n)}function go(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:$n(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function mo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new yo(t.providerId,e,t.signInMethod)}catch(t){}}return null}function bo(t,e){this.Qc=e||[],$r(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Yi(t)||{}).Ja||null,this.ob=null}function _o(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new A("argument-error",'SAML provider IDs must be prefixed with "saml."');bo.call(this,t,[])}function wo(t){bo.call(this,t,Ji),this.a=[]}function Eo(){wo.call(this,"facebook.com")}function Io(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new Eo).credential({accessToken:e})}function To(){wo.call(this,"github.com")}function So(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return y(t)&&(e=t.accessToken),(new To).credential({accessToken:e})}function Co(){wo.call(this,"google.com"),this.Ca("profile")}function Ao(t,e){var n=t;return y(t)&&(n=t.idToken,e=t.accessToken),(new Co).credential({idToken:n,accessToken:e})}function No(){bo.call(this,"twitter.com",Ki)}function ko(t,e){var n=t;if(y(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new A("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new yo("twitter.com",n,"twitter.com")}function Po(t,e,n){this.a=t,this.f=e,Zr(this,"providerId","password"),Zr(this,"signInMethod",n===Oo.EMAIL_LINK_SIGN_IN_METHOD?Oo.EMAIL_LINK_SIGN_IN_METHOD:Oo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Do(t){return t&&t.email&&t.password?new Po(t.email,t.password,t.signInMethod):null}function Oo(){$r(this,{providerId:"password",isOAuthProvider:!1})}function Ro(t,e){if(!(e=xo(e)))throw new A("argument-error","Invalid email link!");return new Po(t,e.code,Oo.EMAIL_LINK_SIGN_IN_METHOD)}function xo(t){return(t=Di(t=so(t)))&&t.operation===li?t:null}function Lo(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new A("internal-error");this.a=t,Zr(this,"providerId","phone"),this.fa="phone",Zr(this,"signInMethod","phone")}function Mo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return H(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Lo(e)}return null}function Fo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function jo(t){try{this.a=t||r.Z.auth()}catch(t){throw new A("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}$r(this,{providerId:"phone",isOAuthProvider:!1})}function Uo(t,e){if(!t)throw new A("missing-verification-id");if(!e)throw new A("missing-verification-code");return new Lo({eb:t,cb:e})}function Vo(t){if(t.temporaryProof&&t.phoneNumber)return new Lo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return Ao(o,n);case"facebook.com":return Io(n);case"github.com":return So(n);case"twitter.com":return ko(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new fo(e,s):new yo(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new wo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function qo(t){if(!t.isOAuthProvider)throw new A("invalid-oauth-provider")}function Bo(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new A("invalid-auth-event");if(this.g&&this.a)throw new A("invalid-auth-event");if(this.g&&!this.f)throw new A("invalid-auth-event")}function Go(t){return(t=t||{}).type?new Bo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&N(t.error),t.postBody,t.tenantId):null}function Wo(){this.b=null,this.a=[]}ao.prototype.Ha=function(){return this.a?ke(this.a):ke(this.b)},ao.prototype.w=function(){return this.type==uo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ho.prototype.ka=function(){},ho.prototype.b=function(){},ho.prototype.c=function(){},ho.prototype.w=function(){},fo.prototype.ka=function(t){return _a(t,po(this))},fo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,wa(t,n)},fo.prototype.c=function(t,e){return lo(Ea(t,po(this)),e)},fo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},yo.prototype.ka=function(t){return _a(t,go(this))},yo.prototype.b=function(t,e){var n=go(this);return n.idToken=e,wa(t,n)},yo.prototype.c=function(t,e){return lo(Ea(t,go(this)),e)},yo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},bo.prototype.Ka=function(t){return this.Ib=yt(t),this},S(_o,bo),S(wo,bo),wo.prototype.Ca=function(t){return Q(this.a,t)||this.a.push(t),this},wo.prototype.Qb=function(){return $(this.a)},wo.prototype.credential=function(t,e){var n;if(!(n=y(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new A("argument-error","credential failed: must provide the ID token and/or the access token.");return new yo(this.providerId,n,this.providerId)},S(Eo,wo),Zr(Eo,"PROVIDER_ID","facebook.com"),Zr(Eo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(To,wo),Zr(To,"PROVIDER_ID","github.com"),Zr(To,"GITHUB_SIGN_IN_METHOD","github.com"),S(Co,wo),Zr(Co,"PROVIDER_ID","google.com"),Zr(Co,"GOOGLE_SIGN_IN_METHOD","google.com"),S(No,bo),Zr(No,"PROVIDER_ID","twitter.com"),Zr(No,"TWITTER_SIGN_IN_METHOD","twitter.com"),Po.prototype.ka=function(t){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Pa,{email:this.a,oobCode:this.f}):ru(t,Za,{email:this.a,password:this.f})},Po.prototype.b=function(t,e){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Da,{idToken:e,email:this.a,oobCode:this.f}):ru(t,Wa,{idToken:e,email:this.a,password:this.f})},Po.prototype.c=function(t,e){return lo(this.ka(t),e)},Po.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},$r(Oo,{PROVIDER_ID:"password"}),$r(Oo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),$r(Oo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Lo.prototype.ka=function(t){return t.fb(Fo(this))},Lo.prototype.b=function(t,e){var n=Fo(this);return n.idToken=e,ru(t,tu,n)},Lo.prototype.c=function(t,e){var n=Fo(this);return n.operation="REAUTH",lo(t=ru(t,eu,n),e)},Lo.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},jo.prototype.fb=function(t,e){var n=this.a.a;return ke(e.verify()).then((function(r){if("string"!=typeof r)throw new A("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=y(t)?t.session:null,o=y(t)?t.phoneNumber:t;return(i&&i.type==uo?i.Ha().then((function(t){return function(t,e){return ru(t,za,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==co?i.Ha().then((function(e){return function(t,e){return ru(t,Ka,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return ru(t,Ba,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new A("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},$r(jo,{PROVIDER_ID:"phone"}),$r(jo,{PHONE_SIGN_IN_METHOD:"phone"}),Bo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Bo.prototype.T=function(){return this.h},Bo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Ho,zo=null;function Ko(t){var e="unauthorized-domain",n=void 0,r=qn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Wt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Wt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",A.call(this,e,n)}function Jo(t,e,n){A.call(this,t,n),(t=e||{}).Jb&&Zr(this,"email",t.Jb),t.ea&&Zr(this,"phoneNumber",t.ea),t.credential&&Zr(this,"credential",t.credential),t.Zb&&Zr(this,"tenantId",t.Zb)}function Qo(t){if(t.code){var e=t.code||"";0==e.indexOf(P)&&(e=e.substring(P.length));var n={credential:Vo(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new A(e,t.message||void 0);return new Jo(e,n,t.message)}return null}function Yo(){}function Xo(t){return t.c||(t.c=t.b())}function Zo(){}function $o(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ts(){}function es(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=E(this.qc,this),this.a.onerror=E(this.Sb,this),this.a.onprogress=E(this.rc,this),this.a.ontimeout=E(this.vc,this)}function ns(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function rs(t,e,n){this.reset(t,e,n,void 0,void 0)}function is(t){this.f=t,this.b=this.c=this.a=null}function os(t,e){this.name=t,this.value=e}S(Ko,A),S(Jo,A),Jo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},Jo.prototype.toJSON=function(){return this.w()},Yo.prototype.c=null,S(Zo,Yo),Zo.prototype.a=function(){var t=$o(this);return t?new ActiveXObject(t):new XMLHttpRequest},Zo.prototype.b=function(){var t={};return $o(this)&&(t[0]=!0,t[1]=!0),t},Ho=new Zo,S(ts,Yo),ts.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new es;throw Error("Unsupported browser")},ts.prototype.b=function(){return{}},(t=es.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ns(this,4)},t.Sb=function(){this.status=500,this.response=this.responseText="",ns(this,4)},t.vc=function(){this.Sb()},t.rc=function(){this.status=200,ns(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},rs.prototype.a=null,rs.prototype.reset=function(t,e,n,r,i){r||T(),delete this.a},os.prototype.toString=function(){return this.name};var ss=new os("SEVERE",1e3),as=new os("WARNING",900),us=new os("CONFIG",700),cs=new os("FINE",500);function hs(t){return t.c?t.c:t.a?hs(t.a):(F("Root logger has no level set."),null)}is.prototype.log=function(t,e,n){if(t.value>=hs(this).value)for(v(e)&&(e=e()),t=new rs(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ls={},fs=null;function ps(t){var e;if(fs||(fs=new is(""),ls[""]=fs,fs.c=us),!(e=ls[t])){e=new is(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=ps(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,ls[t]=e}return e}function ds(t,e){t&&t.log(cs,e,void 0)}function vs(t){this.f=t}function ys(t){In.call(this),this.u=t,this.h=void 0,this.readyState=gs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ps("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(vs,Yo),vs.prototype.a=function(){return new ys(this.f)},vs.prototype.b=function(t){return function(){return t}}({}),S(ys,In);var gs=0;function ms(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function bs(t){t.readyState=4,t.g=null,t.c=null,t.m=null,_s(t)}function _s(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ws(t){In.call(this),this.headers=new Dn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=Es,this.u=this.S=!1}(t=ys.prototype).open=function(t,e){if(this.readyState!=gs)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,_s(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,bs(this)),this.readyState=gs},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,_s(this)),this.a&&(this.readyState=3,_s(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ms(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?bs(this):_s(this),3==this.readyState&&ms(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,bs(this))},t.sc=function(t){this.a&&(this.response=t,bs(this))},t.Ua=function(t){var e=this.i;e&&e.log(as,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&bs(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(as,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(as,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ys.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(ws,In);var Es="";ws.prototype.b=ps("goog.net.XhrIo");var Is=/^https?$/i,Ts=["POST","PUT"];function Ss(t){return"content-type"==t.toLowerCase()}function Cs(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,As(t),ks(t)}function As(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ns(t){if(t.c&&void 0!==a)if(t.C[1]&&4==Ds(t)&&2==Os(t))ds(t.b,Rs(t,"Local request error detected and ignored"));else if(t.i&&4==Ds(t))An(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==Ds(t)){ds(t.b,Rs(t,"Request complete")),t.c=!1;try{var e,n=Os(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(xn)[1]||null;if(!o&&u.self&&u.self.location){var s=u.self.location.protocol;o=s.substr(0,s.length-1)}i=!Is.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Ds(t)?t.a.statusText:""}catch(e){ds(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+Os(t)+"]",As(t)}}finally{ks(t)}}}function ks(t,e){if(t.a){Ps(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ss,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Ps(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function Ds(t){return t.a?t.a.readyState:0}function Os(t){try{return 2<Ds(t)?t.a.status:-1}catch(t){return-1}}function Rs(t,e){return e+" ["+t.R+" "+t.l+" "+Os(t)+"]"}function xs(t){var e=Hs;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Ls(t,e,n){t.a=!0,t.c=n,t.f=!e,Us(t)}function Ms(t){if(t.a){if(!t.v)throw new Vs(t);t.v=!1}}function Fs(t,e,n,r){t.g.push([e,n,r]),t.a&&Us(t)}function js(t){return J(t.g,(function(t){return v(t[1])}))}function Us(t){if(t.h&&t.a&&js(t)){var e=t.h,n=Gs[e];n&&(u.clearTimeout(n.a),delete Gs[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],s=i[1];if(i=i[2],o=t.f?s:o)try{var a=o.call(i||t.s,e);void 0!==a&&(t.f=t.f&&(a==e||a instanceof Error),t.c=e=a),(x(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,js(t)||(n=!0)}}t.c=e,r&&(a=E(t.m,t,!0),r=E(t.m,t,!1),e instanceof xs?(Fs(e,a,r),e.C=!0):e.then(a,r)),n&&(e=new Bs(e),Gs[e.a]=e,t.h=e.a)}function Vs(){L.call(this)}function qs(){L.call(this)}function Bs(t){this.a=u.setTimeout(E(this.c,this),0),this.b=t}(t=ws.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ds(this.b,Rs(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ds(this.b,Rs(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ks(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ks(this,!0)),ws.ab.Da.call(this)},t.Vb=function(){this.xa||(this.O||this.i||this.f?Ns(this):this.Jc())},t.Jc=function(){Ns(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Es:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ss,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return ds(this.b,"Can not get response: "+t.message),null}},xs.prototype.cancel=function(t){if(this.a)this.c instanceof xs&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new qs(this),Ms(this),Ls(this,!1,t))}},xs.prototype.m=function(t,e){this.i=!1,Ls(this,t,e)},xs.prototype.then=function(t,e,n){var r,i,o=new Ee((function(t,e){r=t,i=e}));return Fs(this,r,(function(t){t instanceof qs?o.cancel():i(t)})),o.then(t,e,n)},xs.prototype.$goog_Thenable=!0,S(Vs,L),Vs.prototype.message="Deferred has already fired",Vs.prototype.name="AlreadyCalledError",S(qs,L),qs.prototype.message="Deferred was canceled",qs.prototype.name="CanceledError",Bs.prototype.c=function(){throw delete Gs[this.a],this.b};var Gs={};function Ws(t){var e={},n=e.document||document,r=At(t).toString(),i=ye(document,"SCRIPT"),o={Wb:i,Ma:void 0},s=new xs(o),a=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(a=window.setTimeout((function(){zs(i,!0);var t=new Qs(Js,"Timeout reached for loading script "+r);Ms(s),Ls(s,!1,t)}),c),o.Ma=a),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(zs(i,e.xd||!1,a),Ms(s),Ls(s,!0,null))},i.onerror=function(){zs(i,!0,a);var t=new Qs(Ks,"Error while loading script "+r);Ms(s),Ls(s,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),le(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=At(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=l(e.document):(null===h&&(h=l(u.document)),e=h),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),s}function Hs(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&zs(t,!0,this.Ma)}}function zs(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Ks=0,Js=1;function Qs(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Ys(t){this.f=t}function Xs(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||ta,this.g=yt(t.secureTokenHeaders||ea),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||na,this.a=yt(t.firebaseHeaders||ra),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Tr(),!(n=u.XMLHttpRequest||n&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.XMLHttpRequest)&&!Ir())throw new A("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Ir()?this.f=new vs(self):Sr()?this.f=new Ys(n):this.f=new ts,this.b=null}S(Qs,L),S(Ys,Yo),Ys.prototype.a=function(){return new this.f},Ys.prototype.b=function(){return{}};var Zs,$s="idToken",ta=new Wr(3e4,6e4),ea={"Content-Type":"application/x-www-form-urlencoded"},na=new Wr(3e4,6e4),ra={"Content-Type":"application/json"};function ia(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function oa(t,e){e&&(t.l=sa("https://securetoken.googleapis.com/v1/token",e),t.h=sa("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=sa("https://identitytoolkit.googleapis.com/v2/",e))}function sa(t,e){return t=qn(t),e=qn(e.url),t.f=t.a+t.f,Mn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function aa(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ua(t,e,n,r,i,o,s){(function(){var t=Dr();return!((t=Nr(t)!=Ar?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Yt&&ue&&!(9<ue))})()||Ir()?t=E(t.u,t):(Zs||(Zs=new Ee((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(u[ha]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Fs(t,null,e,void 0)}(Ws(Nt(ca,{onload:ha})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=E(t.s,t)),t(e,n,r,i,o,s)}Xs.prototype.T=function(){return this.b},Xs.prototype.u=function(t,e,n,r,i,o){if(Ir()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new A("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ws(this.f);if(o){s.g=Math.max(0,o);var a=setTimeout((function(){s.dispatchEvent("timeout")}),o)}Tn(s,"complete",(function(){a&&clearTimeout(a);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ds(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(s,"ready",(function(){a&&clearTimeout(a),Ke(this)})),Sn(s,"timeout",(function(){a&&clearTimeout(a),Ke(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Ho.a(),t.C=t.D?Xo(t.D):Xo(Ho),t.a.onreadystatechange=E(t.Vb,t);try{ds(t.b,Rs(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(e){return ds(t.b,Rs(t,"Error opening Xhr: "+e.message)),void Cs(t,e)}e=r||"";var o=new Dn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)H(t,e,void 0);else for(var n=Pn(t),r=kn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Ss,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!Q(Ts,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Ps(t),0<t.g&&(t.u=function(t){return Yt&&ae(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ds(t.b,Rs(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=E(t.Ma,t)):t.s=An(t.Ma,t.g,t)),ds(t.b,Rs(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){ds(t.b,Rs(t,"Send error: "+e.message)),Cs(t,e)}}(s,t,n,r,i)};var ca=new _t(Tt,"https://apis.google.com/js/client.js?onload=%{onload}"),ha="__fcb"+Math.floor(1e6*Math.random()).toString();function la(t){if("string"!=typeof(t=t.email)||!br.test(t))throw new A("invalid-email")}function fa(t){"email"in t&&la(t)}function pa(t){if(!t[$s]){if(t.mfaPendingCredential)throw new A("multi-factor-auth-required",null,yt(t));throw new A("internal-error")}}function da(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new A("internal-error")}else{if(!t.sessionInfo)throw new A("missing-verification-id");if(!t.code)throw new A("missing-verification-code")}}Xs.prototype.s=function(t,e,n,r,i){var o=this;Zs.then((function(){window.gapi.client.setApiKey(o.c);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(s),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Xs.prototype.zb=function(){return ru(this,Ha,{})},Xs.prototype.Bb=function(t,e){return ru(this,Ga,{idToken:t,email:e})},Xs.prototype.Cb=function(t,e){return ru(this,Wa,{idToken:t,password:e})};var va={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ya(t){if(!t.phoneVerificationInfo)throw new A("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new A("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new A("missing-verification-code")}function ga(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new A("internal-error")}function ma(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&er(t=new Xn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function ba(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Qo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Qo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Qo(t)):t.errorMessage&&(e=iu(t.errorMessage)),e)throw e;pa(t)}function _a(t,e){return e.returnIdpCredential=!0,ru(t,Ja,e)}function wa(t,e){return e.returnIdpCredential=!0,ru(t,Ya,e)}function Ea(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ru(t,Qa,e)}function Ia(t){if(!t.oobCode)throw new A("invalid-action-code")}(t=Xs.prototype).Db=function(t,e){var n={idToken:t},r=[];return dt(va,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),ru(this,Ga,n)},t.vb=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),ru(this,ja,t)},t.wb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),ru(this,La,t)},t.ub=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),ru(this,Ma,t)},t.Eb=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),ru(this,Fa,t)},t.fb=function(t){return ru(this,$a,t)},t.nb=function(t,e){return ru(this,qa,{oobCode:t,newPassword:e})},t.Ra=function(t){return ru(this,Sa,{oobCode:t})},t.jb=function(t){return ru(this,Ta,{oobCode:t})};var Ta={endpoint:"setAccountInfo",A:Ia,Z:"email",B:!0},Sa={endpoint:"resetPassword",A:Ia,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new A("internal-error")},B:!0},Ca={endpoint:"signupNewUser",A:function(t){if(la(t),!t.password)throw new A("weak-password")},G:pa,V:!0,B:!0},Aa={endpoint:"createAuthUri",B:!0},Na={endpoint:"deleteAccount",N:["idToken"]},ka={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new A("internal-error")}},Pa={endpoint:"emailLinkSignin",N:["email","oobCode"],A:la,G:pa,V:!0,B:!0},Da={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:la,G:pa,V:!0},Oa={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:ya,G:pa,B:!0,Na:!0},Ra={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:ya,G:pa,B:!0,Na:!0},xa={endpoint:"getAccountInfo"},La={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new A("internal-error");la(t)},Z:"email",B:!0},Ma={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Fa={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},ja={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new A("internal-error");la(t)},Z:"email",B:!0},Ua={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},Va={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new A("internal-error")}},qa={endpoint:"resetPassword",A:Ia,Z:"email",B:!0},Ba={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ga={endpoint:"setAccountInfo",N:["idToken"],A:fa,V:!0},Wa={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(fa(t),!t.password)throw new A("weak-password")},G:pa,V:!0},Ha={endpoint:"signupNewUser",G:pa,V:!0,B:!0},za={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new A("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new A("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Ka={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Ja={endpoint:"verifyAssertion",A:ga,Ya:ma,G:ba,V:!0,B:!0},Qa={endpoint:"verifyAssertion",A:ga,Ya:ma,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new A("user-not-found");if(t.errorMessage)throw iu(t.errorMessage);pa(t)},V:!0,B:!0},Ya={endpoint:"verifyAssertion",A:function(t){if(ga(t),!t.idToken)throw new A("internal-error")},Ya:ma,G:ba,V:!0},Xa={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new A("invalid-custom-token")},G:pa,V:!0,B:!0},Za={endpoint:"verifyPassword",A:function(t){if(la(t),!t.password)throw new A("wrong-password")},G:pa,V:!0,B:!0},$a={endpoint:"verifyPhoneNumber",A:da,G:pa,B:!0},tu={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new A("internal-error");da(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Qo(t);pa(t)}},eu={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:da,G:pa,B:!0},nu={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[$s]^!!t.refreshToken)throw new A("internal-error")},B:!0,Na:!0};function ru(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.N))return Pe(new A("internal-error"));var r,i=!!e.Na,o=e.Ub||"POST";return ke(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,s){var a=qn(e+n);Un(a,"key",t.c),s&&Un(a,"cb",T().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&Un(a,c,i[c]);return new Ee((function(e,n){ua(t,a.toString(),(function(t){t?t.error?n(ou(t,o||{})):e(t):n(new A("network-request-failed"))}),r,u?void 0:or(Ur(i)),t.a,t.v.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Hb,e.lb||!1)})).then((function(t){return r=t,e.Ya?e.Ya(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new A("internal-error");return r[e.Z]}))}function iu(t){return ou({error:{errors:[{message:t}],code:400,message:t}})}function ou(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new A(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",mt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new A(r[i],e);return!e&&t&&(e=jr(t)),new A("internal-error",e)}function su(t){this.b=t,this.a=null,this.rb=function(t){return(hu||(hu=new Ee((function(t,e){function n(){Gr(),Or("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Gr(),e(Error("Network Error"))},timeout:uu.get()})}if(Or("gapi.iframes.Iframe"))t();else if(Or("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Or("gapi.load")?n():e(Error("Network Error"))},ke(Ws(r=Nt(au,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw hu=null,t})))).then((function(){return new Ee((function(e,n){Or("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),cu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var au=new _t(Tt,"https://apis.google.com/js/api.js?onload=%{onload}"),uu=new Wr(3e4,6e4),cu=new Wr(5e3,15e3),hu=null;function lu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Bn((t=qn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):Bn("https",this.l,null,"/__/auth/iframe"),this.a=t,Un(this.a,"apiKey",this.h),Un(this.a,"appName",this.i),this.b=null,this.c=[]}function fu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function pu(t){try{return r.Z.app(t).auth().Ga()}catch(t){return[]}}function du(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function vu(t){var e=fr();return function(t){return ru(t,Ua,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=qn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=qn(o).a==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:mr.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){t=!0;break t}}t=!1}if(!t)throw new Ko(fr())}))}function yu(t){return t.m||(t.m=_r().then((function(){if(!t.u){var e=t.c,n=t.i,r=pu(t.b),i=new lu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=$(r||[]),t.u=i.toString()}t.v=new su(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then((function(){t.a.register("authEvent",e,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Go(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",ke(n)}return n.status="ERROR",ke(n)}))}(t)}))),t.m}function gu(t){return t.l||(t.C=t.c?Pr(t.c,pu(t.b)):null,t.l=new Xs(t.g,R(t.i),t.C),t.f&&oa(t.l,t.f)),t.l}function mu(t,e,n,r,i,o,s,a,u,c,h,l){return(t=new fu(t,e,n,r,i,l)).l=o,t.g=s,t.i=a,t.b=yt(u||null),t.f=c,t.yb(h).toString()}function bu(t){if(this.a=t||r.Z.INTERNAL.reactNative&&r.Z.INTERNAL.reactNative.AsyncStorage,!this.a)throw new A("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function _u(t){this.b=t,this.a={},this.f=E(this.c,this)}lu.prototype.toString=function(){return this.f?Un(this.a,"v",this.f):tr(this.a.b,"v"),this.b?Un(this.a,"eid",this.b):tr(this.a.b,"eid"),this.c.length?Un(this.a,"fw",this.c.join(",")):tr(this.a.b,"fw"),this.a.toString()},fu.prototype.yb=function(t){return this.h=t,this},fu.prototype.toString=function(){if(this.v){var t=qn(this.v.url);t=Bn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Bn("https",this.u,null,"/__/auth/handler");if(Un(t,"apiKey",this.s),Un(t,"appName",this.c),Un(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.Z.app(this.c).auth().la()}catch(t){n=null}for(var i in e.ob=n,Un(t,"providerId",this.a.providerId),e=Ur((n=this.a).Ib))e[i]=e[i].toString();i=n.Qc,e=yt(e);for(var o=0;o<i.length;o++){var s=i[o];s in e&&delete e[s]}n.pb&&n.ob&&!e[n.pb]&&(e[n.pb]=n.ob),vt(e)||Un(t,"customParameters",jr(e))}if("function"==typeof this.a.Qb&&(n=this.a.Qb()).length&&Un(t,"scopes",n.join(",")),this.l?Un(t,"redirectUrl",this.l):tr(t.b,"redirectUrl"),this.g?Un(t,"eventId",this.g):tr(t.b,"eventId"),this.i?Un(t,"v",this.i):tr(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Vn(t,a)&&Un(t,a,this.b[a]);return this.h?Un(t,"tid",this.h):tr(t.b,"tid"),this.f?Un(t,"eid",this.f):tr(t.b,"eid"),(a=pu(this.c)).length&&Un(t,"fw",a.join(",")),t.toString()},(t=du.prototype).Ob=function(t,e,n){var r=new A("popup-closed-by-user"),i=new A("web-storage-unsupported"),o=this,s=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return yu(t).then((function(){return function(t,e){return t.rb.then((function(){return new Ee((function(n){t.a.send(e.type,e,n,Or("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&yr(t),e(i),s=!0)}))})).o((function(){})).then((function(){if(!s)return function(t){return new Ee((function(e){return function n(){Nn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!s)return Nn(n).then((function(){e(r)}))}))},t.Xb=function(){var t=Dr();return!Fr(t)&&!Br(t)},t.Tb=function(){return!1},t.Mb=function(t,e,n,r,i,o,s,a){if(!t)return Pe(new A("popup-blocked"));if(s&&!Fr())return this.ma().o((function(e){yr(t),i(e)})),r(),ke();this.a||(this.a=vu(gu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw yr(t),i(e),e}));return r(),e})).then((function(){qo(n),s||pr(mu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,a,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Nb=function(t,e,n,r){this.a||(this.a=vu(gu(this)));var i=this;return this.a.then((function(){qo(e),pr(mu(i.s,i.g,i.b,t,e,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return yu(this).then((function(){return t.v.rb})).o((function(){throw t.a=null,new A("network-request-failed")}))},t.$b=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Sa=function(t){X(this.h,(function(e){return e==t}))},(t=bu.prototype).get=function(t){return ke(this.a.getItem(t)).then((function(t){return t&&Vr(t)}))},t.set=function(t,e){return ke(this.a.setItem(t,jr(e)))},t.U=function(t){return ke(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var wu,Eu=[];function Iu(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Tu(t){this.a=t}function Su(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,s,a,u=n||{},c=null;if(t.b)return Pe(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ee((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),s=setTimeout((function(){r(Error("unsupported_event"))}),h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return Au(t,c),e})).o((function(e){throw Au(t,c),e}))}function Au(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),X(t.a,(function(t){return t==e}))}}function Nu(){if(!Ou())throw new A("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Ir()&&self?(this.v=function(){var t=Ir()?self:null;if(H(Eu,(function(n){n.b==t&&(e=n)})),!e){var e=new _u(t);Eu.push(e)}return e}(),Iu(this.v,"keyChanged",(function(e,n){return Fu(t).then((function(e){return 0<e.length&&H(t.a,(function(t){t(e)})),{keyProcessed:Q(e,n.key)}}))})),Iu(this.v,"ping",(function(){return ke(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?ke().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):ke(null)}().then((function(e){(t.h=e)&&(t.g=new Su(new Tu(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function ku(t){return new Ee((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ee((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return ku(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Pu(t){return t.i||(t.i=ku(t)),t.i}function Du(t,e){var n=0;return new Ee((function r(i,o){Pu(t).then(e).then(i).o((function(e){if(!(3<++n))return Pu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Ou(){try{return!!u.indexedDB}catch(t){return!1}}function Ru(t){return t.objectStore("firebaseLocalStorage")}function xu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Lu(t){return new Ee((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Mu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):ke()}function Fu(t){return Pu(t).then((function(t){var e=Ru(xu(t,!1));return e.getAll?Lu(e.getAll()):new Ee((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=dr(t.c,n),t.c=n}return r}))}function ju(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Uu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=ke().then((function(){if(Ou()){var t=qr(),r="__sak"+t;return wu||(wu=new Nu),(n=wu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){H(e.a,(function(e){e(t)}))})),t}))}function Vu(){this.a={},this.type="inMemory"}function qu(){if(!function(){var t="Node"==Tr();if(!(t=Bu()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Tr())throw new A("internal-error","The LocalStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Bu()||r.Z.INTERNAL.node.localStorage,this.type="localStorage"}function Bu(){try{var t=u.localStorage,e=qr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Gu(){this.type="nullStorage"}function Wu(){if(!function(){var t="Node"==Tr();if(!(t=Hu()||t&&r.Z.INTERNAL.node&&r.Z.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Tr())throw new A("internal-error","The SessionStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Hu()||r.Z.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Hu(){try{var t=u.sessionStorage,e=qr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function zu(){var t={};t.Browser=Qu,t.Node=Yu,t.ReactNative=Xu,t.Worker=Zu,this.a=t[Tr()]}_u.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];H(r,(function(e){i.push(ke().then((function(){return e(t.origin,t.data.data)})))})),Oe(i).then((function(r){var i=[];H(r,(function(t){i.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})})),H(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Tu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Su.prototype.close=function(){for(;0<this.a.length;)Au(this,this.a[0]);this.b=!0},(t=Nu.prototype).set=function(t,e){var n=this,r=!1;return Du(this,(function(e){return Lu((e=Ru(xu(e,!0))).get(t))})).then((function(i){return Du(n,(function(o){if(o=Ru(xu(o,!0)),i)return i.value=e,Lu(o.put(i));n.b++,r=!0;var s={};return s.fbase_key=t,s.value=e,Lu(o.add(s))}))})).then((function(){return n.c[t]=e,Mu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Du(this,(function(e){return Lu(Ru(xu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Du(this,(function(r){return n=!0,e.b++,Lu(Ru(xu(r,!0)).delete(t))})).then((function(){return delete e.c[t],Mu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){ju(t),function e(){t.f=setTimeout((function(){t.l=Fu(t).then((function(e){0<e.length&&H(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t})),0==this.a.length&&ju(this)},(t=Uu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){X(this.a,(function(e){return e==t}))},(t=Vu.prototype).get=function(t){return ke(this.a[t])},t.set=function(t,e){return this.a[t]=e,ke()},t.U=function(t){return delete this.a[t],ke()},t.ca=function(){},t.ia=function(){},(t=qu.prototype).get=function(t){var e=this;return ke().then((function(){return Vr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return ke().then((function(){var r=jr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return ke().then((function(){e.a.removeItem(t)}))},t.ca=function(t){u.window&&ln(u.window,"storage",t)},t.ia=function(t){u.window&&dn(u.window,"storage",t)},(t=Gu.prototype).get=function(){return ke(null)},t.set=function(){return ke()},t.U=function(){return ke()},t.ca=function(){},t.ia=function(){},(t=Wu.prototype).get=function(t){var e=this;return ke().then((function(){return Vr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return ke().then((function(){var r=jr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return ke().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var Ku,Ju,Qu={F:qu,bb:Wu},Yu={F:qu,bb:Wu},Xu={F:bu,bb:Gu},Zu={F:qu,bb:Gu},$u={rd:"local",NONE:"none",td:"session"};function tc(){var t=!(Br(Dr())||!Er()),e=Fr(),n=Rr();this.m=t,this.h=e,this.l=n,this.a={},Ku||(Ku=new zu),t=Ku;try{this.g=!lr()&&Kr()||!u.indexedDB?new t.a.F:new Uu(Ir()?new Vu:new t.a.F)}catch(t){this.g=new Vu,this.h=!0}try{this.i=new t.a.bb}catch(t){this.i=new Vu}this.v=new Vu,this.f=E(this.Yb,this),this.b={}}function ec(){return Ju||(Ju=new tc),Ju}function nc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function rc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ic(t,e,n){return n=rc(e,n),"local"==e.F&&(t.b[n]=null),nc(t,e.F).U(n)}function oc(t){t.c&&(clearInterval(t.c),t.c=null)}function sc(t){this.a=t,this.b=ec()}(t=tc.prototype).get=function(t,e){return nc(this,t.F).get(rc(t,e))},t.set=function(t,e,n){var r=rc(t,n),i=this,o=nc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=rc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),vt(this.a)&&(nc(this,"local").ca(this.f),this.h||(lr()||!Kr())&&u.indexedDB||!this.l||function(t){oc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new $e({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Yb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=rc(t,e),this.a[t]&&(X(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(nc(this,"local").ia(this.f),oc(this))},t.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?nc(this,"local").ia(this.f):oc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.mb(e))},Yt&&ue&&10==ue&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else H(t,E(this.mb,this))},t.mb=function(t){this.a[t]&&H(this.a[t],(function(t){t()}))};var ac,uc={name:"authEvent",F:"local"};function cc(){this.a=ec()}function hc(t,e){this.b=lc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===ac&&(ac=u.Int32Array?new Int32Array(mc):mc),this.reset()}S(hc,(function(){this.b=-1}));for(var lc=64,fc=lc-1,pc=[],dc=0;dc<fc;dc++)pc[dc]=0;var vc=Z(128,pc);function yc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&h^~c&l)+(0|ac[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+s|0,u=a,a=i,i=r,r=s+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function gc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(yc(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(yc(t),i=0)}}t.c=i,t.g+=n}hc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):$(this.h)};var mc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function bc(){hc.call(this,8,_c)}S(bc,hc);var _c=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function wc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new cc,this.g=new sc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ec(t){return new A("invalid-cordova-configuration",t)}function Ic(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Tc(t){return t.f||(t.f=t.ma().then((function(){return new Ee((function(e){t.Ea((function n(r){return e(r),t.Sa(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Sc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=so(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Vr(Vn(o=qn(i),"firebaseError")||null))?N(o):null)?new Bo(r.c,r.b,null,null,o,null,r.T()):new Bo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Ic(t,i)}))}var n=new Bo("unknown",null,null,null,new A("no-auth-event")),r=!1,i=Nn(500).then((function(){return Sc(t).then((function(){r||Ic(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Or("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},zo||(zo=new Wo),function(t){var e=zo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Or("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Sc(t){var e=null;return function(t){return t.b.get(uc,t.a).then((function(t){return Go(t)}))}(t.g).then((function(n){return e=n,ic((n=t.g).b,uc,n.a)})).then((function(){return e}))}function Cc(t){this.a=t,this.b=ec()}(t=wc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wr(void 0)?_r().then((function(){return new Ee((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Pe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Or("universalLinks.subscribe",u))throw Ec("cordova-universal-links-plugin-fix is not installed");if(void 0===Or("BuildInfo.packageName",u))throw Ec("cordova-plugin-buildinfo is not installed");if("function"!=typeof Or("cordova.plugins.browsertab.openUrl",u))throw Ec("cordova-plugin-browsertab is not installed");if("function"!=typeof Or("cordova.InAppBrowser.open",u))throw Ec("cordova-plugin-inappbrowser is not installed")}),(function(){throw new A("cordova-not-ready")}))},t.Ob=function(t,e){return e(new A("operation-not-supported-in-this-environment")),ke()},t.Mb=function(){return Pe(new A("operation-not-supported-in-this-environment"))},t.$b=function(){return!1},t.Xb=function(){return!0},t.Tb=function(){return!0},t.Nb=function(t,e,n,r){if(this.c)return Pe(new A("redirect-operation-pending"));var i=this,o=u.document,s=null,a=null,c=null,h=null;return this.c=ke().then((function(){return qo(e),Tc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Bo(e,r,null,o,new A("no-auth-event"),null,i),a=Or("BuildInfo.packageName",u);if("string"!=typeof a)throw new A("invalid-cordova-configuration");var c=Or("BuildInfo.displayName",u),h={};if(Dr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=a;else{if(!Dr().toLowerCase().match(/android/))return Pe(new A("operation-not-supported-in-this-environment"));h.apn=a}c&&(h.appDisplayName=c),o=function(t){var e=new bc;gc(e,t),t=[];var n=8*e.g;56>e.c?gc(e,vc,56-e.c):gc(e,vc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(yc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return K(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),h.sessionId=o;var l=mu(t.v,t.i,t.l,e,n,null,r,t.m,h,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(uc,s.w(),e)})).then((function(){var e=Or("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new A("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Or("cordova.plugins.browsertab.openUrl",u)))throw new A("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Or("cordova.InAppBrowser.open",u)))throw new A("invalid-cordova-configuration");e=Dr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ee((function(t,e){a=function(){var e=Or("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(a),c=function(){s||(s=Nn(2e3).then((function(){e(new A("redirect-cancelled-by-user"))})))},h=function(){Hr()&&c()},o.addEventListener("resume",c,!1),Dr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).o((function(t){return Sc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),a&&i.Sa(a),i.c=null}))},t.Ea=function(t){this.b.push(t),Tc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Bo("unknown",null,null,null,new A("no-auth-event")),t(e))}))},t.Sa=function(t){X(this.b,(function(e){return e==t}))};var Ac={name:"pendingRedirect",F:"session"};function Nc(t){return ic(t.b,Ac,t.a)}function kc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=E(this.s,this),this.b=new Wc,this.C=new Qc,this.g=new Cc(Bc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Pc(this.D,this.v,this.m,k,this.J)}function Pc(t,e,n,i,o){var s=r.Z.SDK_VERSION||null;return wr()?new wc(t,e,n,s,i,o):new du(t,e,n,s,i,o)}function Dc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Oc(t){t.a.Xb()&&Dc(t).o((function(e){var n=new Bo("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)})),t.a.Tb()||Hc(t.b)}function Rc(t,e){Q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Ac,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Nc(t.g).then((function(){Dc(t).o((function(e){var n=new Bo("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)}))})):Oc(t)})).o((function(){Oc(t)}))}function xc(t,e){X(t.h,(function(t){return t==e}))}kc.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Pc(this.D,this.v,this.m,null,this.J),this.i={}},kc.prototype.s=function(t){if(!t)throw new A("invalid-auth-event");if(6e5<=T()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=T())),e=!0;break}}return Hc(this.b),e};var Lc=new Wr(2e3,1e4),Mc=new Wr(3e4,6e4);function Fc(t,e,n,r,i,o,s){return t.a.Mb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,s)}function jc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Uc(t,e,n,r,i){var o;return function(t){return t.b.set(Ac,"pending",t.a)}(t.g).then((function(){return t.a.Nb(e,n,r,i).o((function(e){if(jc(e))throw new A("operation-not-supported-in-this-environment");return o=e,Nc(t.g).then((function(){throw o}))})).then((function(){return t.a.$b()?new Ee((function(){})):Nc(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function Vc(t,e,n,r,i){return t.a.Ob(r,(function(t){e.na(n,null,t,i)}),Lc.get())}kc.prototype.qa=function(){return this.b.qa()};var qc={};function Bc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Gc(t,e,n,r){var i=Bc(e,n,r);return qc[i]||(qc[i]=new kc(t,e,n,r)),qc[i]}function Wc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Hc(t){t.g||(t.g=!0,Jc(t,!1,null,null))}function zc(t){t.g&&!t.i&&Jc(t,!1,null,null)}function Kc(t,e){if(t.b=function(){return ke(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Jc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Pe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Kc(t,n):Kc(t,{user:null}),t.f=[],t.c=[]}function Qc(){}function Yc(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Xc(t,e){this.a=e,Zr(this,"verificationId",t)}function Zc(t,e,n,r){return new jo(t).fb(e,n).then((function(t){return new Xc(t,r)}))}function $c(t){var e=zi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new A("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");$r(this,{token:t,expirationTime:zr(1e3*e.exp),authTime:zr(1e3*e.auth_time),issuedAtTime:zr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function th(t,e,n){var r=e&&e[nh];if(!r)throw new A("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=yt(e),this.g=n,this.c=new ao(null,r),this.b=[];var i=this;H(e[eh]||[],(function(t){(t=ri(t))&&i.b.push(t)})),Zr(this,"auth",this.a),Zr(this,"session",this.c),Zr(this,"hints",this.b)}Wc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Wc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Jc(this,!0,null,t.a),ke()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,s=e.T(),a=!!e.c.match(/Redirect$/);n(r,i,s,o).then((function(e){Jc(t,a,e,null)})).o((function(e){Jc(t,a,null,e)}))}(this,t,e):Pe(new A("invalid-auth-event")):(Jc(this,!1,null,null),ke())}else Pe(new A("invalid-auth-event"))},Wc.prototype.qa=function(){var t=this;return new Ee((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new A("timeout");t.a&&t.a.cancel(),t.a=Nn(Mc.get()).then((function(){t.b||(t.g=!0,Jc(t,!0,null,e))}))}(t))}))},Qc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),ke()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Pe(new A("invalid-auth-event"))}else Pe(new A("invalid-auth-event"))},Xc.prototype.confirm=function(t){return t=Uo(this.verificationId,t),this.a(t)};var eh="mfaInfo",nh="mfaPendingCredential";function rh(t,e,n,r){A.call(this,"multi-factor-auth-required",r,e),this.b=new th(t,e,n),Zr(this,"resolver",this.b)}function ih(t,e,n){if(t&&y(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new rh(e,t.serverResponse,n,t.message)}catch(t){}return null}function oh(){}function sh(t){Zr(this,"factorId",t.fa),this.a=t}function ah(t){if(sh.call(this,t),this.a.fa!=jo.PROVIDER_ID)throw new A("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function uh(t,e){for(var n in Ze.call(this,t),e)this[n]=e[n]}function ch(t,e){this.a=t,this.b=[],this.c=E(this.yc,this),ln(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&H(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[si]=t.uid),t.displayName&&(r[ii]=t.displayName),t.enrollmentTime&&(r[oi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ai]=t.phoneNumber);try{e=new ui(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),hh(this,n)}function hh(t,e){t.b=e,Zr(t,"enrolledFactors",e)}function lh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fh(t,e){t.stop(),t.b=Nn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return Hr()||!t?ke():new Ee((function(n){e=function(){Hr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){fh(t,!0)})).o((function(e){t.i(e)&&fh(t,!1)}))}function ph(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function dh(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function vh(t,e){t.b=Hi(e[$s]||""),t.a=e.refreshToken,dh(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function yh(t,e){this.a=t||null,this.b=e||null,$r(this,{lastSignInTime:zr(e||null),creationTime:zr(t||null)})}function gh(t,e,n,r,i,o){$r(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function mh(t,e,n){this.J=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.Z.SDK_VERSION?Pr(r.Z.SDK_VERSION):null;this.a=new Xs(this.l,R(k),i),t.emulatorConfig&&oa(this.a,t.emulatorConfig),this.b=new ph(this.a),Ch(this,e[$s]),vh(this.b,e),Zr(this,"refreshToken",this.b.a),kh(this,n||{}),In.call(this),this.R=!1,this.s&&xr()&&(this.i=Gc(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new lh((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.aa=E(this.hb,this);var o=this;this.ya=null,this.Oa=function(t){o.wa(t.h)},this.ja=null,this.Aa=function(t){oa(o.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){wh(o,t.f)},this.ba=null,this.O=new ch(this,n),Zr(this,"multiFactor",this.O)}function bh(t,e){t.ja&&dn(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&ln(e,"languageCodeChanged",t.Oa)}function _h(t,e){t.X&&dn(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&ln(e,"emulatorConfigChanged",t.Aa)}function wh(t,e){t.$=e,aa(t.a,r.Z.SDK_VERSION?Pr(r.Z.SDK_VERSION,t.$):null)}function Eh(t,e){t.ba&&dn(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&ln(e,"frameworkChanged",t.Ba)}function Ih(t){try{return r.Z.app(t.m).auth()}catch(e){throw new A("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function Th(t){t.D||t.u.b||(t.u.start(),dn(t,"tokenChanged",t.aa),ln(t,"tokenChanged",t.aa))}function Sh(t){dn(t,"tokenChanged",t.aa),t.u.stop()}function Ch(t,e){t.za=e,Zr(t,"_lat",e)}function Ah(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return Oe(e).then((function(){return t}))}function Nh(t){t.i&&!t.R&&(t.R=!0,Rc(t.i,t))}function kh(t,e){$r(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new yh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Ph(){}function Dh(t){return ke().then((function(){if(t.D)throw new A("app-deleted")}))}function Oh(t){return K(t.providerData,(function(t){return t.providerId}))}function Rh(t,e){e&&(xh(t,e.providerId),t.providerData.push(e))}function xh(t,e){X(t.providerData,(function(t){return t.providerId==e}))}function Lh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Zr(t,e,n)}function Mh(t,e){t!=e&&($r(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Zr(t,"metadata",function(t){return new yh(t.a,t.b)}(e.metadata)):Zr(t,"metadata",new yh),H(e.providerData,(function(e){Rh(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Zr(t,"refreshToken",t.b.a),hh(t.O,e.O.b))}function Fh(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return ru(t.a,xa,{idToken:e}).then(E(t.Kc,t))}(t,e).then((function(){return n||Lh(t,"isAnonymous",!1),e}))}))}function jh(t,e){e[$s]&&t.za!=e[$s]&&(vh(t.b,e),t.dispatchEvent(new uh("tokenChanged")),Ch(t,e[$s]),Lh(t,"refreshToken",t.b.a))}function Uh(t,e){return Fh(t).then((function(){if(Q(Oh(t),e))return Ah(t).then((function(){throw new A("provider-already-linked")}))}))}function Vh(t,e,n){return ti({user:t,credential:Vo(e),additionalUserInfo:e=Xi(e),operationType:n})}function qh(t,e){return jh(t,e),t.reload().then((function(){return t}))}function Bh(t,e,n,i,o){if(!xr())return Pe(new A("operation-not-supported-in-this-environment"));if(t.h&&!o)return Pe(t.h);var s=Yi(n.providerId),a=qr(t.uid+":::"),u=null;(!Fr()||Er())&&t.s&&n.isOAuthProvider&&(u=mu(t.s,t.l,t.m,e,n,null,a,r.Z.SDK_VERSION||null,null,null,t.tenantId));var c=gr(u,s&&s.ua,s&&s.ta);return i=i().then((function(){if(Wh(t),!o)return t.I().then((function(){}))})).then((function(){return Fc(t.i,c,e,n,a,!!u,t.tenantId)})).then((function(){return new Ee((function(n,r){t.na(e,null,new A("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=a,t.c=Vc(t.i,t,e,c,a)}))})).then((function(t){return c&&yr(c),t?ti(t):null})).o((function(t){throw c&&yr(c),t})),Hh(t,i,o)}function Gh(t,e,n,r,i){if(!xr())return Pe(new A("operation-not-supported-in-this-environment"));if(t.h&&!i)return Pe(t.h);var o=null,s=qr(t.uid+":::");return r=r().then((function(){if(Wh(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=s,Ah(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Jh,t.w(),e.a)),e})).then((function(){return Uc(t.i,e,n,s,t.tenantId)})).o((function(e){if(o=e,t.ha)return Qh(t.ha);throw o})).then((function(){if(o)throw o})),Hh(t,r,i)}function Wh(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new A("internal-error");throw new A("auth-domain-config-required")}}function Hh(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),Pe(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new uh("userInvalidated")),t.h=e),e}))}(t,e,n);return t.J.push(r),r.oa((function(){Y(t.J,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),Ih(t),E(t.jc,t))),n||e}))}function zh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[$s]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new mh(e,n,t);return t.providerData&&H(t.providerData,(function(t){t&&Rh(i,ti(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function Kh(t){this.a=t,this.b=ec()}th.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then((function(t){var n=yt(e.f);return delete n[eh],delete n[nh],mt(n,t),e.g(n)}))},S(rh,A),oh.prototype.sb=function(t,e,n){return e.type==uo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),mt(n,{phoneVerificationInfo:Fo(t.a)}),ru(e,Oa,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:Fo(t.a)}),ru(e,Ra,n)}))}(this,t,e)},S(sh,oh),S(ah,sh),S(uh,Ze),(t=ch.prototype).yc=function(t){hh(this,function(t){var e=[];return H(t.mfaInfo||[],(function(t){(t=ri(t))&&e.push(t)})),e}(t.hd))},t.Rb=function(){return this.a.I().then((function(t){return new ao(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Rb().then((function(n){return t.sb(r,n,e)})).then((function(t){return jh(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return ru(r,nu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=z(e.b,(function(t){return t.uid!=n}));return hh(e,r),jh(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:K(this.b,(function(t){return t.w()}))}}},lh.prototype.start=function(){this.a=this.c,fh(this,!0)},lh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ph.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},ph.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Pe(new A("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new Ee((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ua(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(ou(t)):t.access_token&&t.refresh_token?n(t):r(new A("internal-error")):r(new A("network-request-failed"))}),"POST",$n(e).toString(),t.g,t.m.get()):r(new A("internal-error"))}))}(t.f,e).then((function(e){return t.b=Hi(e.access_token),t.a=e.refresh_token,dh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):ke(null):ke({accessToken:this.b.toString(),refreshToken:this.a})},yh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(mh,In),mh.prototype.wa=function(t){this.ya=t,ia(this.a,t)},mh.prototype.la=function(){return this.ya},mh.prototype.Ga=function(){return $(this.$)},mh.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},Zr(mh.prototype,"providerId","firebase"),(t=mh.prototype).reload=function(){var t=this;return Hh(this,Dh(this).then((function(){return Fh(t).then((function(){return Ah(t)})).then(Ph)})))},t.oc=function(t){return this.I(t).then((function(t){return new $c(t)}))},t.I=function(t){var e=this;return Hh(this,Dh(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new A("internal-error");return t.accessToken!=e.za&&(Ch(e,t.accessToken),e.dispatchEvent(new uh("tokenChanged"))),Lh(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new A("internal-error");kh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?K(t,(function(t){return new gh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Rh(this,e[n]);Lh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new uh("userReloaded",{hd:t}))},t.Lc=function(t){return Yr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},t.tb=function(t){var e=this,n=null;return Hh(this,t.c(this.a,this.uid).then((function(t){return jh(e,t),n=Vh(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Yr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},t.qb=function(t){var e=this,n=null;return Hh(this,Uh(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=Vh(e,t,"link"),qh(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return Hh(this,Uh(this,"phone").then((function(){return Zc(Ih(n),t,e,E(n.qb,n))})))},t.Mc=function(t,e){var n=this;return Hh(this,ke().then((function(){return Zc(Ih(n),t,e,E(n.tb,n))})),!0)},t.Bb=function(t){var e=this;return Hh(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return jh(e,t),e.reload()})))},t.ed=function(t){var e=this;return Hh(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return jh(e,t),e.reload()})))},t.Cb=function(t){var e=this;return Hh(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return jh(e,t),e.reload()})))},t.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Dh(this);var e=this;return Hh(this,this.I().then((function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return jh(e,t),Lh(e,"displayName",t.displayName||null),Lh(e,"photoURL",t.photoUrl||null),H(e.providerData,(function(t){"password"===t.providerId&&(Zr(t,"displayName",e.displayName),Zr(t,"photoURL",e.photoURL))})),Ah(e)})).then(Ph))},t.cd=function(t){var e=this;return Hh(this,Fh(this).then((function(n){return Q(Oh(e),t)?function(t,e,n){return ru(t,ka,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return H(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),H(Oh(e),(function(t){n[t]||xh(e,t)})),n[jo.PROVIDER_ID]||Zr(e,"phoneNumber",null),Ah(e)})):Ah(e).then((function(){throw new A("no-such-provider")}))})))},t.delete=function(){var t=this;return Hh(this,this.I().then((function(e){return ru(t.a,Na,{idToken:e})})).then((function(){t.dispatchEvent(new uh("userDeleted"))}))).then((function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");bh(t,null),_h(t,null),Eh(t,null),t.J=[],t.D=!0,Sh(t),Zr(t,"refreshToken",null),t.i&&xc(t.i,t)}))},t.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?E(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?E(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?E(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?E(this.Lb,this):null},t.Ec=function(t){var e=this;return Bh(this,"linkViaPopup",t,(function(){return Uh(e,t.providerId).then((function(){return Ah(e)}))}),!1)},t.Nc=function(t){return Bh(this,"reauthViaPopup",t,(function(){return ke()}),!0)},t.Fc=function(t){var e=this;return Gh(this,"linkViaRedirect",t,(function(){return Uh(e,t.providerId)}),!1)},t.Oc=function(t){return Gh(this,"reauthViaRedirect",t,(function(){return ke()}),!0)},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Hh(this,this.I().then((function(n){return wa(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=Vh(i,t,"link"),qh(i,t)})).then((function(){return o})))},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Hh(this,ke().then((function(){return lo(Ea(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=Vh(i,t,"reauthenticate"),jh(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},t.ub=function(t){var e=this,n=null;return Hh(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:Bi(new Oi(t))})).then((function(t){return e.a.ub(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Eb=function(t,e){var n=this,r=null;return Hh(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:Bi(new Oi(e))})).then((function(e){return n.a.Eb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return Hh(this,t=lo(ke(t),n.uid).then((function(t){return e=Vh(n,t,"reauthenticate"),jh(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),H(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),mt(t,this.O.w()),t};var Jh={name:"redirectUser",F:"session"};function Qh(t){return ic(t.b,Jh,t.a)}function Yh(t){this.a=t,this.b=ec(),this.c=null,this.f=function(t){var e=$h("local"),n=$h("session"),r=$h("none");return function(t,e,n){var r=rc(e,n),i=nc(t,e.F);return t.get(e,n).then((function(o){var s=null;try{s=Vr(u.localStorage.getItem(r))}catch(t){}if(s&&!o)return u.localStorage.removeItem(r),t.set(e,s,n);s&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Zh,t.a).then((function(t){return t?$h(t):e}))}))}))})).then((function(e){return t.c=e,Xh(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener($h("local"),this.a,E(this.g,this))}function Xh(t,e){var n,r=[];for(n in $u)$u[n]!==e&&r.push(ic(t.b,$h($u[n]),t.a));return r.push(ic(t.b,Zh,t.a)),function(t){return new Ee((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},a=0;a<t.length;a++)De(t[a],I(o,a),s);else e(i)}))}(r)}Yh.prototype.g=function(){var t=this,e=$h("local");rl(this,(function(){return ke().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Xh(t,"local").then((function(){t.c=e}))}))}))};var Zh={name:"persistence",F:"session"};function $h(t){return{name:"authUser",F:t}}function tl(t,e){return rl(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function el(t){return rl(t,(function(){return ic(t.b,t.c,t.a)}))}function nl(t,e,n){return rl(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),zh(t||{})}))}))}function rl(t,e){return t.f=t.f.then(e,e),t.f}function il(t){if(this.l=!1,Zr(this,"settings",new Yc),Zr(this,"app",t),!fl(this).options||!fl(this).options.apiKey)throw new A("invalid-api-key");t=r.Z.SDK_VERSION?Pr(r.Z.SDK_VERSION):null,this.a=new Xs(fl(this).options&&fl(this).options.apiKey,R(k),t),this.R=[],this.s=[],this.O=[],this.hb=r.Z.INTERNAL.createSubscribe(E(this.zc,this)),this.X=void 0,this.bc=r.Z.INTERNAL.createSubscribe(E(this.Ac,this)),hl(this,null),this.i=new Yh(fl(this).options.apiKey+":"+fl(this).name),this.D=new Kh(fl(this).options.apiKey+":"+fl(this).name),this.$=yl(this,function(t){var e=fl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Jh,t.a).then((function(t){return t&&e&&(t.authDomain=e),zh(t||{})}))}(t.D,fl(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Qh(t.D)}));return yl(t,e)}(t).then((function(){return nl(t.i,e,t.P)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return tl(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:el(t.i)}))):null})).then((function(e){hl(t,e||null)}));return yl(t,n)}(this)),this.h=yl(this,function(t){return t.$.then((function(){return cl(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener($h("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=E(this.Zc,this),this.Ba=E(this.da,this),this.ya=E(this.mc,this),this.za=E(this.wc,this),this.Aa=E(this.xc,this),this.b=null,function(t){var e=fl(t).options.authDomain,n=fl(t).options.apiKey;e&&xr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Gc(e,n,fl(t).name,t.P),Rc(t.b,t),pl(t)&&Nh(pl(t)),t.m){Nh(t.m);var r=t.m;r.wa(t.la()),bh(r,t),wh(r=t.m,t.J),Eh(r,t),oa((r=t.m).a,t.P),_h(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=E(this.delete,this),this.INTERNAL.logFramework=E(this.Gc,this),this.u=0,In.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=qn(this.P.url);t=ti({protocol:t.c,host:t.a,port:t.g,options:ti({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function ol(t){Ze.call(this,"languageCodeChanged"),this.h=t}function sl(t){Ze.call(this,"emulatorConfigChanged"),this.c=t}function al(t){Ze.call(this,"frameworkChanged"),this.f=t}function ul(t){return t.Oa||Pe(new A("auth-domain-config-required"))}function cl(t){if(!xr())return Pe(new A("operation-not-supported-in-this-environment"));var e=ul(t).then((function(){return t.b.qa()})).then((function(t){return t?ti(t):null}));return yl(t,e)}function hl(t,e){pl(t)&&(function(t,e){X(t.S,(function(t){return t==e}))}(pl(t),t.Ba),dn(pl(t),"tokenChanged",t.ya),dn(pl(t),"userDeleted",t.za),dn(pl(t),"userInvalidated",t.Aa),Sh(pl(t))),e&&(e.S.push(t.Ba),ln(e,"tokenChanged",t.ya),ln(e,"userDeleted",t.za),ln(e,"userInvalidated",t.Aa),0<t.u&&Th(e)),Zr(t,"currentUser",e),e&&(e.wa(t.la()),bh(e,t),wh(e,t.J),Eh(e,t),oa(e.a,t.P),_h(e,t))}function ll(t,e){var n=null,r=null;return yl(t,e.then((function(e){return n=Vo(e),r=Xi(e),function(t,e){var n={};return n.apiKey=fl(t).options.apiKey,n.authDomain=fl(t).options.authDomain,n.appName=fl(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then((function(){return function(t,e,n,r){var i=new mh(t,e);return n&&(i.ha=n),r&&wh(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return pl(t)&&e.uid==pl(t).uid?(Mh(pl(t),e),t.da(e)):(hl(t,e),Nh(e),t.da(e))})).then((function(){vl(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),t,E(t.kc,t))),n||e})).then((function(){return ti({user:pl(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function fl(t){return t.app}function pl(t){return t.currentUser}function dl(t){return pl(t)&&pl(t)._lat||null}function vl(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](dl(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](dl(t))}}function yl(t,e){return t.R.push(e),e.oa((function(){Y(t.R,e)})),e}function gl(){}function ml(){this.a={},this.b=1e12}Yh.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new A("invalid-persistence-type"),n=new A("unsupported-persistence-type");t:{for(r in $u)if($u[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Tr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Ou()&&"none"!==t)throw n;break;default:if(!Rr()&&"none"!==t)throw n}}(t),rl(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Xh(n,t)})).then((function(){if(n.c=$h(t),e)return n.b.set(n.c,e,n.a)})):ke()}))},S(il,In),S(ol,Ze),S(sl,Ze),S(al,Ze),(t=il.prototype).xb=function(t){return yl(this,t=this.i.xb(t))},t.wa=function(t){this.aa===t||this.l||(this.aa=t,ia(this.a,this.aa),this.dispatchEvent(new ol(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=u.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new A("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&_r().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,oa(this.a,this.P),this.dispatchEvent(new sl(this.P))}},t.Gc=function(t){this.J.push(t),aa(this.a,r.Z.SDK_VERSION?Pr(r.Z.SDK_VERSION,this.J):null),this.dispatchEvent(new al(this.J))},t.Ga=function(){return $(this.J)},t.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:fl(this).options.apiKey,authDomain:fl(this).options.authDomain,appName:fl(this).name,currentUser:pl(this)&&pl(this).w()}},t.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?E(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return ll(i,_a(i.a,o))}))},t.Xc=function(t){if(!xr())return Pe(new A("operation-not-supported-in-this-environment"));var e=this,n=Yi(t.providerId),i=qr(),o=null;(!Fr()||Er())&&fl(this).options.authDomain&&t.isOAuthProvider&&(o=mu(fl(this).options.authDomain,fl(this).options.apiKey,fl(this).name,"signInViaPopup",t,null,i,r.Z.SDK_VERSION||null,null,null,this.T(),this.P));var s=gr(o,n&&n.ua,n&&n.ta);return yl(this,n=ul(this).then((function(n){return Fc(n,s,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new Ee((function(t,n){e.na("signInViaPopup",null,new A("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=Vc(e.b,e,"signInViaPopup",s,i)}))})).then((function(t){return s&&yr(s),t?ti(t):null})).o((function(t){throw s&&yr(s),t})))},t.Yc=function(t){if(!xr())return Pe(new A("operation-not-supported-in-this-environment"));var e=this;return yl(this,ul(this).then((function(){return function(t){return rl(t,(function(){return t.b.set(Zh,t.c.F,t.a)}))}(e.i)})).then((function(){return Uc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.qa=function(){var t=this;return cl(this).then((function(e){return t.b&&zc(t.b.b),e})).o((function(e){throw t.b&&zc(t.b.b),e}))},t.dd=function(t){if(!t)return Pe(new A("null-user"));if(this.S!=t.tenantId)return Pe(new A("tenant-id-mismatch"));var e=this,n={};n.apiKey=fl(this).options.apiKey,n.authDomain=fl(this).options.authDomain,n.appName=fl(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[$s]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new mh(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&wh(e,r),Mh(e,t),e}(t,n,e.D,e.Ga());return yl(this,this.h.then((function(){if(fl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return pl(e)&&t.uid==pl(e).uid?(Mh(pl(e),t),e.da(t)):(hl(e,r),Nh(r),e.da(r))})).then((function(){vl(e)})))},t.Ab=function(){var t=this;return yl(this,this.h.then((function(){return t.b&&zc(t.b.b),pl(t)?(hl(t,null),el(t.i).then((function(){vl(t)}))):ke()})))},t.Zc=function(){var t=this;return nl(this.i,fl(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=pl(t)&&e){n=pl(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Mh(pl(t),e),pl(t).I();(pl(t)||e)&&(hl(t,e),e&&(Nh(e),e.ha=t.D),t.b&&Rc(t.b,t),vl(t))}}))},t.da=function(t){return tl(this.i,t)},t.mc=function(){vl(this),this.da(pl(this))},t.wc=function(){this.Ab()},t.xc=function(){this.Ab()},t.kc=function(t){var e=this;return this.h.then((function(){return ll(e,ke(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(pl(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.O.push(e),yl(t,t.h.then((function(){!t.l&&Q(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(dl(t)))})))}(this,(function(){t.next(pl(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(pl(r)):"function"==typeof t.next&&t.next(pl(r))})),this.hb(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(pl(r)):"function"==typeof t.next&&t.next(pl(r))})),this.bc(t,e,n)},t.nc=function(t){var e=this;return yl(this,this.h.then((function(){return pl(e)?pl(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return ll(e,ru(e.a,Xa,{token:t}))})).then((function(t){var n=t.user;return Lh(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ru(n.a,Za,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ru(n.a,Ca,{email:t,password:e}))}))},t.$a=function(t){var e=this;return this.h.then((function(){return ll(e,t.ka(e.a))}))},t.Sc=function(t){return Yr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},t.zb=function(){var t=this;return this.h.then((function(){var e=pl(t);if(e&&e.isAnonymous){var n=ti({providerId:null,isNewUser:!1});return ti({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ll(t,t.a.zb()).then((function(e){var n=e.user;return Lh(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return pl(this)&&pl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&pl(this)&&Th(pl(this))},t.Pc=function(t){var e=this;H(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&pl(this)&&Sh(pl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),yl(this,this.h.then((function(){e.l||Q(e.s,t)&&t(dl(e))})))},t.removeAuthTokenListener=function(t){X(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener($h("local"),t.a,this.ja),this.b&&(xc(this.b,this),zc(this.b.b)),Promise.resolve()},t.hc=function(t){return yl(this,function(t,e){return ru(t,Aa,{identifier:e,continueUri:Lr()?fr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!xo(t)},t.wb=function(t,e){var n=this;return yl(this,ke().then((function(){var t=new Oi(e);if(!t.c)throw new A("argument-error",Li+" must be true when sending sign in link to email");return Bi(t)})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.jd=function(t){return this.Ra(t).then((function(t){return t.data.email}))},t.nb=function(t,e){return yl(this,this.a.nb(t,e).then((function(){})))},t.Ra=function(t){return yl(this,this.a.Ra(t).then((function(t){return new ci(t)})))},t.jb=function(t){return yl(this,this.a.jb(t).then((function(){})))},t.vb=function(t,e){var n=this;return yl(this,ke().then((function(){return void 0===e||vt(e)?{}:Bi(new Oi(e))})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.Wc=function(t,e){return yl(this,Zc(this,t,e,E(this.$a,this)))},t.Vc=function(t,e){var n=this;return yl(this,ke().then((function(){var r=e||fr(),i=Ro(t,r);if(!(r=xo(r)))throw new A("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new A("tenant-id-mismatch");return n.$a(i)})))},gl.prototype.render=function(){},gl.prototype.reset=function(){},gl.prototype.getResponse=function(){},gl.prototype.execute=function(){};var bl=null;function _l(t,e){return(e=wl(e))&&t.a[e]||null}function wl(t){return(t=void 0===t?1e12:t)?t.toString():null}function El(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=he(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ln(this.f,"click",this.i)}function Il(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Tl(){}function Sl(){}ml.prototype.render=function(t,e){return this.a[this.b.toString()]=new El(t,e),this.b++},ml.prototype.reset=function(t){var e=_l(this,t);t=wl(t),e&&t&&(e.delete(),delete this.a[t])},ml.prototype.getResponse=function(t){return(t=_l(this,t))?t.getResponse():null},ml.prototype.execute=function(t){(t=_l(this,t))&&t.execute()},El.prototype.getResponse=function(){return Il(this),this.b},El.prototype.execute=function(){Il(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},El.prototype.delete=function(){Il(this),this.g=!0,clearTimeout(this.a),this.a=null,dn(this.f,"click",this.i)},Zr(Tl,"FACTOR_ID","phone"),Sl.prototype.g=function(){return bl||(bl=new ml),ke(bl)},Sl.prototype.c=function(){};var Cl=null;function Al(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Nl=new _t(Tt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),kl=new Wr(3e4,6e4);Al.prototype.g=function(t){var e=this;return new Ee((function(n,r){var i=setTimeout((function(){r(new A("network-request-failed"))}),kl.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new A("internal-error"));delete u[e.a]},ke(Ws(Nt(Nl,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new A("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},Al.prototype.c=function(){this.b--};var Pl=null;function Dl(t,e,n,r,i,o,s){if(Zr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,s?(Cl||(Cl=new Sl),s=Cl):(Pl||(Pl=new Al),s=Pl),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[xl])throw new A("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ll],!u.document)throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!he(e)||!this.i&&he(e).hasChildNodes())throw new A("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Xs(t,o||null,i||null),this.u=r||function(){return null};var a=this;this.l=[];var c=this.a[Ol];this.a[Ol]=function(t){if(Ml(a,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Or(c,u);"function"==typeof e&&e(t)}};var h=this.a[Rl];this.a[Rl]=function(){if(Ml(a,null),"function"==typeof h)h();else if("string"==typeof h){var t=Or(h,u);"function"==typeof t&&t()}}}var Ol="callback",Rl="expired-callback",xl="sitekey",Ll="size";function Ml(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Fl(t,e){return t.h.push(e),e.oa((function(){Y(t.h,e)})),e}function jl(t){if(t.D)throw new A("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ul(t,e,n){var i=!1;try{this.b=n||r.Z.app()}catch(t){throw new A("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new A("invalid-api-key");n=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}s=r.Z.SDK_VERSION?Pr(r.Z.SDK_VERSION,s):null,Dl.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),s,R(k),i)}function Vl(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new A("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=ql.length)throw new A("internal-error","Argument validator received an unsupported number of arguments.");n=ql[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new A("argument-error",t+" failed: "+r)}(t=Dl.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Fl(this,ke().then((function(){if(Lr()&&!Ir())return _r();throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,ru(t.s,Va,{})})).then((function(e){t.a[xl]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){jl(this);var t=this;return Fl(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=he(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!ce&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Ht(s.name),'"'),s.type){o.push(' type="',Ht(s.type),'"');var a={};mt(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=ye(i,o),s&&("string"==typeof s?o.className=s:Array.isArray(s)?o.className=s.join(" "):le(o,s)),2<r.length&&ve(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){jl(this);var t=this;return Fl(this,this.render().then((function(e){return new Ee((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){X(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){jl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){jl(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=he(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(Ul,Dl);var ql="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Bl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Gl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Wl(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:y}}function Hl(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function zl(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Kl(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Jl(t,e){return y(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Ql(t){return y(t)&&"string"==typeof t.uid}function Yl(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Xl(t,e){for(var n in e){var r=e[n].name;t[r]=tf(r,t[n],e[n].j)}}function Zl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:I((function(t){return this[t]}),n),set:I((function(t,e,n,r){Vl(t,[n],[r],!0),this[e]=r}),r,n,e[n].kb),enumerable:!0})}}function $l(t,e,n,r){t[e]=tf(e,n,r)}function tf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Vl(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Xl(il.prototype,{jb:{name:"applyActionCode",j:[Bl("code")]},Ra:{name:"checkActionCode",j:[Bl("code")]},nb:{name:"confirmPasswordReset",j:[Bl("code"),Bl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Bl("email"),Bl("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Bl("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Bl("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Yl(Wl(),Hl(),"nextOrObserver"),Hl("opt_error",!0),Hl("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Yl(Wl(),Hl(),"nextOrObserver"),Hl("opt_error",!0),Hl("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Bl("email"),Yl(Wl("opt_actionCodeSettings",!0),zl(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Bl("email"),Wl("actionCodeSettings")]},xb:{name:"setPersistence",j:[Bl("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Kl()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[Kl()]},Tc:{name:"signInWithCustomToken",j:[Bl("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Bl("email"),Bl("password")]},Vc:{name:"signInWithEmailLink",j:[Bl("email"),Bl("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Yl({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof mh)}},zl(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Bl(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Bl("url"),Wl("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Bl("code")]}}),Zl(il.prototype,{lc:{name:"languageCode",kb:Yl(Bl(),zl(),"languageCode")},ti:{name:"tenantId",kb:Yl(Bl(),zl(),"tenantId")}}),il.Persistence=$u,il.Persistence.LOCAL="local",il.Persistence.SESSION="session",il.Persistence.NONE="none",Xl(mh.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Gl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Gl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Kl()]},qb:{name:"linkWithCredential",j:[Kl()]},Dc:{name:"linkWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Kl()]},tb:{name:"reauthenticateWithCredential",j:[Kl()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[Yl(Wl("opt_actionCodeSettings",!0),zl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Bl(null,!0)]},cd:{name:"unlink",j:[Bl("provider")]},Bb:{name:"updateEmail",j:[Bl("email")]},Cb:{name:"updatePassword",j:[Bl("password")]},ed:{name:"updatePhoneNumber",j:[Kl("phone")]},Db:{name:"updateProfile",j:[Wl("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Bl("email"),Yl(Wl("opt_actionCodeSettings",!0),zl(null,!0),"opt_actionCodeSettings",!0)]}}),Xl(ml.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(gl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(Ee.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Zl(Yc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Gl("appVerificationDisabledForTesting")}}),Xl(Xc.prototype,{confirm:{name:"confirm",j:[Bl("verificationCode")]}}),$l(ho,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[mo,Do,Mo,vo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Yl(Bl(),Wl(),"json")]),$l(Oo,"credential",(function(t,e){return new Po(t,e)}),[Bl("email"),Bl("password")]),Xl(Po.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(Eo.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Wl("customOAuthParameters")]}}),$l(Eo,"credential",Io,[Yl(Bl(),Wl(),"token")]),$l(Oo,"credentialWithLink",Ro,[Bl("email"),Bl("emailLink")]),Xl(To.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Wl("customOAuthParameters")]}}),$l(To,"credential",So,[Yl(Bl(),Wl(),"token")]),Xl(Co.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Wl("customOAuthParameters")]}}),$l(Co,"credential",Ao,[Yl(Bl(),Yl(Wl(),zl()),"idToken"),Yl(Bl(),zl(),"accessToken",!0)]),Xl(No.prototype,{Ka:{name:"setCustomParameters",j:[Wl("customOAuthParameters")]}}),$l(No,"credential",ko,[Yl(Bl(),Wl(),"token"),Bl("secret",!0)]),Xl(wo.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},credential:{name:"credential",j:[Yl(Bl(),Yl(Wl(),zl()),"optionsOrIdToken"),Yl(Bl(),zl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Wl("customOAuthParameters")]}}),Xl(yo.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(fo.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),$l(jo,"credential",Uo,[Bl("verificationId"),Bl("verificationCode")]),Xl(jo.prototype,{fb:{name:"verifyPhoneNumber",j:[Yl(Bl(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Jl(t.session,uo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Jl(t.session,co)&&Ql(t.multiFactorHint):t.session&&t.multiFactorUid?Jl(t.session,co)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Xl(Lo.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(A.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(Jo.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(Ko.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(rh.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(th.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Xl(ch.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},Bl("displayName",!0)]},bd:{name:"unenroll",j:[Yl({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Ql},Bl(),"multiFactorInfoIdentifier")]}}),Xl(Ul.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),$l(Ii,"parseLink",Di,[Bl("link")]),$l(Tl,"assertion",(function(t){return new ah(t)}),[Kl("phone")]),function(){if(void 0===r.Z||!r.Z.INTERNAL||!r.Z.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:li,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:hi,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:il,AuthCredential:ho,Error:A};$l(t,"EmailAuthProvider",Oo,[]),$l(t,"FacebookAuthProvider",Eo,[]),$l(t,"GithubAuthProvider",To,[]),$l(t,"GoogleAuthProvider",Co,[]),$l(t,"TwitterAuthProvider",No,[]),$l(t,"OAuthProvider",wo,[Bl("providerId")]),$l(t,"SAMLAuthProvider",_o,[Bl("providerId")]),$l(t,"PhoneAuthProvider",jo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof il)}}]),$l(t,"RecaptchaVerifier",Ul,[Yl(Bl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Wl("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.Z.app.App)}}]),$l(t,"ActionCodeURL",Ii,[]),$l(t,"PhoneMultiFactorGenerator",Tl,[]),r.Z.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new il(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.Z.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:E((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:E(t.nc,t),addAuthTokenListener:E(t.cc,t),removeAuthTokenListener:E(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.Z.registerVersion("@firebase/auth","0.16.3"),r.Z.INTERNAL.extendNamespace({User:mh})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},909:(t,e,n)=>{"use strict";n.d(e,{wA:()=>o,H0:()=>u,zt:()=>a});var r=n(655),i=n(589),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=s);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.BH;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=(0,r.pi)({identifier:s,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);try{var a=this.getOrInitializeService(o);if(!a){if(i)return null;throw Error("Service "+this.name+" is not available")}return a}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService(s)}catch(t){}try{for(var i=(0,r.XA)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var a=(0,r.CR)(o.value,2),u=a[0],c=a[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=s),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.fl)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})),t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()}))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===s?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:s:t},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},446:(t,e,n)=>{"use strict";var r=n(99),i=n(655),o=n(589),s=n(594),a=n(909);t=n.hmd(t);var u,c=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.Pz)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.cI)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.r3)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c(e)}}catch(t){}return new h},f=l("localStorage"),p=l("sessionStorage"),d=new s.Yd("@firebase/database"),v=(u=1,function(){return u++}),y=function(t){var e=(0,o.dS)(t),n=new o.gQ;n.update(e);var r=n.digest();return o.US.encodeByteArray(r)},g=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=g.apply(null,i):n+="object"==typeof i?(0,o.Pz)(i):i,n+=" "}return n},m=null,b=!0,_=function(t,e){(0,o.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(d.logLevel=s.in.VERBOSE,m=d.log.bind(d),e&&p.set("logging_enabled",!0)):"function"==typeof t?m=t:(m=null,p.remove("logging_enabled"))},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===m&&!0===p.get("logging_enabled")&&_(!0)),m){var n=g.apply(null,t);m(n)}},E=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];w.apply(void 0,(0,i.fl)([t],e))}},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+g.apply(void 0,(0,i.fl)(t));d.error(n)},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+g.apply(void 0,(0,i.fl)(t));throw d.error(n),new Error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+g.apply(void 0,(0,i.fl)(t));d.warn(n)},C=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",N="[MAX_NAME]",k=function(t,e){if(t===e)return 0;if(t===A||e===N)return-1;if(e===A||t===N)return 1;var n=z(t),r=z(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},P=function(t,e){return t===e?0:t<e?-1:1},D=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.Pz)(e))},O=function(t){if("object"!=typeof t||null===t)return(0,o.Pz)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.Pz)(e[i]),r+=":",r+=O(t[e[i]]);return r+"}"},R=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function x(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var L,M,F,j,U,V,q,B,G,W=function(t){(0,o.hu)(!C(t),"Invalid JSON number");var e,n,r,i,s;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var a=[];for(s=52;s;s-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var u=a.join(""),c="";for(s=0;s<64;s+=8){var h=parseInt(u.substr(s,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()},H=new RegExp("^-?(0*)\\d{1,10}$"),z=function(t){if(H.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},K=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw S("Exception was thrown by user callback.",e),t}),Math.floor(0))}},J=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},Q=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!1,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=k(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),Y=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.ug)(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=(0,o.ug)(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=(0,o.ug)(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),X=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Z="websocket",$="long_polling",tt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){var n;if((0,o.hu)("string"==typeof t,"typeof type must == string"),(0,o.hu)("object"==typeof e,"typeof params must == object"),t===Z)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==$)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return x(e,(function(t,e){r.push(t+"="+e)})),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}(),et=function(t,e){var n=nt(t),r=n.namespace;"firebase.com"===n.domain&&T(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new tt(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new Q(n.pathString)}},nt=function(t){var e="",n="",r="",o="",s="",a=!0,u="https",c=443;if("string"==typeof t){var h=t.indexOf("//");h>=0&&(u=t.substring(0,h-1),t=t.substring(h+2));var l=t.indexOf("/");-1===l&&(l=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(l,f)),l<f&&(o=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(l,f)));var p=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var o=(0,i.XA)(t.split("&")),s=o.next();!s.done;s=o.next()){var a=s.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):S("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(h=e.indexOf(":"))>=0?(a="https"===u||"wss"===u,c=parseInt(e.substring(h+1),10)):h=e.length;var d=e.slice(0,h);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),s=r}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:a,scheme:u,pathString:o,namespace:s}},rt=/[\[\].#$\/\u0000-\u001F\u007F]/,it=/[\[\].#$\u0000-\u001F\u007F]/,ot=10485760,st=function(t){return"string"==typeof t&&0!==t.length&&!rt.test(t)},at=function(t){return"string"==typeof t&&0!==t.length&&!it.test(t)},ut=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!C(t)||t&&"object"==typeof t&&(0,o.r3)(t,".sv")},ct=function(t,e,n,r,i){i&&void 0===n||ht((0,o.gK)(t,e,i),n,r)},ht=function(t,e,n){var r=n instanceof Q?new Y(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(C(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>ot/3&&(0,o.ug)(e)>ot)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,s=!1;if(x(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!st(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),ht(t,n,r),r.pop()})),i&&s)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},lt=function(t,e,n,r,i){if(!i||void 0!==n){var s=(0,o.gK)(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(s+" must be an object containing the children to replace.");var a=[];x(n,(function(t,e){var n=new Q(t);if(ht(s,e,r.child(n)),".priority"===n.getBack()&&!ut(e))throw new Error(s+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!st(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Q.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(s,a)}},ft=function(t,e,n,r){if(!r||void 0!==n){if(C(n))throw new Error((0,o.gK)(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ut(n))throw new Error((0,o.gK)(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},pt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.gK)(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},dt=function(t,e,n,r){if(!(r&&void 0===n||st(n)))throw new Error((0,o.gK)(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},vt=function(t,e,n,r){if(!(r&&void 0===n||at(n)))throw new Error((0,o.gK)(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},yt=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),vt(t,e,n,r)},gt=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},mt=function(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!st(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),at(t)}(r))throw new Error((0,o.gK)(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},bt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,o.gK)(t,e,r)+"must be a boolean.")},_t=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){(0,o.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,o.Wj)("OnDisconnect.cancel",1,t,!0);var e=new o.BH;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){(0,o.Dv)("OnDisconnect.remove",0,1,arguments.length),gt("OnDisconnect.remove",this.path_),(0,o.Wj)("OnDisconnect.remove",1,t,!0);var e=new o.BH;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){(0,o.Dv)("OnDisconnect.set",1,2,arguments.length),gt("OnDisconnect.set",this.path_),ct("OnDisconnect.set",1,t,this.path_,!1),(0,o.Wj)("OnDisconnect.set",2,e,!0);var n=new o.BH;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){(0,o.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),gt("OnDisconnect.setWithPriority",this.path_),ct("OnDisconnect.setWithPriority",1,t,this.path_,!1),ft("OnDisconnect.setWithPriority",2,e,!1),(0,o.Wj)("OnDisconnect.setWithPriority",3,n,!0);var r=new o.BH;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if((0,o.Dv)("OnDisconnect.update",1,2,arguments.length),gt("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}lt("OnDisconnect.update",1,t,this.path_,!1),(0,o.Wj)("OnDisconnect.update",2,e,!0);var i=new o.BH;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),wt=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Et="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",It=(L=0,M=[],function(t){var e,n=t===L;L=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=Et.charAt(t%64),t=Math.floor(t/64);(0,o.hu)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===M[e];e--)M[e]=0;M[e]++}else for(e=0;e<12;e++)M[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=Et.charAt(M[e]);return(0,o.hu)(20===i.length,"nextPushId: Length should be 20."),i}),Tt=function(t){if("2147483647"===t)return"-";var e=z(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return N;var o=n[i],s=Et.charAt(Et.indexOf(o)+1);return n[i]=s,n.slice(0,i+1).join("")},St=function(t){if("-2147483648"===t)return A;var e=z(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=Et.charAt(Et.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))},Ct=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),At=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ct(A,t),r=new Ct(A,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ct.MIN},t}(),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return F},set:function(t){F=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return k(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return new Ct(N,F)},e.prototype.makePost=function(t,e){return(0,o.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ct(t,F)},e.prototype.toString=function(){return".key"},e}(At),kt=new Nt,Pt=function(t){return"number"==typeof t?"number:"+W(t):"string:"+t},Dt=function(t){if(t.isLeafNode()){var e=t.val();(0,o.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.r3)(e,".sv"),"Priority must be a string or number.")}else(0,o.hu)(t===j||t.isEmpty(),"priority of unexpected type.");(0,o.hu)(t===j||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ot=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Dt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return U},set:function(t){U=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.hu)(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Pt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?W(this.value_):this.value_,this.lazyHash_=y(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.hu)(i>=0,"Unknown leaf type: "+n),(0,o.hu)(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Rt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?k(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return new Ct(N,new Ot("[PRIORITY-POST]",q))},e.prototype.makePost=function(t,e){var n=V(t);return new Ct(e,new Ot("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(At)),xt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Lt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Ft.EMPTY_NODE,this.right=null!=o?o:Ft.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Ft.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Ft.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Mt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Lt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Ft=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Lt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Lt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new xt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new xt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new xt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new xt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Mt,t}(),jt=Math.log(2),Ut=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/jt,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),Vt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,s,a=r-e;if(0===a)return null;if(1===a)return o=t[e],s=n?n(o):o,new Lt(s,o.node,Lt.BLACK,null,null);var u=parseInt(a/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],s=n?n(o):o,new Lt(s,o.node,Lt.BLACK,c,h)},o=function(e){for(var r=null,o=null,s=t.length,a=function(e,r){var o=s-e,a=s;s-=e;var c=i(o+1,a),h=t[o],l=n?n(h):h;u(new Lt(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?a(l,Lt.BLACK):(a(l,Lt.BLACK),a(l,Lt.RED))}return o}(new Ut(t.length));return new Ft(r||e,o)},qt={},Bt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.hu)(qt&&Rt,"ChildrenNode.ts has not been loaded"),B=B||new t({".priority":qt},{".priority":Rt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ft?e:null},t.prototype.hasIndex=function(t){return(0,o.r3)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.hu)(e!==kt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,s=[],a=!1,u=n.getIterator(Ct.Wrap),c=u.getNext();c;)a=a||e.isDefinedOn(c.node),s.push(c),c=u.getNext();r=a?Vt(s,e.getCompare()):qt;var h=e.toString(),l=(0,i.pi)({},this.indexSet_);l[h]=e;var f=(0,i.pi)({},this.indexes_);return f[h]=r,new t(f,l)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.UI)(this.indexes_,(function(t,i){var s=(0,o.DV)(r.indexSet_,i);if((0,o.hu)(s,"Missing index implementation for "+i),t===qt){if(s.isDefinedOn(e.node)){for(var a=[],u=n.getIterator(Ct.Wrap),c=u.getNext();c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Vt(a,s.getCompare())}return qt}var h=n.get(e.name),l=t;return h&&(l=l.remove(new Ct(e.name,h))),l.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.UI)(this.indexes_,(function(t){if(t===qt)return t;var r=n.get(e.name);return r?t.remove(new Ct(e.name,r)):t})),this.indexSet_)},t}();function Gt(t,e){return k(t.name,e.name)}function Wt(t,e){return k(t,e)}var Ht=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Dt(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return G||(G=new t(new Ft(Wt),null,Bt.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||G},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?G:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ct(e,n),i=void 0,s=void 0;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));var a=i.isEmpty()?G:this.priorityNode_;return new t(i,a,s)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;(0,o.hu)(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Rt,(function(s,a){n[s]=a.val(e),r++,o&&t.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1})),!e&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Pt(this.getPriority().val())+":"),this.forEachChild(Rt,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":y(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ct(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ct(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ct(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Ct.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Ct.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===zt?-1:0},t.prototype.withIndex=function(e){if(e===kt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===kt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Rt),r=e.getIterator(Rt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===kt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),zt=new(function(t){function e(){return t.call(this,new Ft(Wt),Ht.EMPTY_NODE,Bt.Default)||this}return(0,i.ZT)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Ht.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Ht));function Kt(t,e){if(void 0===e&&(e=null),null===t)return Ht.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Ot(t,Kt(e));if(t instanceof Array){var n=Ht.EMPTY_NODE;return x(t,(function(e,r){if((0,o.r3)(t,e)&&"."!==e.substring(0,1)){var i=Kt(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(Kt(e))}var r=[],i=!1;if(x(t,(function(t,e){if("."!==t.substring(0,1)){var n=Kt(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ct(t,n)))}})),0===r.length)return Ht.EMPTY_NODE;var s=Vt(r,Gt,(function(t){return t.name}),Wt);if(i){var a=Vt(r,Rt.getCompare());return new Ht(s,Kt(e),new Bt({".priority":a},{".priority":Rt}))}return new Ht(s,Kt(e),Bt.Default)}Object.defineProperties(Ct,{MIN:{value:new Ct(A,Ht.EMPTY_NODE)},MAX:{value:new Ct(N,zt)}}),Nt.__EMPTY_NODE=Ht.EMPTY_NODE,Ot.__childrenNodeConstructor=Ht,j=zt,q=zt,function(t){V=t}(Kt);var Jt,Qt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,i.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?k(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ct.MIN},e.prototype.maxPost=function(){return Ct.MAX},e.prototype.makePost=function(t,e){var n=Kt(t);return new Ct(e,n)},e.prototype.toString=function(){return".value"},e}(At)),Yt=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.hu)(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return(0,i.ZT)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?k(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=Kt(t),r=Ht.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ct(e,r)},e.prototype.maxPost=function(){var t=Ht.EMPTY_NODE.updateChild(this.indexPath_,zt);return new Ct(N,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(At),Xt=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return(0,o.Dv)("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return(0,o.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return(0,o.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return(0,o.Dv)("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){(0,o.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),vt("DataSnapshot.child",1,e,!1);var n=new Q(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Rt)},t.prototype.hasChild=function(t){(0,o.Dv)("DataSnapshot.hasChild",1,1,arguments.length),vt("DataSnapshot.hasChild",1,t,!1);var e=new Q(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return(0,o.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;if((0,o.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,o.Wj)("DataSnapshot.forEach",1,e,!1),this.node_.isLeafNode())return!1;var r=this.node_;return!!r.forEachChild(this.index_,(function(r,i){return e(new t(i,n.ref_.child(r),Rt))}))},t.prototype.hasChildren=function(){return(0,o.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return(0,o.Dv)("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Zt=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.Pz)(this.snapshot.exportVal())},t}(),$t=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),te=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new Zt("value",this,new Xt(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){(0,o.hu)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new $t(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),ee=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,(0,o.r3)(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new $t(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.hu)(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new Zt(t.type,this,new Xt(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){(0,o.hu)(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var r=Object.keys(e.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||e.callbacks_[s]&&this.callbacks_[a]&&e.callbacks_[s]!==this.callbacks_[a])}return i.every((function(t){return e.callbacks_[t]===n.callbacks_[t]}))}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),ne=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return(0,o.hu)(Jt,"Reference.ts has not been loaded"),Jt},set:function(t){Jt=t},enumerable:!1,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===kt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==A)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==N)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Rt){if(null!=e&&!ut(e)||null!=n&&!ut(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.hu)(t.getIndex()instanceof Yt||t.getIndex()===Qt,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return(0,o.Dv)("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){(0,o.Dv)("Query.on",2,4,arguments.length),pt("Query.on",1,e,!1),(0,o.Wj)("Query.on",2,n,!1);var s=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,s.cancel,s.context);else{var a={};a[e]=n,this.onChildEvent(a,s.cancel,s.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new te(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new ee(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){(0,o.Dv)("Query.off",0,3,arguments.length),pt("Query.off",1,t,!0),(0,o.Wj)("Query.off",2,e,!0),(0,o.lb)("Query.off",3,n,!0);var r=null,i=null;if("value"===t){var s=e||null;r=new te(s,null,n||null)}else t&&(e&&((i={})[t]=e),r=new ee(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.get=function(){return this.repo.getValue(this)},t.prototype.once=function(e,n,r,i){var s=this;(0,o.Dv)("Query.once",1,4,arguments.length),pt("Query.once",1,e,!1),(0,o.Wj)("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new o.BH;c.promise.catch((function(){}));var h=function(t){u&&(u=!1,s.off(e,h),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,h,(function(t){s.off(e,h),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)})),c.promise},t.prototype.limitToFirst=function(e){if((0,o.Dv)("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if((0,o.Dv)("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if((0,o.Dv)("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');vt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new Q(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new Yt(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){(0,o.Dv)("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(kt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){(0,o.Dv)("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Rt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){(0,o.Dv)("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(Qt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),(0,o.Dv)("Query.startAt",0,2,arguments.length),ct("Query.startAt",1,e,this.path,!0),dt("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.startAfter=function(e,n){void 0===e&&(e=null),(0,o.Dv)("Query.startAfter",0,2,arguments.length),ct("Query.startAfter",1,e,this.path,!1),dt("Query.startAfter",2,n,!0);var r=this.queryParams_.startAfter(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAfter: Starting point was already set (by another call to startAt, startAfter or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),(0,o.Dv)("Query.endAt",0,2,arguments.length),ct("Query.endAt",1,e,this.path,!0),dt("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endBefore=function(e,n){void 0===e&&(e=null),(0,o.Dv)("Query.endBefore",0,2,arguments.length),ct("Query.endBefore",1,e,this.path,!1),dt("Query.endBefore",2,n,!0);var r=this.queryParams_.endBefore(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endBefore: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if((0,o.Dv)("Query.equalTo",1,2,arguments.length),ct("Query.equalTo",1,t,this.path,!1),dt("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return(0,o.Dv)("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return(0,o.Dv)("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=O(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if((0,o.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}var r=this.repo===e.repo,i=this.path.equals(e.path),s=this.queryIdentifier()===e.queryIdentifier();return r&&i&&s},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,(0,o.Wj)(t,3,r.cancel,!0),r.context=n,(0,o.lb)(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error((0,o.gK)(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),re=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),ie=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=this.path_.child(e);return new t(this.syncTree_,n)},t.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},t}(),oe=function(t,e,n){return t&&"object"==typeof t?((0,o.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?se(t[".sv"],e,n):"object"==typeof t[".sv"]?ae(t[".sv"],e):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},se=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.hu)(!1,"Unexpected server value: "+t)}},ae=function(t,e,n){t.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&(0,o.hu)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var s=i.getValue();return"number"!=typeof s?r:s+r},ue=function(t,e,n,r){return he(e,new ie(n,t),r)},ce=function(t,e,n){return he(t,new re(e),n)};function he(t,e,n){var r,i=t.getPriority().val(),o=oe(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var s=t,a=oe(s.getValue(),e,n);return a!==s.getValue()||o!==s.getPriority().val()?new Ot(a,Kt(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Ot(o))),u.forEachChild(Rt,(function(t,i){var o=he(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var le,fe=function(){function t(){this.value=null,this.children=new Map}return t.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&this.children.size>0){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(e,n);else{var r=e.getFront();this.children.has(r)||this.children.set(r,new t);var i=this.children.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(Rt,(function(t,e){n.remember(new Q(t),e)})),this.forget(t)}if(this.children.size>0){var r=t.getFront();return t=t.popFront(),this.children.has(r)&&this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},t.prototype.forEachTree=function(t,e){null!==this.value?e(t,this.value):this.forEachChild((function(n,r){var i=new Q(t.toString()+"/"+n);r.forEachTree(i,e)}))},t.prototype.forEachChild=function(t){this.children.forEach((function(e,n){t(n,e)}))},t}();!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(le||(le={}));var pe,de=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,(0,o.hu)(!r||e,"Tagged queries must be from server.")}return t.user=function(){return new t(!0,!1,null,!1)},t.server=function(){return new t(!1,!0,null,!1)},t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),ve=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=le.ACK_USER_WRITE,this.source=de.user()}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new Q(e));return new t(Q.Empty,n,this.revert)}return(0,o.hu)(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),ye=function(){function t(t,e){void 0===e&&(pe||(pe=new Ft(P)),e=pe),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return x(e,(function(t,e){n=n.set(new Q(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Q.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null!=i?{path:new Q(n).child(i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):new t(null)},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=(this.children.get(r)||new t(null)).set(e.popFront(),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?new t(null):new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r,i=e.getFront(),o=(this.children.get(i)||new t(null)).setTree(e.popFront(),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(Q.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(t.child(r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Q.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Q.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(Q.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(t.child(n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),ge=function(){function t(t,e){this.source=t,this.path=e,this.type=le.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Q.Empty):new t(this.source,this.path.popFront())},t}(),me=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=le.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Q.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),be=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=le.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new Q(e));return n.isEmpty()?null:n.value?new me(this.source,Q.Empty,n.value):new t(this.source,Q.Empty,n)}return(0,o.hu)(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),_e=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),we=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new _e(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new _e(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t}();function Ee(t){return{type:"value",snapshotNode:t}}function Ie(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Te(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Se(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var Ce,Ae=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,s){(0,o.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(Te(e,a)):(0,o.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(Ie(e,n)):s.trackChildChange(Se(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Rt,(function(t,r){e.hasChild(t)||n.trackChildChange(Te(t,r))})),e.isLeafNode()||e.forEachChild(Rt,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Se(e,r,i))}else n.trackChildChange(Ie(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Ht.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ne=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,Se(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,Te(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,Ie(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.g5)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Se(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),ke=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Pe=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new _e(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),De=function(t,e){this.viewCache=t,this.changes=e},Oe=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){(0,o.hu)(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),(0,o.hu)(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var s,a,u=new Ne;if(n.type===le.OVERWRITE){var c=n;c.source.fromUser?s=this.applyUserOverwrite_(e,c.path,c.snap,r,i,u):((0,o.hu)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered()&&!c.path.isEmpty(),s=this.applyServerOverwrite_(e,c.path,c.snap,r,i,a,u))}else if(n.type===le.MERGE){var h=n;h.source.fromUser?s=this.applyUserMerge_(e,h.path,h.children,r,i,u):((0,o.hu)(h.source.fromServer,"Unknown source."),a=h.source.tagged||e.getServerCache().isFiltered(),s=this.applyServerMerge_(e,h.path,h.children,r,i,a,u))}else if(n.type===le.ACK_USER_WRITE){var l=n;s=l.revert?this.revertUserWrite_(e,l.path,r,i,u):this.ackUserWrite_(e,l.path,l.affectedTree,r,i,u)}else{if(n.type!==le.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);s=this.listenComplete_(e,n.path,r,u)}var f=u.getChanges();return t.maybeAddValueEvent_(e,s,f),new De(s,f)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Ee(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var s=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,u=void 0;if(e.isEmpty())if((0,o.hu)(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var c=t.getCompleteServerSnap(),h=c instanceof Ht?c:Ht.EMPTY_NODE,l=n.calcCompleteEventChildren(h);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var f=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),f,i)}else{var p=e.getFront();if(".priority"===p){(0,o.hu)(1===e.getLength(),"Can't have a priority with additional path components");var d=s.getNode();u=t.getServerCache().getNode();var v=n.calcEventCacheAfterServerOverwrite(e,d,u);a=null!=v?this.filter_.updatePriority(d,v):s.getNode()}else{var y=e.popFront(),g=void 0;if(s.isCompleteForChild(p)){u=t.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(e,s.getNode(),u);g=null!=m?s.getNode().getImmediateChild(p).updateChild(y,m):s.getNode().getImmediateChild(p)}else g=n.calcCompleteChild(p,t.getServerCache());a=null!=g?this.filter_.updateChild(s.getNode(),p,g,y,r,i):s.getNode()}}return t.updateEventSnap(a,s.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),p=u.getNode().getImmediateChild(l).updateChild(f,n);a=".priority"===l?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),l,p,f,ke,null)}var d=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),v=new Pe(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,v,s)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new Pe(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var h=e.getFront();if(".priority"===h)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),f=u.getNode().getImmediateChild(h),p=void 0;if(l.isEmpty())p=n;else{var d=c.getCompleteChild(h);p=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):Ht.EMPTY_NODE}if(f.equals(p))s=t;else{var v=this.filter_.updateChild(u.getNode(),h,p,l,c,o);s=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,s){var a=this,u=e;return r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())&&(u=a.applyUserOverwrite_(u,h,c,i,o,s))})),r.foreach((function(r,c){var h=n.child(r);t.cacheHasChild_(e,h.getFront())||(u=a.applyUserOverwrite_(u,h,c,i,o,s))})),u},t.prototype.applyMerge_=function(t,e){return e.foreach((function(e,n){t=t.updateChild(e,n)})),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,s){var a=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:new ye(null).setTree(e,n);var h=t.getServerCache().getNode();return u.children.inorderTraversal((function(e,n){if(h.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),l=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new Q(e),l,r,i,o,s)}})),u.children.inorderTraversal((function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!h.hasChild(e)&&!u){var l=t.getServerCache().getNode().getImmediateChild(e),f=a.applyMerge_(l,n);c=a.applyServerOverwrite_(c,new Q(e),f,r,i,o,s)}})),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,a.getNode().getChild(e),r,i,s,o);if(e.isEmpty()){var u=new ye(null);return a.getNode().forEachChild(kt,(function(t,e){u=u.set(new Q(t),e)})),this.applyServerMerge_(t,e,u,r,i,s,o)}return t}var c=new ye(null);return n.foreach((function(t,n){var r=e.child(t);a.isCompleteForPath(r)&&(c=c.set(t,a.getNode().getChild(r)))})),this.applyServerMerge_(t,e,c,r,i,s,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,ke,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var s;if(null!=n.shadowingWrite(e))return t;var a=new Pe(n,t,r),u=t.getEventCache().getNode(),c=void 0;if(e.isEmpty()||".priority"===e.getFront()){var h=void 0;if(t.getServerCache().isFullyInitialized())h=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();(0,o.hu)(l instanceof Ht,"serverChildren would be complete if leaf node"),h=n.calcCompleteEventChildren(l)}h=h,c=this.filter_.updateFullNode(u,h,i)}else{var f=e.getFront(),p=n.calcCompleteChild(f,t.getServerCache());null==p&&t.getServerCache().isCompleteForChild(f)&&(p=u.getImmediateChild(f)),(c=null!=p?this.filter_.updateChild(u,f,p,e.popFront(),a,i):t.getEventCache().getNode().hasChild(f)?this.filter_.updateChild(u,f,Ht.EMPTY_NODE,e.popFront(),a,i):u).isEmpty()&&t.getServerCache().isFullyInitialized()&&(s=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,s,i))}return s=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Q.Empty),t.updateEventSnap(c,s,this.filter_.filtersNodes())},t}(),Re=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach((function(t){var e;"child_changed"===t.type&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((e=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:e}))})),this.generateEventsForType_(i,"child_removed",t,n,e),this.generateEventsForType_(i,"child_added",t,n,e),this.generateEventsForType_(i,"child_moved",o,n,e),this.generateEventsForType_(i,"child_changed",t,n,e),this.generateEventsForType_(i,"value",t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,s=n.filter((function(t){return t.type===e}));s.sort(this.compareChanges_.bind(this)),s.forEach((function(e){var n=o.materializeSingleChange_(e,i);r.forEach((function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))}))}))},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw(0,o.g5)("Should only compare child_ events.");var n=new Ct(t.childName,t.snapshotNode),r=new Ct(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),xe=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Ae(n.getIndex()),i=n.getNodeFilter();this.processor_=new Oe(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(Ht.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Ht.EMPTY_NODE,s.getNode(),null),c=new _e(a,o.isFullyInitialized(),r.filtersNodes()),h=new _e(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new we(h,c),this.eventGenerator_=new Re(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteNode=function(){return this.viewCache_.getCompleteEventSnap()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){(0,o.hu)(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach((function(t){var i=t.createCancelEvent(e,r);i&&n.push(i)}))}if(t){for(var i=[],s=0;s<this.eventRegistrations_.length;++s){var a=this.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(s+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===le.MERGE&&null!==t.source.queryId&&((0,o.hu)(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),(0,o.hu)(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),(0,o.hu)(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(Rt,(function(t,e){n.push(Ie(t,e))})),e.isFullyInitialized()&&n.push(Ee(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),Le=function(){function t(){this.views=new Map}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return(0,o.hu)(Ce,"Reference.ts has not been loaded"),Ce},set:function(t){(0,o.hu)(!Ce,"__referenceConstructor has already been defined"),Ce=t},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return 0===this.views.size},t.prototype.applyOperation=function(t,e,n){var r,s,a=t.source.queryId;if(null!==a){var u=this.views.get(a);return(0,o.hu)(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(t,e,n)}var c=[];try{for(var h=(0,i.XA)(this.views.values()),l=h.next();!l.done;l=h.next())u=l.value,c=c.concat(u.applyOperation(t,e,n))}catch(t){r={error:t}}finally{try{l&&!l.done&&(s=h.return)&&s.call(h)}finally{if(r)throw r.error}}return c},t.prototype.getView=function(t,e,n,r){var i=t.queryIdentifier(),o=this.views.get(i);if(!o){var s=e.calcCompleteEventCache(r?n:null),a=!1;s?a=!0:n instanceof Ht?(s=e.calcCompleteEventChildren(n),a=!1):(s=Ht.EMPTY_NODE,a=!1);var u=new we(new _e(s,a,!1),new _e(n,r,!1));return new xe(t,u)}return o},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=this.getView(t,n,r,i);return this.views.has(t.queryIdentifier())||this.views.set(t.queryIdentifier(),o),o.addEventRegistration(e),o.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var o,s,a=e.queryIdentifier(),u=[],c=[],h=this.hasCompleteView();if("default"===a)try{for(var l=(0,i.XA)(this.views.entries()),f=l.next();!f.done;f=l.next()){var p=(0,i.CR)(f.value,2),d=p[0],v=p[1];c=c.concat(v.removeEventRegistration(n,r)),v.isEmpty()&&(this.views.delete(d),v.getQuery().getQueryParams().loadsAllData()||u.push(v.getQuery()))}}catch(t){o={error:t}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}else(v=this.views.get(a))&&(c=c.concat(v.removeEventRegistration(n,r)),v.isEmpty()&&(this.views.delete(a),v.getQuery().getQueryParams().loadsAllData()||u.push(v.getQuery())));return h&&!this.hasCompleteView()&&u.push(new t.__referenceConstructor(e.repo,e.path)),{removed:u,events:c}},t.prototype.getQueryViews=function(){var t,e,n=[];try{for(var r=(0,i.XA)(this.views.values()),o=r.next();!o.done;o=r.next()){var s=o.value;s.getQuery().getQueryParams().loadsAllData()||n.push(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},t.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var o=(0,i.XA)(this.views.values()),s=o.next();!s.done;s=o.next()){var a=s.value;r=r||a.getCompleteServerCache(t)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){var t,e;try{for(var n=(0,i.XA)(this.views.values()),r=n.next();!r.done;r=n.next()){var o=r.value;if(o.getQuery().getQueryParams().loadsAllData())return o}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}return null},t}(),Me=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new ye(null))},t}();function Fe(t,e,n){if(e.isEmpty())return new Me(new ye(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,s=Q.relativePath(i,e);return o=o.updateChild(s,n),new Me(t.writeTree_.set(i,o))}var a=new ye(n),u=t.writeTree_.setTree(e,a);return new Me(u)}function je(t,e,n){var r=t;return x(n,(function(t,n){r=Fe(r,e.child(t),n)})),r}function Ue(t,e){if(e.isEmpty())return Me.empty();var n=t.writeTree_.setTree(e,new ye(null));return new Me(n)}function Ve(t,e){return null!=qe(t,e)}function qe(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(Q.relativePath(n.path,e)):null}function Be(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Rt,(function(t,n){e.push(new Ct(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ct(t,n.value))})),e}function Ge(t,e){if(e.isEmpty())return t;var n=qe(t,e);return new Me(null!=n?new ye(n):t.writeTree_.subtree(e))}function We(t){return t.writeTree_.isEmpty()}function He(t,e){return ze(Q.Empty,t.writeTree_,e)}function ze(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.hu)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=ze(t.child(e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(t.child(".priority"),r)),n}var Ke=function(){function t(){this.visibleWrites_=Me.empty(),this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Je(t,this)},t.prototype.addOverwrite=function(t,e,n,r){(0,o.hu)(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=Fe(this.visibleWrites_,t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){(0,o.hu)(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=je(this.visibleWrites_,t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex((function(e){return e.writeId===t}));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,s=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(s=!0)),a--}return!!i&&(s?(this.resetTree_(),!0):(r.snap?this.visibleWrites_=Ue(this.visibleWrites_,r.path):x(r.children,(function(t){e.visibleWrites_=Ue(e.visibleWrites_,r.path.child(t))})),!0))},t.prototype.getCompleteWriteData=function(t){return qe(this.visibleWrites_,t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=Ge(this.visibleWrites_,e);return!i&&We(o)?n:i||null!=n||Ve(o,Q.Empty)?He(t.layerTree_(this.allWrites_,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))}),e),n||Ht.EMPTY_NODE):null}var s=qe(this.visibleWrites_,e);if(null!=s)return s;var a=Ge(this.visibleWrites_,e);return We(a)?n:null!=n||Ve(a,Q.Empty)?He(a,n||Ht.EMPTY_NODE):null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Ht.EMPTY_NODE,r=qe(this.visibleWrites_,t);if(r)return r.isLeafNode()||r.forEachChild(Rt,(function(t,e){n=n.updateImmediateChild(t,e)})),n;if(e){var i=Ge(this.visibleWrites_,t);return e.forEachChild(Rt,(function(t,e){var r=He(Ge(i,new Q(t)),e);n=n.updateImmediateChild(t,r)})),Be(i).forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n}return Be(Ge(this.visibleWrites_,t)).forEach((function(t){n=n.updateImmediateChild(t.name,t.node)})),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){(0,o.hu)(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(Ve(this.visibleWrites_,i))return null;var s=Ge(this.visibleWrites_,i);return We(s)?r.getChild(e):He(s,r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=qe(this.visibleWrites_,r);return null!=i?i:n.isCompleteForChild(e)?He(Ge(this.visibleWrites_,r),n.getNode().getImmediateChild(e)):null},t.prototype.shadowingWrite=function(t){return qe(this.visibleWrites_,t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=Ge(this.visibleWrites_,t),u=qe(a,Q.Empty);if(null!=u)s=u;else{if(null==e)return[];s=He(a,e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),f=l.getNext();f&&c.length<r;)0!==h(f,n)&&c.push(f),f=l.getNext();return c},t.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,Q.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Me.empty(),i=0;i<t.length;++i){var s=t[i];if(e(s)){var a=s.path,u=void 0;if(s.snap)n.contains(a)?r=Fe(r,u=Q.relativePath(n,a),s.snap):a.contains(n)&&(u=Q.relativePath(a,n),r=Fe(r,Q.Empty,s.snap.getChild(u)));else{if(!s.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(n.contains(a))r=je(r,u=Q.relativePath(n,a),s.children);else if(a.contains(n))if((u=Q.relativePath(a,n)).isEmpty())r=je(r,Q.Empty,s.children);else{var c=(0,o.DV)(s.children,u.getFront());if(c){var h=c.getChild(u.popFront());r=Fe(r,Q.Empty,h)}}}}}return r},t}(),Je=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),Qe=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=new ye(null),this.pendingWriteTree_=new Ke,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new me(de.user(),t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=ye.fromObject(e);return this.applyOperationToSyncPoints_(new be(de.user(),t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=new ye(null);return null!=n.snap?r=r.set(Q.Empty,!0):x(n.children,(function(t){r=r.set(new Q(t),!0)})),this.applyOperationToSyncPoints_(new ve(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new me(de.server(),t,e))},t.prototype.applyServerMerge=function(t,e){var n=ye.fromObject(e);return this.applyOperationToSyncPoints_(new be(de.server(),t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new ge(de.server(),t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=Q.relativePath(s,e),c=new me(de.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),s=o.path,a=o.queryId,u=Q.relativePath(s,e),c=ye.fromObject(n),h=new be(de.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,h)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,s=i.queryId,a=Q.relativePath(o,e),u=new ge(de.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,s=!1;this.syncPointTree_.foreachOnPath(r,(function(t,e){var n=Q.relativePath(t,r);i=i||e.getCompleteServerCache(n),s=s||e.hasCompleteView()}));var a,u=this.syncPointTree_.get(r);u?(s=s||u.hasCompleteView(),i=i||u.getCompleteServerCache(Q.Empty)):(u=new Le,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i?a=!0:(a=!1,i=Ht.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=e.getCompleteServerCache(Q.Empty);n&&(i=i.updateImmediateChild(t,n))})));var c=u.viewExistsForQuery(e);if(!c&&!e.getQueryParams().loadsAllData()){var h=t.makeQueryKey_(e);(0,o.hu)(!this.queryToTagMap.has(h),"View does not exist, but we have a tag");var l=t.getNextQueryTag_();this.queryToTagMap.set(h,l),this.tagToQueryMap.set(l,h)}var f=this.pendingWriteTree_.childWrites(r),p=u.addEventRegistration(e,n,f,i,a);if(!c&&!s){var d=u.viewForQuery(e);p=p.concat(this.setupListener_(e,d))}return p},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===e.queryIdentifier()||s.viewExistsForQuery(e))){var u=s.removeEventRegistration(e,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var h=-1!==c.findIndex((function(t){return t.getQueryParams().loadsAllData()})),l=this.syncPointTree_.findOnPath(o,(function(t,e){return e.hasCompleteView()}));if(h&&!l){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(f),d=0;d<p.length;++d){var v=p[d],y=v.getQuery(),g=this.createListenerForView_(v);this.listenProvider_.startListening(t.queryForListening_(y),this.tagForQuery_(y),g.hashFn,g.onComplete)}}!l&&c.length>0&&!r&&(h?this.listenProvider_.stopListening(t.queryForListening_(e),null):c.forEach((function(e){var n=i.queryToTagMap.get(t.makeQueryKey_(e));i.listenProvider_.stopListening(t.queryForListening_(e),n)}))),this.removeTags_(c)}return a},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,(function(e,n){var r=Q.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i}));return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.getServerValue=function(t){var e=t.path,n=null;this.syncPointTree_.foreachOnPath(e,(function(t,r){var i=Q.relativePath(t,e);n=n||r.getCompleteServerCache(i)}));var r=this.syncPointTree_.get(e);r?n=n||r.getCompleteServerCache(Q.Empty):(r=new Le,this.syncPointTree_=this.syncPointTree_.set(e,r));var i=null!=n,o=i?new _e(n,!0,!1):null,s=this.pendingWriteTree_.childWrites(t.path);return r.getView(t,s,i?o.getNode():Ht.EMPTY_NODE,i).getCompleteNode()},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold((function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),x(n,(function(t,e){r=r.concat(e)})),r}))},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),s=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,s.hashFn,s.onComplete),u=this.syncPointTree_.subtree(r);if(i)(0,o.hu)(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map((function(t){return t.getQuery()})))),x(n,(function(t,e){r=r.concat(e)})),r})),h=0;h<c.length;++h){var l=c[h];this.listenProvider_.stopListening(t.queryForListening_(l),this.tagForQuery_(l))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Ht.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return(0,o.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Q(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return this.queryToTagMap.get(n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);(0,o.hu)(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Q.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(Q.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Q.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,h=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(Q.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(Q.Empty));var s=[];return e.children.inorderTraversal((function(e,o){var a=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))})),o&&(s=s.concat(o.applyOperation(t,r,n))),s},t.nextQueryTag_=1,t}(),Ye=function(){function t(){this.rootNode_=Ht.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Xe=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.p$)(this.counters_)},t}(),Ze=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new Xe),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),$e=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,i.pi)({},t);return this.last_&&x(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),tn=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new $e(t);var n=1e4+2e4*Math.random();J(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;x(e,(function(e,i){i>0&&(0,o.r3)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),J(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),en=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new nn(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.equals(t)}))},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_((function(e){return e.contains(t)||t.contains(e)}))},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),nn=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();m&&w("event: "+e.toString()),K(n)}}},t.prototype.getPath=function(){return this.path_},t}(),rn=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,i.fl)(this.listeners_[t]),o=0;o<r.length;o++)r[o].callback.apply(r[o].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.hu)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),on=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,i.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(rn),sn=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,i.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(rn),an=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&K((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),un="start",cn="close",hn=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(t),this.stats_=Ze.getCollection(e),this.urlFn=function(t){return e.connectionURL($,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new an(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.Yr)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new ln((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,i.CR)(t,5),o=r[0],s=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,o===un)n.id=s,n.password=a;else{if(o!==cn)throw new Error("Unrecognized command received: "+o);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,i.CR)(t,2),o=r[0],s=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(o,s)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,o.Yr)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.h$)(e),r=R(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.Yr)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),ln=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(s='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){w("frame writing exception"),t.stack&&w(t.stack),w(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||w("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.Yr)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){w("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),fn="";function pn(t){fn=t}var dn=null;"undefined"!=typeof MozWebSocket?dn=MozWebSocket:"undefined"!=typeof WebSocket&&(dn=WebSocket);var vn,yn=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=Ze.getCollection(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!(0,o.Yr)()&&"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(Z,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if((0,o.Yr)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+fn+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}},s=process.env,a=0===this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new dn(this.connURL,[],i)}else i={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new dn(this.connURL,[],i)}catch(t){this.log_("Error instantiating WebSocket.");var u=t.message||t.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==dn&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.cI)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=R(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),gn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[hn,yn]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,o=yn&&yn.isAvailable(),s=o&&!yn.previouslyFailed();if(e.webSocketOnly&&(o||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[yn];else{var a=this.transports_=[];try{for(var u=(0,i.XA)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var h=c.value;h&&h.isAvailable()&&a.push(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),mn=function(){function t(t,e,n,r,i,o,s,a){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=s,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new gn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=J((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=D("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?I("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):I("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),J((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):J((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),bn=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),_n=1e3,wn=function(t){function e(n,r,i,s,a,u,c){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=s,h.onServerInfoUpdate_=a,h.authTokenProvider_=u,h.authOverride_=c,h.id=e.nextPersistentConnectionId_++,h.log_=E("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=_n,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,c&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return h.scheduleConnect_(0),on.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&sn.getInstance().on("online",h.onOnline_,h),h}return(0,i.ZT)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_((0,o.Pz)(i)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this,n=new o.BH,r={p:t.path.toString(),q:t.queryObject()},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var s=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[s];void 0!==t&&i===t&&(delete e.outstandingGets_[s],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+s+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(s),n.promise},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),s=t.path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),(0,o.hu)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(s).set(i,a),this.connected_&&this.sendListen_(a)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};t.tag&&(s.q=r.queryObject(),s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(function(s){var a=s.d,u=s.s;e.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,a))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,o.r3)(t,"w")){var n=(0,o.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.w9)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),(0,o.hu)(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.Pz)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):I("Unrecognized action received from server: "+(0,o.Pz)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_n,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=_n,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=_n),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,a=this,u=this.lastSessionId,c=!1,h=null,l=function(){h?h.close():(c=!0,i())};this.realtime_={close:l,sendRequest:function(t){(0,o.hu)(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(t){c?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,h=new mn(s,a.repoInfo_,a.applicationId_,n,r,i,(function(t){S(t+" ("+a.repoInfo_.toString()+")"),a.interrupt("server_kill")}),u))})).then(null,(function(e){a.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&S(e),l())}))}},e.prototype.interrupt=function(t){w("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){w("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=_n,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return O(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new Q(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){w("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var o=(0,i.XA)(this.listens.values()),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,(0,i.XA)(a.values())),c=u.next();!c.done;c=u.next()){var h=c.value;this.sendListen_(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+fn.replace(/\./g,"-")]=1,(0,o.uI)()?t["framework.cordova"]=1:(0,o.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=sn.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(bn),En=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=E("p:rest:"),i.listens_={},i}return(0,i.ZT)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.hu)(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var s=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var h=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",h,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&s.onDataUpdate_(a,n,!1,r),(0,o.DV)(s.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=t.getQueryParams().toRestQueryStringParameters(),r=t.path.toString(),i=new o.BH;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var s=i&&i.accessToken;s&&(e.auth=s);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.xO)(e);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=(0,o.cI)(u.responseText)}catch(t){S("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&S("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()}))},e}(bn),In=function(){this.children={},this.childCount=0,this.value=null},Tn=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new In),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n=e instanceof Q?e:new Q(e),r=this,i=n.getFront();null!==i;)r=new t(i,r,(0,o.DV)(r.node_.children,i)||new In),i=(n=n.popFront()).getFront();return r},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){(0,o.hu)(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;x(this.node_.children,(function(r,i){e(new t(r,n,i))}))},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild((function(e){e.forEachDescendant(t,!0,n)})),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild((function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)}))},t.prototype.path=function(){return new Q(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=(0,o.r3)(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}(),Sn="repo_interrupt";!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(vn||(vn={}));var Cn=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.app=n,this.authTokenProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new en,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new fe,this.transactionQueueTree_=new Tn,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.start=function(){var t=this;if(this.stats_=Ze.getCollection(this.repoInfo_),this.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)this.server_=new En(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var e=this.app.options.databaseAuthVariableOverride;if(null!=e){if("object"!=typeof e)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Pz)(e)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new wn(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,e),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),this.statsReporter_=Ze.getOrCreateReporter(this.repoInfo_,(function(){return new tn(t.stats_,t.server_)})),this.infoData_=new Ye,this.infoSyncTree_=new Qe({startListening:function(e,n,r,i){var o=[],s=t.infoData_.getNode(e.path);return s.isEmpty()||(o=t.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Qe({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);t.eventQueue_.raiseEventsForChangedPath(e.path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})},t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new Q(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},t.prototype.generateServerValues=function(){return(t=(t={timestamp:this.serverTime()})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new Q(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(r)if(n){var a=(0,o.UI)(e,(function(t){return Kt(t)}));s=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=Kt(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=(0,o.UI)(e,(function(t){return Kt(t)}));s=this.serverSyncTree_.applyServerMerge(i,c)}else{var h=Kt(e);s=this.serverSyncTree_.applyServerOverwrite(i,h)}var l=i;s.length>0&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;x(t,(function(t,n){e.updateInfo_(t,n)}))},t.prototype.updateInfo_=function(t,e){var n=new Q("/.info/"+t),r=Kt(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.getValue=function(t){var e=this,n=this.serverSyncTree_.getServerValue(t);return null!=n?Promise.resolve(new Xt(n,t.getRef(),t.getQueryParams().getIndex())):this.server_.get(t).then((function(n){var r=Kt(n),i=e.serverSyncTree_.applyServerOverwrite(t.path,r);return e.eventQueue_.raiseEventsAtPath(t.path,i),Promise.resolve(new Xt(r,t.getRef(),t.getQueryParams().getIndex()))}),(function(n){return e.log_("get for query "+(0,o.Pz)(t)+" failed: "+n),Promise.reject(new Error(n))}))},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),s=Kt(e,n),a=this.serverSyncTree_.calcCompleteEventCache(t),u=ce(s,a,o),c=this.getNextWriteId_(),h=this.serverSyncTree_.applyUserOverwrite(t,u,c,!0);this.eventQueue_.queueEvents(h),this.server_.put(t.toString(),s.val(!0),(function(e,n){var o="ok"===e;o||S("set at "+t+" failed: "+e);var s=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,s),i.callOnCompleteCallback(r,e,n)}));var l=this.abortTransactions_(t);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),s={};if(x(e,(function(e,n){i=!1,s[e]=ue(t.child(e),Kt(n),r.serverSyncTree_,o)})),i)w("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(t,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(t.toString(),e,(function(e,i){var o="ok"===e;o||S("update at "+t+" failed: "+e);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,e,i)})),x(e,(function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)})),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=new fe;this.onDisconnect_.forEachTree(Q.Empty,(function(r,i){var o=ue(r,i,t.serverSyncTree_,e);n.remember(r,o)}));var r=[];n.forEachTree(Q.Empty,(function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)})),this.onDisconnect_=new fe,this.eventQueue_.raiseEventsForChangedPath(Q.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)}))},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=Kt(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),(function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)}))},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=Kt(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),(function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)}))},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if((0,o.xb)(e))return w("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,(function(i,o){"ok"===i&&x(e,(function(e,n){var i=Kt(n);r.onDisconnect_.remember(t.child(e),i)})),r.callOnCompleteCallback(n,i,o)}))},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Sn)},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(Sn)},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new $e(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce((function(t,e){return Math.max(e.length,t)}),0);x(e,(function(t,e){for(var r=t,i=t.length;i<n+2;i++)r+=" ";console.log(r+e)}))}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),w.apply(void 0,(0,i.fl)([n],t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&K((function(){if("ok"===e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}}))},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new Ln(this))},enumerable:!1,configurable:!0}),t.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},s=new Pn(this,t);s.on("value",i);var a={path:t,update:e,onComplete:n,status:null,order:v(),applyLocally:r,retryCount:0,unwatcher:function(){s.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(t);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var h=new Xt(a.currentInputSnapshot,new Pn(this,a.path),Rt);a.onComplete(null,!1,h)}}else{ht("transaction failed: Data returned ",c,a.path),a.status=vn.RUN;var l=this.transactionQueueTree_.subTree(t),f=l.getValue()||[];f.push(a),l.setValue(f);var p=void 0;"object"==typeof c&&null!==c&&(0,o.r3)(c,".priority")?(p=(0,o.DV)(c,".priority"),(0,o.hu)(ut(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(this.serverSyncTree_.calcCompleteEventCache(t)||Ht.EMPTY_NODE).getPriority().val();var d=this.generateServerValues(),y=Kt(c,p),g=ce(y,u,d);a.currentOutputSnapshotRaw=y,a.currentOutputSnapshotResolved=g,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(t,g,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,m),this.sendReadyTransactions_()}},t.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Ht.EMPTY_NODE},t.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);(0,o.hu)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return t.status===vn.RUN}))&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild((function(t){e.sendReadyTransactions_(t)}))},t.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map((function(t){return t.currentWriteId})),i=this.getLatestState_(t,r),s=i,a=i.hash(),u=0;u<e.length;u++){var c=e[u];(0,o.hu)(c.status===vn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=vn.SENT,c.retryCount++;var h=Q.relativePath(t,c.path);s=s.updateChild(h,c.currentOutputSnapshotRaw)}var l=s.val(!0),f=t;this.server_.put(f.toString(),l,(function(r){n.log_("transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<e.length;s++){if(e[s].status=vn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[s].currentWriteId)),e[s].onComplete){var a=e[s].currentOutputSnapshotResolved,u=new Pn(n,e[s].path),c=new Xt(a,u,Rt);o.push(e[s].onComplete.bind(null,null,!0,c))}e[s].unwatcher()}for(n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i),s=0;s<o.length;s++)K(o[s])}else{if("datastale"===r)for(s=0;s<e.length;s++)e[s].status===vn.SENT_NEEDS_ABORT?e[s].status=vn.NEEDS_ABORT:e[s].status=vn.RUN;else for(S("transaction at "+f.toString()+" failed: "+r),s=0;s<e.length;s++)e[s].status=vn.NEEDS_ABORT,e[s].abortReason=r;n.rerunTransactions_(t)}}),a)},t.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},t.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],s=t.filter((function(t){return t.status===vn.RUN})).map((function(t){return t.currentWriteId})),a=0;a<t.length;a++){var u=t[a],c=Q.relativePath(e,u.path),h=!1,l=void 0;if((0,o.hu)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===vn.NEEDS_ABORT)h=!0,l=u.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else if(u.status===vn.RUN)if(u.retryCount>=25)h=!0,l="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0));else{var f=this.getLatestState_(u.path,s);u.currentInputSnapshot=f;var p=t[a].update(f.val());if(void 0!==p){ht("transaction failed: Data returned ",p,u.path);var d=Kt(p);"object"==typeof p&&null!=p&&(0,o.r3)(p,".priority")||(d=d.updatePriority(f.getPriority()));var v=u.currentWriteId,y=this.generateServerValues(),g=ce(d,f,y);u.currentOutputSnapshotRaw=d,u.currentOutputSnapshotResolved=g,u.currentWriteId=this.getNextWriteId_(),s.splice(s.indexOf(v),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(u.path,g,u.currentWriteId,u.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(v,!0))}else h=!0,l="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(u.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],h&&(t[a].status=vn.COMPLETED,n=t[a].unwatcher,setTimeout(n,Math.floor(0)),t[a].onComplete))if("nodata"===l){var m=new Pn(this,t[a].path),b=t[a].currentInputSnapshot,_=new Xt(b,m,Rt);r.push(t[a].onComplete.bind(null,null,!1,_))}else r.push(t[a].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<r.length;a++)K(r[a]);this.sendReadyTransactions_()}},t.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},t.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort((function(t,e){return t.order-e.order})),e},t.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild((function(t){n.aggregateTransactionQueuesForNode_(t,e)}))},t.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==vn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild((function(t){e.pruneCompletedTransactionsBelowNode_(t)}))},t.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor((function(t){e.abortTransactionsOnNode_(t)})),this.abortTransactionsOnNode_(r),r.forEachDescendant((function(t){e.abortTransactionsOnNode_(t)})),n},t.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,s=0;s<e.length;s++)e[s].status===vn.SENT_NEEDS_ABORT||(e[s].status===vn.SENT?((0,o.hu)(i===s-1,"All SENT items should be at beginning of queue."),i=s,e[s].status=vn.SENT_NEEDS_ABORT,e[s].abortReason="set"):((0,o.hu)(e[s].status===vn.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete&&n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r),s=0;s<n.length;s++)K(n[s])}},t}(),An=function(){function t(e){this.indexedFilter_=new Ae(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ct(e,n))||(n=Ht.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Ht.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Ht.EMPTY_NODE);var i=this;return e.forEachChild(Rt,(function(t,e){i.matches(new Ct(t,e))||(r=r.updateImmediateChild(t,Ht.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Nn=function(){function t(t){this.rangedFilter_=new An(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ct(e,n))||(n=Ht.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Ht.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Ht.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Ht.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();)s=i.getNext(),!l&&c(a,s)<=0&&(l=!0),l&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,Ht.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var s;if(this.reverse_){var a=this.index_.getCompare();s=function(t,e){return a(e,t)}}else s=this.index_.getCompare();var u=t;(0,o.hu)(u.numChildren()===this.limit_,"");var c=new Ct(e,n),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),p=r.getChildAfterChild(this.index_,h,this.reverse_);null!=p&&(p.name===e||u.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:s(p,c);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(Se(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Te(e,f));var v=u.updateImmediateChild(e,Ht.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Ie(p.name,p.node)),v.updateImmediateChild(p.name,p.node)):v}return n.isEmpty()?t:l&&s(h,c)>=0?(null!=i&&(i.trackChildChange(Te(h.name,h.node)),i.trackChildChange(Ie(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(h.name,Ht.EMPTY_NODE)):t},t}(),kn=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Rt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.startAfter=function(t,e){var n;if(this.index_===kt)"string"==typeof t&&(t=Tt(t)),n=this.startAt(t,e);else{var r;r=null==e?N:Tt(e),n=this.startAt(t,r)}return n.startAfterSet_=!0,n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.endBefore=function(t,e){var n,r;return this.index_===kt?("string"==typeof t&&(t=St(t)),r=this.endAt(t,e)):(n=null==e?A:St(e),r=this.endAt(t,n)),r.endBeforeSet_=!0,r},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Rt&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Rt},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new Ae(this.getIndex()):this.hasLimit()?new Nn(this):new An(this)},t.prototype.toRestQueryStringParameters=function(){var e,n=t.REST_QUERY_CONSTANTS_,r={};return this.isDefault()||(this.index_===Rt?e=n.PRIORITY_INDEX:this.index_===Qt?e=n.VALUE_INDEX:this.index_===kt?e=n.KEY_INDEX:((0,o.hu)(this.index_ instanceof Yt,"Unrecognized index type!"),e=this.index_.toString()),r[n.ORDER_BY]=(0,o.Pz)(e),this.startSet_&&(r[n.START_AT]=(0,o.Pz)(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+(0,o.Pz)(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=(0,o.Pz)(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+(0,o.Pz)(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_)),r},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t}(),Pn=function(t){function e(e,n){if(!(e instanceof Cn))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,new kn,!1)||this}return(0,i.ZT)(e,t),e.prototype.getKey=function(){return(0,o.Dv)("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return(0,o.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof Q||(null===this.path.getFront()?yt("Reference.child",1,t,!1):vt("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){(0,o.Dv)("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){(0,o.Dv)("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){(0,o.Dv)("Reference.set",1,2,arguments.length),gt("Reference.set",this.path),ct("Reference.set",1,t,this.path,!1),(0,o.Wj)("Reference.set",2,e,!0);var n=new o.BH;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if((0,o.Dv)("Reference.update",1,2,arguments.length),gt("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}lt("Reference.update",1,t,this.path,!1),(0,o.Wj)("Reference.update",2,e,!0);var i=new o.BH;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if((0,o.Dv)("Reference.setWithPriority",2,3,arguments.length),gt("Reference.setWithPriority",this.path),ct("Reference.setWithPriority",1,t,this.path,!1),ft("Reference.setWithPriority",2,e,!1),(0,o.Wj)("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new o.BH;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return(0,o.Dv)("Reference.remove",0,1,arguments.length),gt("Reference.remove",this.path),(0,o.Wj)("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if((0,o.Dv)("Reference.transaction",1,3,arguments.length),gt("Reference.transaction",this.path),(0,o.Wj)("Reference.transaction",1,t,!1),(0,o.Wj)("Reference.transaction",2,e,!0),bt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new o.BH;"function"==typeof e&&r.promise.catch((function(){}));var i=function(t,n,i){t?r.reject(t):r.resolve(new wt(n,i)),"function"==typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){(0,o.Dv)("Reference.setPriority",1,2,arguments.length),gt("Reference.setPriority",this.path),ft("Reference.setPriority",1,t,!1),(0,o.Wj)("Reference.setPriority",2,e,!0);var n=new o.BH;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){(0,o.Dv)("Reference.push",0,2,arguments.length),gt("Reference.push",this.path),ct("Reference.push",1,t,this.path,!0),(0,o.Wj)("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=It(r),s=this.child(i),a=this.child(i);return n=null!=t?s.set(t,e).then((function(){return a})):Promise.resolve(a),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch((function(){})),s},e.prototype.onDisconnect=function(){return gt("Reference.onDisconnect",this.path),new _t(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(ne);ne.__referenceConstructor=Pn,Le.__referenceConstructor=Pn;var Dn,On=function(){function t(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then((function(t){return n.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(t)},t}(),Rn=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),xn=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return Dn||(Dn=new t),Dn},t.prototype.interrupt=function(){var t,e,n,r;try{for(var o=(0,i.XA)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,(0,i.XA)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next()){var h=c.value;this.repos_[a][h].interrupt()}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.resume=function(){var t,e,n,r;try{for(var o=(0,i.XA)(Object.keys(this.repos_)),s=o.next();!s.done;s=o.next()){var a=s.value;try{for(var u=(n=void 0,(0,i.XA)(Object.keys(this.repos_[a]))),c=u.next();!c.done;c=u.next()){var h=c.value;this.repos_[a][h].resume()}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}},t.prototype.applyEmulatorSettings=function(t,e,n){t.repoInfo_=new tt(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new Rn)},t.prototype.databaseFromApp=function(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||T("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),w("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,s=et(i,r),a=s.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,i="http://"+u+"?ns="+a.namespace,a=(s=et(i,r)).repoInfo):o=!s.repoInfo.secure;var c=r&&o?new Rn:new On(t,e);return mt("Invalid Firebase Database URL",1,s),s.path.isEmpty()||T("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,t,c).database},t.prototype.deleteRepo=function(t){var e=(0,o.DV)(this.repos_,t.app.name);e&&(0,o.DV)(e,t.key)===t||T("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.key]},t.prototype.createRepo=function(t,e,n){var r=(0,o.DV)(this.repos_,e.name);r||(r={},this.repos_[e.name]=r);var i=(0,o.DV)(r,t.toURLString());return i&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Cn(t,this.useRestClient_,e,n),r[t.toURLString()]=i,i},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),Ln=function(){function t(t){var e=this;this.repoInternal_=t,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return(0,i.mG)(e,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){return this.checkDeleted_("delete"),xn.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]}))}))}},t instanceof Cn||T("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(t.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new Pn(this.repo_,Q.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),t.prototype.useEmulator=function(t,e){this.checkDeleted_("useEmulator"),this.instanceStarted_?T("Cannot call useEmulator() after instance has already been initialized."):xn.getInstance().applyEmulatorSettings(this.repoInternal_,t,e)},t.prototype.ref=function(t){return this.checkDeleted_("ref"),(0,o.Dv)("database.ref",0,1,arguments.length),t instanceof Pn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),(0,o.Dv)(e,1,1,arguments.length);var n=et(t,this.repo_.repoInfo_.nodeAdmin);mt(e,1,n);var r=n.repoInfo;return this.repo_.repoInfo_.isCustomHost()||r.host===this.repo_.repoInfo_.host||T(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repoInternal_&&T("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){(0,o.Dv)("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){(0,o.Dv)("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(t){return{".sv":{increment:t}}}},t}(),Mn=Object.freeze({__proto__:null,forceLongPolling:function(){yn.forceDisallow(),hn.forceAllow()},forceWebSockets:function(){hn.forceDisallow()},isWebSocketsAvailable:function(){return yn.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,i=t.customAuthImpl,o=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;pn(r);var c=new a.zt("auth-internal",new a.H0("database-standalone"));return c.setComponent(new a.wA("auth-internal",(function(){return i}),"PRIVATE")),{instance:xn.getInstance().databaseFromApp(e,c,n,u),namespace:o}}}),Fn=wn;wn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},wn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var jn=mn,Un=tt,Vn=Object.freeze({__proto__:null,DataConnection:Fn,RealTimeConnection:jn,hijackHash:function(t){var e=wn.prototype.put;return wn.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){wn.prototype.put=e}},ConnectionTarget:Un,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){xn.getInstance().forceRestClient(t)}}),qn=Ln.ServerValue;!function(e){pn(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new a.wA("database",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return xn.getInstance().databaseFromApp(n,r,e)}),"PUBLIC").setServiceProps({Reference:Pn,Query:ne,Database:Ln,DataSnapshot:Xt,enableLogging:_,INTERNAL:Mn,ServerValue:qn,TEST_ACCESS:Vn}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.9.3"),(0,o.Yr)()&&(t.exports=n)}(r.Z)},594:(t,e,n)=>{"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}var i;n.d(e,{in:()=>o,Yd:()=>l,Ub:()=>f,Am:()=>p});var o,s=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),h=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},l=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=h,this._userLogHandler=null,s.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){s.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var a=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:a,args:i,type:e.name})}},r=0,i=s;r<i.length;r++)n(i[r])}},589:(t,e,n)=>{"use strict";n.d(e,{BH:()=>f,LL:()=>A,ZR:()=>C,gQ:()=>V,zI:()=>S,hu:()=>i,g5:()=>o,US:()=>a,h$:()=>u,$s:()=>Y,r3:()=>L,ne:()=>q,p$:()=>h,ZB:()=>l,gK:()=>H,z$:()=>p,GJ:()=>x,jU:()=>y,ru:()=>g,d:()=>b,xb:()=>F,w1:()=>_,hl:()=>I,uI:()=>d,UG:()=>v,Yr:()=>E,b$:()=>m,Mn:()=>w,w9:()=>R,cI:()=>P,UI:()=>j,xO:()=>U,DV:()=>M,ug:()=>Q,dS:()=>J,Pz:()=>D,Dv:()=>W,Wj:()=>z,lb:()=>K,eu:()=>T});var r=n(655),i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){var e=s(t);return a.encodeByteArray(e,!0)},c=function(t){try{return a.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(t){return l(void 0,t)}function l(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=l(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function d(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())}function v(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function y(){return"object"==typeof self&&self.self===self}function g(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function m(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function b(){return p().indexOf("Electron/")>=0}function _(){var t=p();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return p().indexOf("MSAppHost/")>=0}function E(){return!1}function I(){return"indexedDB"in self&&null!=indexedDB}function T(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function S(){return!(!navigator||!navigator.cookieEnabled)}var C=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,A.prototype.create),o}return(0,r.ZT)(e,t),e}(Error),A=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?N(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new C(i,a,r);return u},t}();function N(t,e){return t.replace(k,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var k=/\{\$([^}]+)}/g;function P(t){return JSON.parse(t)}function D(t){return JSON.stringify(t)}var O=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=P(c(o[0])||""),n=P(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},R=function(t){var e=O(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},x=function(t){var e=O(t).claims;return"object"==typeof e&&!0===e.admin};function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function F(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function j(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function U(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}var V=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782),i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295,l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function q(t,e){var n=new B(t,e);return n.subscribe.bind(n)}var B=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=G),void 0===r.error&&(r.error=G),void 0===r.complete&&(r.complete=G);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function G(){}var W=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function H(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+(r+" argument ")}function z(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(H(t,e,r)+"must be a valid function.")}function K(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(H(t,e,r)+"must be a valid context object.")}var J=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var s=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(s<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},Q=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function Y(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}},690:(t,e,n)=>{"use strict";n.r(e),n(481)},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,s){n(i=t[e].apply(t,r)).then(o,s)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function s(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function a(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),s(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),s(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),s(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),a(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),a(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},655:(t,e,n)=>{"use strict";n.d(e,{ZT:()=>i,pi:()=>o,mG:()=>s,Jh:()=>a,XA:()=>u,CR:()=>c,fl:()=>h,pr:()=>l});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function h(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(c(arguments[e]));return t}function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";function t(t){var e=new Date(t.getTime()),n=e.getTimezoneOffset();return e.setSeconds(0,0),6e4*n+e.getTime()%6e4}function e(t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function i(t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=e(t),i=e(n),o=r.getTime()-i.getTime();return o<0?-1:o>0?1:o}function o(t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var r=e(t),i=e(n);return r.getTime()-i.getTime()}function s(t,e){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var n=o(t,e)/1e3;return n>0?Math.floor(n):Math.ceil(n)}function a(t){return function(t,e){if(null==t)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in e=e||{})e.hasOwnProperty(n)&&(t[n]=e[n]);return t}({},t)}n.d(r,{db:()=>Eb,A:()=>wb});var u={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function c(t){return function(e){var n=e||{},r=n.width?String(n.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}var h,l={date:c({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:c({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:c({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},f={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function p(t){return function(e,n){var r,i=n||{};if("formatting"===(i.context?String(i.context):"standalone")&&t.formattingValues){var o=t.defaultFormattingWidth||t.defaultWidth,s=i.width?String(i.width):o;r=t.formattingValues[s]||t.formattingValues[o]}else{var a=t.defaultWidth,u=i.width?String(i.width):t.defaultWidth;r=t.values[u]||t.values[a]}return r[t.argumentCallback?t.argumentCallback(e):e]}}function d(t){return function(e,n){var r=String(e),i=n||{},o=i.width,s=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],a=r.match(s);if(!a)return null;var u,c=a[0],h=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth];return u="[object Array]"===Object.prototype.toString.call(h)?h.findIndex((function(t){return t.test(r)})):function(t,e){for(var n in t)if(t.hasOwnProperty(n)&&t[n].test(r))return n}(h),u=t.valueCallback?t.valueCallback(u):u,{value:u=i.valueCallback?i.valueCallback(u):u,rest:r.slice(c.length)}}}const v={formatDistance:function(t,e,n){var r;return n=n||{},r="string"==typeof u[t]?u[t]:1===e?u[t].one:u[t].other.replace("{{count}}",e),n.addSuffix?n.comparison>0?"in "+r:r+" ago":r},formatLong:l,formatRelative:function(t,e,n,r){return f[t]},localize:{ordinalNumber:function(t,e){var n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:p({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:p({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:p({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:p({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:p({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(h={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(t,e){var n=String(t),r=e||{},i=n.match(h.matchPattern);if(!i)return null;var o=i[0],s=n.match(h.parsePattern);if(!s)return null;var a=h.valueCallback?h.valueCallback(s[0]):s[0];return{value:a=r.valueCallback?r.valueCallback(a):a,rest:n.slice(o.length)}}),era:d({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:d({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:d({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:d({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:d({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};var y=1440,g=43200,m=525600,b=n(99);function _(){!function(){let t,e=b.Z.auth().currentUser;e&&(t=e.uid,Eb.collection("users").doc(t).get().then((t=>{if(t.exists){let e=t.data().projects;w=e,console.log(w),N()}else console.log("no such document")})).catch((t=>{console.log("Error getting document:",t)})))}(),function(){let t,e=b.Z.auth().currentUser;e&&(t=e.uid,Eb.collection("users").doc(t).collection("tasks").get().then((t=>{t.forEach((t=>{console.log(E),E.push(t.data())})),function(){for(let t=0;t<E.length;t++)E[t].dueDate=E[t].dueDate.toDate()}(),function(){for(let t=0;t<E.length;t++)D(E[t])}()})).catch((t=>{console.log("Error getting documents: ",t)})))}()}b.Z.registerVersion("firebase","8.2.7","app");let w=[],E=[];function I(t){let e,n=b.Z.auth().currentUser;null!=n&&(e=n.uid,Eb.collection("users").doc(e).collection("tasks").doc(t.id).update({priority:t.priority}).catch((t=>{console.error("Error adding document: ",t)})))}let T=["#3ba1c5","#66b6d2","#51abcb","#7cc0d8"],S=["Very Low","Low","Medium","High","Very High"];function C(t,e,n,r,i,o){this.id=t,this.title=e,this.project=n,this.description=r,this.dueDate=i,this.priority=o}function A(t){let e=document.createElement("div");e.setAttribute("class","project"),e.setAttribute("id","project"+t),e.style.backgroundColor=T[t]?T[t]:T[0];let n=document.createElement("h2");n.setAttribute("class","projTitle"),n.textContent=w[t],e.appendChild(n);let r=document.createElement("div");r.setAttribute("class","projEdit"),e.appendChild(r);const i=document.createElement("button");i.textContent="Delete Project",i.classList.add("remove");let o=w[t],s=t;i.setAttribute("id","rProj",+w.indexOf(o)),r.appendChild(i),i.addEventListener("click",(()=>{!function(t,e){let n=document.getElementById("container"),r=document.getElementById("project"+t);n.removeChild(r),w.splice(w.indexOf(e),1);let i,o=b.Z.auth().currentUser;null!=o&&(i=o.uid,Eb.collection("users").doc(i).update({projects:b.Z.firestore.FieldValue.arrayRemove(e)}).catch((t=>{console.error("Error adding document: ",t)})))}(s,o)}));const a=document.createElement("button");a.textContent="Hide/Show Tasks",a.classList.add("remove"),a.setAttribute("id","hideShow",+w.indexOf(o)),r.appendChild(a),a.addEventListener("click",(()=>{!function(t,e){for(let t=0;t<E.length;t++)if(E[t].project===e){let e=document.getElementById("task"+t);"none"===e.style.display?e.style.display="block":e.style.display="none"}}(0,o)})),document.getElementById("container").appendChild(e)}function N(){let t=document.getElementById("container"),e=document.createElement("div");t.appendChild(e);for(let t=0;t<w.length;t++)A(t)}function k(t){let e=function(t){return w.indexOf(t.project)}(t);return document.getElementById("project"+e)}function P(n){let r,o,u=new Date,c=function(n,r,o){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var u=o||{},c=u.locale||v;if(!c.formatDistance)throw new RangeError("locale must contain localize.formatDistance property");var h=i(n,r);if(isNaN(h))throw new RangeError("Invalid time value");var l,f,p=a(u);p.addSuffix=Boolean(u.addSuffix),p.comparison=h,h>0?(l=e(r),f=e(n)):(l=e(n),f=e(r));var d,b=null==u.roundingMethod?"round":String(u.roundingMethod);if("floor"===b)d=Math.floor;else if("ceil"===b)d=Math.ceil;else{if("round"!==b)throw new RangeError("roundingMethod must be 'floor', 'ceil' or 'round'");d=Math.round}var _,w=s(f,l),E=(t(f)-t(l))/1e3,I=d((w-E)/60);if("second"===(_=null==u.unit?I<1?"second":I<60?"minute":I<y?"hour":I<g?"day":I<m?"month":"year":String(u.unit)))return c.formatDistance("xSeconds",w,p);if("minute"===_)return c.formatDistance("xMinutes",I,p);if("hour"===_){var T=d(I/60);return c.formatDistance("xHours",T,p)}if("day"===_){var S=d(I/y);return c.formatDistance("xDays",S,p)}if("month"===_){var C=d(I/g);return c.formatDistance("xMonths",C,p)}if("year"===_){var A=d(I/m);return c.formatDistance("xYears",A,p)}throw new RangeError("unit must be 'second', 'minute', 'hour', 'day', 'month' or 'year'")}(n,u);return n<u?(r="("+c+" ago.)",o="pastDue"):n>u&&(r=" (In "+c+")",o="helpfulDateDiv"),[r,o]}function D(t){const e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("h3"),i=document.createElement("button"),o=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),u=document.createElement("div"),c=document.createElement("button"),h=document.createElement("button"),l=document.createElement("button");let f=E.indexOf(t);e.classList.add("task"),e.setAttribute("id","task"+E.indexOf(t)),n.appendChild(r),r.textContent=t.title,r.classList.add("taskTitle"),n.setAttribute("id","title"+E.indexOf(t)),n.classList.add("title"),e.appendChild(n),i.textContent="Show Description",i.setAttribute("class","toggleDescription"),i.setAttribute("id","descriptionButton"+f),i.addEventListener("click",(()=>{var t;"none"===(t=o).style.display?t.style.display="block":t.style.display="none",function(t){"Show Description"===t.textContent?t.textContent="Hide Description":t.textContent="Show Description"}(i)})),e.appendChild(i),o.textContent=t.description,o.setAttribute("class","description"),o.setAttribute("id","description"+E.indexOf(t)),o.style.display="none",e.appendChild(o),s.setAttribute("class","dueDateDiv");let p=document.createElement("div");p.setAttribute("class","due"),p.textContent="Due ",s.appendChild(p),a.setAttribute("id","dueDate"+E.indexOf(t));let d=new Date(t.dueDate);a.textContent=d.toDateString(),u.setAttribute("id","helpfulDateDiv"+E.indexOf(t));let v=P(t.dueDate);u.textContent=v[0],u.setAttribute("class",v[1]),u.classList.add("helpfulDateDiv"),s.appendChild(a),s.appendChild(u),e.appendChild(s);let y=document.createElement("div");y.setAttribute("class","priorityDiv"),e.appendChild(y);let g=document.createElement("Label");g.setAttribute("for",c),g.setAttribute("class","priorityLabel"),g.textContent="Priority",y.appendChild(g),c.textContent=t.priority,c.classList.add("priority");let m=t.priority.toString();m=m.replace(/\s/g,""),c.classList.add(m),c.setAttribute("id","priority"+E.indexOf(t)),y.appendChild(c),c.addEventListener("click",(()=>{!function(t,e){let n=S.indexOf(t.priority);if(4===n)e.textContent=S[0],t.priority=S[0],e.setAttribute("class",S[0]),e.classList.add("priority"),I(t);else{let r=S[n+1];e.textContent=r,e.setAttribute("class",r),e.classList.add("priority"),t.priority=r,I(t)}}(t,c)}));let _=document.createElement("div");_.setAttribute("class","modifyDiv"),l.textContent="Edit Task",l.setAttribute("class","modifyTask"),l.setAttribute("id","eTask",+E.indexOf(t)),_.appendChild(l),l.addEventListener("click",(()=>{!function(t){let e=document.getElementById("myModal"),n=document.getElementById("closeModal");(function(t){document.getElementById("editTitle").value=t.title,document.getElementById("editDescription").value=t.description;let e=document.getElementById("editDueDate"),n=function(t){let e=new Date(t),n=(e.getMonth()+1).toString(),r=e.getDate().toString();return n<10&&(n="0"+n),r<10&&(r="0"+r),[e.getFullYear(),n,r].join("-")}(t.dueDate);e.value=n,document.getElementById("editPriority").value=t.priority})(t),e.style.display="block",n.onclick=function(){e.style.display="none"},window.onclick=function(t){t.target==e&&(e.style.display="none")}}(t),document.getElementById("submitEdit").addEventListener("click",(()=>{(function(t,e){let n=E.indexOf(t);event.preventDefault(),function(t){let e=document.getElementById("editForm"),n=E[t];if(""!==e.editTitle.value&&(n.title=e.editTitle.value),""!==e.editDescription.value&&(n.description=e.editDescription.value),""!==e.editDueDate.value)n.dueDate=e.editDueDate.value;else{let e=new Date(E[t].dueDate);n.dueDate=e.toDateString()}n.priority=e.editPriority.value;let r,i=b.Z.auth().currentUser;null!=i&&(r=i.uid,Eb.collection("users").doc(r).collection("tasks").doc(n.id).update({title:n.title,description:n.description,dueDate:n.dueDate,priority:n.priority}).catch((t=>{console.error("Error adding document: ",t)}))),event.preventDefault(),e.reset()}(n),function(t,e,n){document.getElementById("title"+e).textContent=E[n].title,document.getElementById("description"+e).textContent=E[n].description;let r=document.getElementById("dueDate"+e),i=new Date(E[n].dueDate);r.textContent=i.toDateString();let o=document.getElementById("helpfulDateDiv"+e),s=P(i);o.textContent=s[0],o.setAttribute("class",s[1]);let a=document.getElementById("priority"+e);a.textContent=E[n].priority;let u=t.priority.toString();u=u.replace(/\s/g,""),a.setAttribute("class",u),a.classList.add("priority")}(t,e,n)})(t,f),document.getElementById("myModal").style.display="none"}))})),h.textContent="Delete Task",h.setAttribute("class","modifyTask"),h.setAttribute("id","rTask",+E.indexOf(t));let w=k(t);_.appendChild(h),h.addEventListener("click",(()=>{!function(t,e,n){let r=n,i=document.getElementById("task"+e);r.removeChild(i),E.splice(E.indexOf(t),1);let o,s=b.Z.auth().currentUser;null!=s&&(o=s.uid,Eb.collection("users").doc(o).collection("tasks").doc(t.id).delete().catch((t=>{console.error("Error adding document: ",t)})))}(t,f,w)})),e.appendChild(_),k(t).appendChild(e)}function O(t){E.push(t);let e,n=b.Z.auth().currentUser;null!=n&&(e=n.uid,Eb.collection("users").doc(e).collection("tasks").doc(t.id).set({id:t.id,title:t.title,project:t.project,description:t.description,dueDate:t.dueDate,priority:t.priority}).catch((t=>{console.error("Error adding document: ",t)}))),D(t)}function R(){let t=newProjectForm.inputNewProject.value;if(w.includes(t))alert("Oops! Looks like that already exists"),event.preventDefault();else{event.preventDefault(),w.push(t);let e,n=b.Z.auth().currentUser;null!=n&&(e=n.uid,Eb.collection("users").doc(e).update({projects:b.Z.firestore.FieldValue.arrayUnion(t)}).catch((t=>{console.error("Error adding document: ",t)})));let r=w.indexOf(t);A(r),function(t){let e=document.getElementById("inputProject"),n=document.createElement("option");n.value=w[t],n.text=w[t],e.appendChild(n)}(r)}}n(481),n(446);var x=n(594),L=n(589),M=function(t,e){return(M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function F(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var j,U="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},V=V||{},q=U||self;function B(){}function G(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function W(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var H="closure_uid_"+(1e9*Math.random()>>>0),z=0;function K(t,e,n){return t.call.apply(t.bind,arguments)}function J(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Q(t,e,n){return(Q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?K:J).apply(null,arguments)}function Y(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function X(){return Date.now()}function Z(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function $(){this.j=this.j,this.i=this.i}$.prototype.j=!1,$.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,H)&&t[H]||(t[H]=++z)}(this)},$.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var tt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},et=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function nt(t){return Array.prototype.concat.apply([],arguments)}function rt(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function it(t){return/^[\s\xa0]*$/.test(t)}var ot,st=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function at(t,e){return-1!=t.indexOf(e)}function ut(t,e){return t<e?-1:t>e?1:0}t:{var ct=q.navigator;if(ct){var ht=ct.userAgent;if(ht){ot=ht;break t}}ot=""}function lt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function ft(t){var e={};for(var n in t)e[n]=t[n];return e}var pt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function dt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<pt.length;o++)n=pt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function vt(t){return vt[" "](t),t}vt[" "]=B;var yt,gt,mt=at(ot,"Opera"),bt=at(ot,"Trident")||at(ot,"MSIE"),_t=at(ot,"Edge"),wt=_t||bt,Et=at(ot,"Gecko")&&!(at(ot.toLowerCase(),"webkit")&&!at(ot,"Edge"))&&!(at(ot,"Trident")||at(ot,"MSIE"))&&!at(ot,"Edge"),It=at(ot.toLowerCase(),"webkit")&&!at(ot,"Edge");function Tt(){var t=q.document;return t?t.documentMode:void 0}t:{var St="",Ct=(gt=ot,Et?/rv:([^\);]+)(\)|;)/.exec(gt):_t?/Edge\/([\d\.]+)/.exec(gt):bt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(gt):It?/WebKit\/(\S+)/.exec(gt):mt?/(?:Version)[ \/]?(\S+)/.exec(gt):void 0);if(Ct&&(St=Ct?Ct[1]:""),bt){var At=Tt();if(null!=At&&At>parseFloat(St)){yt=String(At);break t}}yt=St}var Nt,kt={};function Pt(t){return function(t,e){var n=kt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=st(String(yt)).split("."),r=st(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=ut(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ut(0==s[2].length,0==a[2].length)||ut(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}q.document&&bt?Nt=Tt()||parseInt(yt,10)||void 0:Nt=void 0;var Dt=Nt,Ot=!bt||9<=Number(Dt),Rt=bt&&!Pt("9"),xt=function(){if(!q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{q.addEventListener("test",B,e),q.removeEventListener("test",B,e)}catch(t){}return t}();function Lt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Mt(t,e){if(Lt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Et){t:{try{vt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ft[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}Lt.prototype.b=function(){this.defaultPrevented=!0},Z(Mt,Lt);var Ft={2:"touch",3:"pen",4:"mouse"};Mt.prototype.b=function(){Mt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var jt="closure_listenable_"+(1e6*Math.random()|0),Ut=0;function Vt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Ut,this.Y=this.Z=!1}function qt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Bt(t){this.src=t,this.a={},this.b=0}function Gt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=tt(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(qt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Wt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Bt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Wt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Vt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ht="closure_lm_"+(1e6*Math.random()|0),zt={};function Kt(t,e,n,r,i){if(r&&r.once)return Qt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Kt(t,e[o],n,r,i);return null}return n=re(n),t&&t[jt]?t.va(e,n,W(r)?!!r.capture:!!r,i):Jt(t,e,n,!1,r,i)}function Jt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=W(i)?!!i.capture:!!i;if(s&&!Ot)return null;var a=ee(t);if(a||(t[Ht]=a=new Bt(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=te,e=Ot?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)xt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Zt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Qt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Qt(t,e[o],n,r,i);return null}return n=re(n),t&&t[jt]?t.wa(e,n,W(r)?!!r.capture:!!r,i):Jt(t,e,n,!0,r,i)}function Yt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Yt(t,e[o],n,r,i);else r=W(r)?!!r.capture:!!r,n=re(n),t&&t[jt]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=Wt(o=t.a[e],n,r,i))&&(qt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=ee(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Wt(e,n,r,i)),(n=-1<t?e[t]:null)&&Xt(n))}function Xt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[jt])Gt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Zt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ee(e))?(Gt(n,t),0==n.b&&(n.src=null,e[Ht]=null)):qt(t)}}}function Zt(t){return t in zt?zt[t]:zt[t]="on"+t}function $t(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Xt(t),n.call(r,e)}function te(t,e){if(t.Y)return!0;if(!Ot){if(!e)t:{e=["window","event"];for(var n=q,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return $t(t,e=new Mt(e,this))}return $t(t,new Mt(e,this))}function ee(t){return(t=t[Ht])instanceof Bt?t:null}var ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function re(t){return"function"==typeof t?t:(t[ne]||(t[ne]=function(e){return t.handleEvent(e)}),t[ne])}function ie(){$.call(this),this.c=new Bt(this),this.J=this,this.C=null}function oe(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new Lt(e,t);else if(e instanceof Lt)e.target=e.target||t;else{var i=e;dt(e=new Lt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=e.a=n[o];i=se(s,r,!0,e)&&i}if(i=se(s=e.a=t,r,!0,e)&&i,i=se(s,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=se(s=e.a=n[o],r,!1,e)&&i}function se(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var a=s.listener,u=s.ca||s.src;s.Z&&Gt(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&!r.defaultPrevented}Z(ie,$),ie.prototype[jt]=!0,(j=ie.prototype).addEventListener=function(t,e,n,r){Kt(this,t,e,n,r)},j.removeEventListener=function(t,e,n,r){Yt(this,t,e,n,r)},j.G=function(){if(ie.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)qt(n[r]);delete e.a[t],e.b--}}this.C=null},j.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},j.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var ae=q.JSON.stringify;function ue(){this.b=this.a=null}var ce,he=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new fe}),(function(t){t.reset()}));function le(){var t=ye,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function fe(){this.next=this.b=this.a=null}function pe(t){q.setTimeout((function(){throw t}),0)}function de(t,e){ce||function(){var t=q.Promise.resolve(void 0);ce=function(){t.then(ge)}}(),ve||(ce(),ve=!0),ye.add(t,e)}ue.prototype.add=function(t,e){var n=he.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},fe.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},fe.prototype.reset=function(){this.next=this.b=this.a=null};var ve=!1,ye=new ue;function ge(){for(var t;t=le();){try{t.a.call(t.b)}catch(t){pe(t)}var e=he;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}ve=!1}function me(t,e){ie.call(this),this.b=t||1,this.a=e||q,this.f=Q(this.Za,this),this.g=X()}function be(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function _e(t,e,n){if("function"==typeof t)n&&(t=Q(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Q(t.handleEvent,t)}return 2147483647<Number(e)?-1:q.setTimeout(t,e||0)}function we(t){t.a=_e((function(){t.a=null,t.c&&(t.c=!1,we(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}Z(me,ie),(j=me.prototype).aa=!1,j.M=null,j.Za=function(){if(this.aa){var t=X()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),oe(this,"tick"),this.aa&&(be(this),this.start()))}},j.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=X())},j.G=function(){me.X.G.call(this),be(this),delete this.a};var Ee=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}M(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:we(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(q.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}($);function Ie(t){$.call(this),this.b=t,this.a={}}Z(Ie,$);var Te=[];function Se(t,e,n,r){Array.isArray(n)||(n&&(Te[0]=n.toString()),n=Te);for(var i=0;i<n.length;i++){var o=Kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ce(t){lt(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Xt(t)}),t),t.a={}}function Ae(){this.a=!0}function Ne(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ae(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Ie.prototype.G=function(){Ie.X.G.call(this),Ce(this)},Ie.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ae.prototype.info=function(){};var ke={},Pe=null;function De(){return Pe=Pe||new ie}function Oe(t){Lt.call(this,ke.Fa,t)}function Re(t){var e=De();oe(e,new Oe(e,t))}function xe(t,e){Lt.call(this,ke.STAT_EVENT,t),this.stat=e}function Le(t){var e=De();oe(e,new xe(e,t))}function Me(t){Lt.call(this,ke.Ga,t)}function Fe(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return q.setTimeout((function(){t()}),e)}ke.Fa="serverreachability",Z(Oe,Lt),ke.STAT_EVENT="statevent",Z(xe,Lt),ke.Ga="timingevent",Z(Me,Lt);var je={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Ue={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ve(){}function qe(t){var e;return(e=t.a)||(e=t.a={}),e}function Be(){}Ve.prototype.a=null;var Ge,We={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function He(){Lt.call(this,"d")}function ze(){Lt.call(this,"c")}function Ke(){}function Je(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Ie(this),this.P=Qe,t=wt?125:void 0,this.R=new me(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}Z(He,Lt),Z(ze,Lt),Z(Ke,Ve),Ge=new Ke;var Qe=45e3,Ye={},Xe={};function Ze(t,e,n){t.H=1,t.i=wn(vn(e)),t.j=n,t.I=!0,$e(t,null)}function $e(t,e){t.u=X(),nn(t),t.l=vn(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),xn(n.b,"t",r),t.D=0,t.a=Nr(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ee(Q(t.Ca,t,t.a),t.O)),Se(t.J,t.a,"readystatechange",t.Xa),e=t.B?ft(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Re(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",a=o.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function tn(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=en(t,n);if(i==Xe){4==e&&(t.h=4,Le(14),r=!1),Ne(t.c,t.f,null,"[Incomplete Response]");break}if(i==Ye){t.h=4,Le(15),Ne(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Ne(t.c,t.f,i,null),un(t,i)}4==e&&0==n.length&&(t.h=1,Le(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),_r(e),e.F=!0,Le(11))):(Ne(t.c,t.f,n,"[Invalid Chunked Response]"),an(t),sn(t))}function en(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Xe:(n=Number(e.substring(n,r)),isNaN(n)?Ye:(r+=1)+n>e.length?Xe:(e=e.substr(r,n),t.D=r+n,e))}function nn(t){t.T=X()+t.P,rn(t,t.P)}function rn(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Fe(Q(t.Va,t),e)}function on(t){t.o&&(q.clearTimeout(t.o),t.o=null)}function sn(t){0==t.g.v||t.A||Ir(t.g,t)}function an(t){on(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,be(t.R),Ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function un(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||qn(n.b,t)))if(n.I=t.N,!t.C&&qn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Er(n),lr(n)}br(n),Le(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Fe(Q(n.Sa,n),6e3));if(1>=Vn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Sr(n,11)}else if((t.C||n.a==t)&&Er(n),!it(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var a=i[5];if(null!=a&&"number"==typeof a&&0<a){var u=1.5*a;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(at(h,"spdy")||at(h,"quic")||at(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(Bn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,_n(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=X()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=Ar(u,u.C?u.ga:null,u.fa),p.C){Gn(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(on(d),nn(d)),u.a=p}else mr(u);0<n.g.length&&dr(n)}else"stop"!=i[0]&&"close"!=i[0]||Sr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Sr(n,7):hr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);Re(4)}catch(t){}}function cn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(G(t)||"string"==typeof t)et(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(G(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(G(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function hn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof hn)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ln(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];fn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)fn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function fn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(j=Je.prototype).setTimeout=function(t){this.P=t},j.Xa=function(t){t=t.target;var e=this.F;e&&3==sr(t)?e.f():this.Ca(t)},j.Ca=function(t){try{if(t==this.a)t:{var e=sr(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!wt&&!this.a.$())){this.A||4!=e||7==n||Re(8==n||0>=r?3:2),on(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!it(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Le(12),an(this),sn(this);break t}Ne(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,un(this,u)}this.I?(tn(this,e,o),wt&&this.b&&3==e&&(Se(this.J,this.R,"tick",this.Wa),this.R.start())):(Ne(this.c,this.f,o,null),un(this,o)),4==e&&an(this),this.b&&!this.A&&(4==e?Ir(this.g,this):(this.b=!1,nn(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Le(12)):(this.h=0,Le(13)),an(this),sn(this)}}}catch(t){}},j.Wa=function(){if(this.a){var t=sr(this.a),e=this.a.$();this.D<e.length&&(on(this),tn(this,t,e),this.b&&4!=t&&nn(this))}},j.cancel=function(){this.A=!0,an(this)},j.Va=function(){this.o=null;var t=X();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(Re(3),Le(17)),an(this),this.h=2,sn(this)):rn(this,this.T-t)},(j=hn.prototype).K=function(){ln(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},j.L=function(){return ln(this),this.a.concat()},j.get=function(t,e){return fn(this.b,t)?this.b[t]:e},j.set=function(t,e){fn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},j.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var pn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function dn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof dn){this.a=void 0!==e?e:t.a,yn(this,t.f),this.j=t.j,gn(this,t.c),mn(this,t.h),this.g=t.g,e=t.b;var n=new Pn;n.c=e.c,e.a&&(n.a=new hn(e.a),n.b=e.b),bn(this,n),this.i=t.i}else t&&(n=String(t).match(pn))?(this.a=!!e,yn(this,n[1]||"",!0),this.j=En(n[2]||""),gn(this,n[3]||"",!0),mn(this,n[4]),this.g=En(n[5]||"",!0),bn(this,n[6]||"",!0),this.i=En(n[7]||"")):(this.a=!!e,this.b=new Pn(null,this.a))}function vn(t){return new dn(t)}function yn(t,e,n){t.f=n?En(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function gn(t,e,n){t.c=n?En(e,!0):e}function mn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function bn(t,e,n){e instanceof Pn?(t.b=e,function(t,e){e&&!t.f&&(Dn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(On(this,e),xn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=In(e,Nn)),t.b=new Pn(e,t.a))}function _n(t,e,n){t.b.set(e,n)}function wn(t){return _n(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^X()).toString(36)),t}function En(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function In(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Tn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}dn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(In(e,Sn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(In(e,Sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(In(n,"/"==n.charAt(0)?An:Cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",In(n,kn)),t.join("")};var Sn=/[#\/\?@]/g,Cn=/[#\?:]/g,An=/[#\?]/g,Nn=/[#\?@]/g,kn=/#/g;function Pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Dn(t){t.a||(t.a=new hn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function On(t,e){Dn(t),e=Ln(t,e),fn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,fn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ln(t)))}function Rn(t,e){return Dn(t),e=Ln(t,e),fn(t.a.b,e)}function xn(t,e,n){On(t,e),0<n.length&&(t.c=null,t.a.set(Ln(t,e),rt(n)),t.b+=n.length)}function Ln(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(j=Pn.prototype).add=function(t,e){Dn(this),this.c=null,t=Ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},j.forEach=function(t,e){Dn(this),this.a.forEach((function(n,r){et(n,(function(n){t.call(e,n,r,this)}),this)}),this)},j.L=function(){Dn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},j.K=function(t){Dn(this);var e=[];if("string"==typeof t)Rn(this,t)&&(e=nt(e,this.a.get(Ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=nt(e,t[n])}return e},j.set=function(t,e){return Dn(this),this.c=null,Rn(this,t=Ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},j.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},j.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Mn=function(t,e){this.b=t,this.a=e};function Fn(t){this.g=t||jn,t=q.PerformanceNavigationTiming?0<(t=q.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(q.ia&&q.ia.ya&&q.ia.ya()&&q.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var jn=10;function Un(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Vn(t){return t.b?1:t.a?t.a.size:0}function qn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Bn(t,e){t.a?t.a.add(e):t.b=e}function Gn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Wn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=F(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return rt(t.c)}function Hn(){}function zn(){this.a=new Hn}function Kn(t,e,n){var r=n||"";try{cn(t,(function(t,n){var i=t;W(t)&&(i=ae(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Jn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Fn.prototype.cancel=function(){var t,e;if(this.c=Wn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=F(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Hn.prototype.stringify=function(t){return q.JSON.stringify(t,void 0)},Hn.prototype.parse=function(t){return q.JSON.parse(t,void 0)};var Qn=q.JSON.parse;function Yn(t){ie.call(this),this.headers=new hn,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Xn,this.D=this.F=!1}Z(Yn,ie);var Xn="",Zn=/^https?$/i,$n=["POST","PUT"];function tr(t){return"content-type"==t.toLowerCase()}function er(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,nr(t),ir(t)}function nr(t){t.u||(t.u=!0,oe(t,"complete"),oe(t,"error"))}function rr(t){if(t.b&&void 0!==V&&(!t.s[1]||4!=sr(t)||2!=t.W()))if(t.l&&4==sr(t))_e(t.za,0,t);else if(oe(t,"readystatechange"),4==sr(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(pn)[1]||null;if(!o&&q.self&&q.self.location){var s=q.self.location.protocol;o=s.substr(0,s.length-1)}i=!Zn.test(o?o.toLowerCase():"")}e=i}if(e)oe(t,"complete"),oe(t,"success");else{t.h=6;try{var a=2<sr(t)?t.a.statusText:""}catch(n){a=""}t.f=a+" ["+t.W()+"]",nr(t)}}finally{ir(t)}}}function ir(t,e){if(t.a){or(t);var n=t.a,r=t.s[0]?B:null;t.a=null,t.s=null,e||oe(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function or(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(q.clearTimeout(t.m),t.m=null)}function sr(t){return t.a?t.a.readyState:0}function ar(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return lt(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):_n(t,e,n))}function ur(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function cr(t){this.pa=0,this.g=[],this.c=new Ae,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=ur("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=ur("baseRetryDelayMs",5e3,t),this.Ra=ur("retryDelaySeedMs",1e4,t),this.Ma=ur("forwardChannelMaxRetries",2,t),this.ma=ur("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Fn(t&&t.concurrentRequestLimit),this.ka=new zn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function hr(t){if(fr(t),3==t.v){var e=t.R++,n=vn(t.B);_n(n,"SID",t.J),_n(n,"RID",e),_n(n,"TYPE","terminate"),yr(t,n),(e=new Je(t,t.c,e,void 0)).H=2,e.i=wn(vn(n)),n=!1,q.navigator&&q.navigator.sendBeacon&&(n=q.navigator.sendBeacon(e.i.toString(),"")),!n&&q.Image&&((new Image).src=e.i,n=!0),n||(e.a=Nr(e.g,null),e.a.ba(e.i)),e.u=X(),nn(e)}Cr(t)}function lr(t){t.a&&(_r(t),t.a.cancel(),t.a=null)}function fr(t){lr(t),t.j&&(q.clearTimeout(t.j),t.j=null),Er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&q.clearTimeout(t.h),t.h=null)}function pr(t,e){t.g.push(new Mn(t.Oa++,e)),3==t.v&&dr(t)}function dr(t){Un(t.b)||t.h||(t.h=!0,de(t.Ba,t),t.u=0)}function vr(t,e){var n;n=e?e.f:t.R++;var r=vn(t.B);_n(r,"SID",t.J),_n(r,"RID",n),_n(r,"AID",t.P),yr(t,r),t.i&&t.l&&ar(r,t.i,t.l),n=new Je(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=gr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Bn(t.b,n),Ze(n,r,e)}function yr(t,e){t.f&&cn({},(function(t,n){_n(e,n,t)}))}function gr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?Q(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Kn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function mr(t){t.a||t.j||(t.T=1,de(t.Aa,t),t.o=0)}function br(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=Fe(Q(t.Aa,t),Tr(t,t.o)),t.o++,0))}function _r(t){null!=t.s&&(q.clearTimeout(t.s),t.s=null)}function wr(t){t.a=new Je(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=vn(t.la);_n(e,"RID","rpc"),_n(e,"SID",t.J),_n(e,"CI",t.H?"0":"1"),_n(e,"AID",t.P),yr(t,e),_n(e,"TYPE","xmlhttp"),t.i&&t.l&&ar(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=wn(vn(e)),n.j=null,n.I=!0,$e(n,t)}function Er(t){null!=t.m&&(q.clearTimeout(t.m),t.m=null)}function Ir(t,e){var n=null;if(t.a==e){Er(t),_r(t),t.a=null;var r=2}else{if(!qn(t.b,e))return;n=e.s,Gn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=X()-e.u;var i=t.u;oe(r=De(),new Me(r,n,e,i)),dr(t)}else mr(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(Vn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=Fe(Q(t.Ba,t,e),Tr(t,t.u)),t.u++,0)))}(t,e)||2==r&&br(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Sr(t,5);break;case 4:Sr(t,10);break;case 3:Sr(t,6);break;default:Sr(t,2)}}function Tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Sr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=Q(t.Ya,t);n||(n=new dn("//www.google.com/images/cleardot.gif"),q.location&&"http"==q.location.protocol||yn(n,"https"),wn(n)),function(t,e){var n=new Ae;if(q.Image){var r=new Image;r.onload=Y(Jn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Y(Jn,n,r,"TestLoadImage: error",!1,e),r.onabort=Y(Jn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Y(Jn,n,r,"TestLoadImage: timeout",!1,e),q.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Le(2);t.v=0,t.f&&t.f.ra(e),Cr(t),fr(t)}function Cr(t){t.v=0,t.I=-1,t.f&&(0==Wn(t.b).length&&0==t.g.length||(t.b.c.length=0,rt(t.g),t.g.length=0),t.f.qa())}function Ar(t,e,n){var r=function(t){return t instanceof dn?vn(t):new dn(t,void 0)}(n);if(""!=r.c)e&&gn(r,e+"."+r.c),mn(r,r.h);else{var i=q.location;r=function(t,e,n,r){var i=new dn(null,void 0);return t&&yn(i,t),e&&gn(i,e),n&&mn(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&lt(t.V,(function(t,e){_n(r,e,t)})),e=t.A,n=t.na,e&&n&&_n(r,e,n),_n(r,"VER",t.ha),yr(t,r),r}function Nr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Yn(t.Na)).F=t.C,e}function kr(){}function Pr(){if(bt&&!(10<=Number(Dt)))throw Error("Environmental error: no available transport.")}function Dr(t,e){ie.call(this),this.a=new cr(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!it(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!it(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new xr(this)}function Or(t){He.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Rr(){ze.call(this),this.status=1}function xr(t){this.a=t}(j=Yn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?qe(this.H):qe(Ge),this.a.onreadystatechange=Q(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void er(this,t)}t=n||"";var i=new hn(this.headers);r&&cn(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=tr,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=q.FormData&&t instanceof q.FormData,!(0<=tt($n,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{or(this),0<this.o&&((this.D=function(t){return bt&&Pt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=Q(this.xa,this)):this.m=_e(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){er(this,t)}},j.xa=function(){void 0!==V&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,oe(this,"timeout"),this.abort(8))},j.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,oe(this,"complete"),oe(this,"abort"),ir(this))},j.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ir(this,!0)),Yn.X.G.call(this)},j.za=function(){this.j||(this.A||this.l||this.g?rr(this):this.Ua())},j.Ua=function(){rr(this)},j.W=function(){try{return 2<sr(this)?this.a.status:-1}catch(t){return-1}},j.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},j.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Qn(e)}},j.ua=function(){return this.h},j.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(j=cr.prototype).ha=8,j.v=1,j.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Je(this,this.c,t,void 0),r=this.l;if(this.O&&(r?dt(r=ft(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=gr(this,n,e),_n(i=vn(this.B),"RID",t),_n(i,"CVER",22),this.A&&_n(i,"X-HTTP-Session-Id",this.A),yr(this,i),this.i&&r&&ar(i,this.i,r),Bn(this.b,n),this.Ia&&_n(i,"TYPE","init"),this.da?(_n(i,"$req",e),_n(i,"SID","null"),n.U=!0,Ze(n,i,null)):Ze(n,i,e),this.v=2}}else 3==this.v&&(t?vr(this,t):0==this.g.length||Un(this.b)||vr(this))},j.Aa=function(){if(this.j=null,wr(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Fe(Q(this.Ta,this),t)}},j.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Le(10),lr(this),wr(this))},j.Sa=function(){null!=this.m&&(this.m=null,lr(this),br(this),Le(19))},j.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),Le(2)):(this.c.info("Failed to ping google.com"),Le(1))},(j=kr.prototype).ta=function(){},j.sa=function(){},j.ra=function(){},j.qa=function(){},j.Ja=function(){},Pr.prototype.a=function(t,e){return new Dr(t,e)},Z(Dr,ie),Dr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;Le(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Ar(t,null,t.fa),dr(t)},Dr.prototype.close=function(){hr(this.a)},Dr.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,pr(this.a,e)}else this.l?((e={}).__data__=ae(t),pr(this.a,e)):pr(this.a,t)},Dr.prototype.G=function(){this.a.f=null,delete this.f,hr(this.a),delete this.a,Dr.X.G.call(this)},Z(Or,He),Z(Rr,ze),Z(xr,kr),xr.prototype.ta=function(){oe(this.a,"a")},xr.prototype.sa=function(t){oe(this.a,new Or(t))},xr.prototype.ra=function(t){oe(this.a,new Rr(t))},xr.prototype.qa=function(){oe(this.a,"b")},Pr.prototype.createWebChannel=Pr.prototype.a,Dr.prototype.send=Dr.prototype.h,Dr.prototype.open=Dr.prototype.g,Dr.prototype.close=Dr.prototype.close,je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,Ue.COMPLETE="complete",Be.EventType=We,We.OPEN="a",We.CLOSE="b",We.ERROR="c",We.MESSAGE="d",ie.prototype.listen=ie.prototype.va,Yn.prototype.listenOnce=Yn.prototype.wa,Yn.prototype.getLastError=Yn.prototype.Qa,Yn.prototype.getLastErrorCode=Yn.prototype.ua,Yn.prototype.getStatus=Yn.prototype.W,Yn.prototype.getResponseJson=Yn.prototype.Pa,Yn.prototype.getResponseText=Yn.prototype.$,Yn.prototype.send=Yn.prototype.ba;var Lr=je,Mr=Ue,Fr=ke,jr=10,Ur=11,Vr=Be,qr=Yn,Br=n(655),Gr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Wr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Hr=new x.Yd("@firebase/firestore");function zr(){return Hr.logLevel}function Kr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=x.in.DEBUG){var r=e.map(Yr);Hr.debug.apply(Hr,(0,Br.pr)(["Firestore (8.2.7): "+t],r))}}function Jr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=x.in.ERROR){var r=e.map(Yr);Hr.error.apply(Hr,(0,Br.pr)(["Firestore (8.2.7): "+t],r))}}function Qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Hr.logLevel<=x.in.WARN){var r=e.map(Yr);Hr.warn.apply(Hr,(0,Br.pr)(["Firestore (8.2.7): "+t],r))}}function Yr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Xr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.2.7) INTERNAL ASSERTION FAILED: "+t;throw Jr(e),new Error(e)}function Zr(t,e){t||Xr()}function $r(t,e){return t}function ti(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var ei=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ti(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ni(t,e){return t<e?-1:t>e?1:0}function ri(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ii(t){return t+"\0"}var oi=function(){function t(t){this.h=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.h,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},t.prototype.l=function(){return 2*this.h.length},t.prototype._=function(t){return ni(this.h,t.h)},t.prototype.isEqual=function(t){return this.h===t.h},t}();oi.T=new oi("");var si={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ai=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,Br.ZT)(e,t),e}(Error),ui=function(){function t(t){this.I=t}return t.fromBase64String=function(e){try{return new t(oi.fromBase64String(e))}catch(e){throw new ai(si.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(oi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.I.toBase64()},t.prototype.toUint8Array=function(){return this.I.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.I.isEqual(t.I)},t}(),ci=function(){function t(t){this.uid=t}return t.prototype.m=function(){return null!=this.uid},t.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();ci.UNAUTHENTICATED=new ci(null),ci.R=new ci("google-credentials-uid"),ci.P=new ci("first-party-uid");var hi=function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t},li=function(){function t(){this.V=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.p=function(){},t.prototype.v=function(t){this.V=t,t(ci.UNAUTHENTICATED)},t.prototype.S=function(){this.V=null},t}(),fi=function(){function t(t){var e=this;this.D=null,this.currentUser=ci.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then((function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.N!==e?(Kr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Zr("string"==typeof n.accessToken),new hi(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.p=function(){this.forceRefresh=!0},t.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},t.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},t.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Zr(null===t||"string"==typeof t),new ci(t)},t}(),pi=function(){function t(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=ci.P}return Object.defineProperty(t.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),di=function(){function t(t,e){this.F=t,this.O=e}return t.prototype.getToken=function(){return Promise.resolve(new pi(this.F,this.O))},t.prototype.v=function(t){t(ci.P)},t.prototype.S=function(){},t.prototype.p=function(){},t}(),vi=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}return t.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},t}();vi.q=-1;var yi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new ai(si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new ai(si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new ai(si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new ai(si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.U=function(t){return this.seconds===t.seconds?ni(this.nanoseconds,t.nanoseconds):ni(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),gi=function(){function t(t){this.timestamp=t}return t.K=function(e){return new t(e)},t.min=function(){return new t(new yi(0,0))},t.prototype._=function(t){return this.timestamp.U(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.j=function(){return this.timestamp},t}(),mi=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Xr(),void 0===n?n=t.length-e:n>t.length-e&&Xr(),this.segments=t,this.offset=e,this.G=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.H(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.J(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},t.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},t.prototype.Z=function(){return this.segments[this.offset]},t.prototype.tt=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.et=function(){return 0===this.length},t.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},t.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),bi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.prototype.rt=function(){return this.it().join("/")},e.prototype.toString=function(){return this.rt()},e.ot=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new ai(si.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.ct=function(){return new e([])},e}(mi),_i=/^[_a-zA-Z][_a-zA-Z0-9]*$/,wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.J=function(t,n,r){return new e(t,n,r)},e.at=function(t){return _i.test(t)},e.prototype.rt=function(){return this.it().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.at(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.rt()},e.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},e.ht=function(){return new e(["__name__"])},e.lt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new ai(si.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var a=t[i];if("\\"===a){if(i+1===t.length)throw new ai(si.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new ai(si.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===a?(s=!s,i++):"."!==a||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new ai(si.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.ct=function(){return new e([])},e}(mi),Ei=function(){function t(t){this.path=t}return t._t=function(e){return new t(bi.ot(e))},t.ft=function(e){return new t(bi.ot(e).Y(5))},t.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===bi.H(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.H=function(t,e){return bi.H(t.path,e.path)},t.wt=function(t){return t.length%2==0},t.Et=function(e){return new t(new bi(e.slice()))},t}();function Ii(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ti(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Si(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ci=function(){function t(t){this.fields=t,t.sort(wi.H)}return t.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},t.prototype.isEqual=function(t){return ri(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Ai=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ni(t){if(Zr(!!t),"string"==typeof t){var e=0,n=Ai.exec(t);if(Zr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ki(t.seconds),nanos:ki(t.nanos)}}function ki(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Pi(t){return"string"==typeof t?oi.fromBase64String(t):oi.fromUint8Array(t)}function Di(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Oi(t){var e=t.mapValue.fields.__previous_value__;return Di(e)?Oi(e):e}function Ri(t){var e=Ni(t.mapValue.fields.__local_write_time__.timestampValue);return new yi(e.seconds,e.nanos)}function xi(t){return null==t}function Li(t){return 0===t&&1/t==-1/0}function Mi(t){return"number"==typeof t&&Number.isInteger(t)&&!Li(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Fi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Di(t)?4:10:Xr()}function ji(t,e){var n=Fi(t);if(n!==Fi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ri(t).isEqual(Ri(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ni(t.timestampValue),r=Ni(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Pi(t.bytesValue).isEqual(Pi(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ki(t.geoPointValue.latitude)===ki(e.geoPointValue.latitude)&&ki(t.geoPointValue.longitude)===ki(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ki(t.integerValue)===ki(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ki(t.doubleValue),r=ki(e.doubleValue);return n===r?Li(n)===Li(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ri(t.arrayValue.values||[],e.arrayValue.values||[],ji);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Ii(n)!==Ii(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ji(n[i],r[i])))return!1;return!0}(t,e);default:return Xr()}}function Ui(t,e){return void 0!==(t.values||[]).find((function(t){return ji(t,e)}))}function Vi(t,e){var n=Fi(t),r=Fi(e);if(n!==r)return ni(n,r);switch(n){case 0:return 0;case 1:return ni(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ki(t.integerValue||t.doubleValue),r=ki(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return qi(t.timestampValue,e.timestampValue);case 4:return qi(Ri(t),Ri(e));case 5:return ni(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Pi(t),r=Pi(e);return n._(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ni(n[i],r[i]);if(0!==o)return o}return ni(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ni(ki(t.latitude),ki(e.latitude));return 0!==n?n:ni(ki(t.longitude),ki(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vi(n[i],r[i]);if(o)return o}return ni(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=ni(r[s],o[s]);if(0!==a)return a;var u=Vi(n[r[s]],i[o[s]]);if(0!==u)return u}return ni(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Xr()}}function qi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ni(t,e);var n=Ni(t),r=Ni(e),i=ni(n.seconds,r.seconds);return 0!==i?i:ni(n.nanos,r.nanos)}function Bi(t){return Gi(t)}function Gi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Ni(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Pi(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Ei.ft(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=Gi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+Gi(t.fields[o])}return e+"}"}(t.mapValue):Xr();var e,n}function Wi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function Hi(t){return!!t&&"integerValue"in t}function zi(t){return!!t&&"arrayValue"in t}function Ki(t){return!!t&&"nullValue"in t}function Ji(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Qi(t){return!!t&&"mapValue"in t}var Yi=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},t.prototype.isEqual=function(t){return ji(this.proto,t.proto)},t}(),Xi=function(){function t(t){void 0===t&&(t=Yi.empty()),this.It=t,this.At=new Map}return t.prototype.set=function(t,e){return this.Rt(t,e),this},t.prototype.delete=function(t){return this.Rt(t,null),this},t.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Fi(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.tt(),e)},t.prototype.Pt=function(){var t=this.yt(wi.ct(),this.At);return null!=t?new Yi(t):this.It},t.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=Qi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.yt(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Zi(t){var e=[];return Ti(t.fields||{},(function(t,n){var r=new wi([t]);if(Qi(n)){var i=Zi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var a=s[o];e.push(r.child(a))}}else e.push(r)})),new Ci(e)}var $i=function(t,e){this.key=t,this.version=e},to=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).gt=r,o.Vt=!!i.Vt,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return(0,Br.ZT)(e,t),e.prototype.field=function(t){return this.gt.field(t)},e.prototype.data=function(){return this.gt},e.prototype.bt=function(){return this.gt.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}($i),eo=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return(0,Br.ZT)(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}($i),no=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}($i),ro=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function io(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ro(t,e,n,r,i,o,s)}function oo(t){var e=$r(t);if(null===e.vt){var n=e.path.rt();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.rt()+t.op.toString()+Bi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.rt()+t.dir}(t)})).join(","),xi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=bo(e.startAt)),e.endAt&&(n+="|ub:",n+=bo(e.endAt)),e.vt=n}return e.vt}function so(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!wo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ji(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Io(t.startAt,e.startAt)&&Io(t.endAt,e.endAt)}function ao(t){return Ei.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var uo=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,Br.ZT)(e,t),e.create=function(t,n,r){return t.ut()?"in"===n||"not-in"===n?this.St(t,n,r):new co(t,n,r):"array-contains"===n?new po(t,r):"in"===n?new vo(t,r):"not-in"===n?new yo(t,r):"array-contains-any"===n?new go(t,r):new e(t,n,r)},e.St=function(t,e,n){return"in"===e?new ho(t,n):new lo(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Dt(Vi(e,this.value)):null!==e&&Fi(this.value)===Fi(e)&&this.Dt(Vi(e,this.value))},e.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Xr()}},e.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),co=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Ei.ft(r.referenceValue),i}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){var e=Ei.H(t.key,this.key);return this.Dt(e)},e}(uo),ho=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=fo(0,n),r}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(uo),lo=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=fo(0,n),r}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(uo);function fo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Ei.ft(t.referenceValue)}))}var po=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return zi(e)&&Ui(e.arrayValue,this.value)},e}(uo),vo=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ui(this.value.arrayValue,e)},e}(uo),yo=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){if(Ui(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ui(this.value.arrayValue,e)},e}(uo),go=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,Br.ZT)(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!zi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Ui(e.value.arrayValue,t)}))},e}(uo),mo=function(t,e){this.position=t,this.before=e};function bo(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Bi(t)})).join(",")}var _o=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function wo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Eo(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.ut()?Ei.H(Ei.ft(s.referenceValue),n.key):Vi(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Io(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ji(t.position[n],e.position[n]))return!1;return!0}var To=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.Nt=null,this.$t=null,this.startAt,this.endAt};function So(t,e,n,r,i,o,s,a){return new To(t,e,n,r,i,o,s,a)}function Co(t){return new To(t)}function Ao(t){return!xi(t.limit)&&"F"===t.limitType}function No(t){return!xi(t.limit)&&"L"===t.limitType}function ko(t){return t.xt.length>0?t.xt[0].field:null}function Po(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Do(t){return null!==t.collectionGroup}function Oo(t){var e=$r(t);if(null===e.Nt){e.Nt=[];var n=Po(e),r=ko(e);if(null!==n&&null===r)n.ut()||e.Nt.push(new _o(n)),e.Nt.push(new _o(wi.ht(),"asc"));else{for(var i=!1,o=0,s=e.xt;o<s.length;o++){var a=s[o];e.Nt.push(a),a.field.ut()&&(i=!0)}if(!i){var u=e.xt.length>0?e.xt[e.xt.length-1].dir:"asc";e.Nt.push(new _o(wi.ht(),u))}}}return e.Nt}function Ro(t){var e=$r(t);if(!e.$t)if("F"===e.limitType)e.$t=io(e.path,e.collectionGroup,Oo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Oo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new _o(o.field,s))}var a=e.endAt?new mo(e.endAt.position,!e.endAt.before):null,u=e.startAt?new mo(e.startAt.position,!e.startAt.before):null;e.$t=io(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.$t}function xo(t,e,n){return new To(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Lo(t,e){return so(Ro(t),Ro(e))&&t.limitType===e.limitType}function Mo(t){return oo(Ro(t))+"|lt:"+t.limitType}function Fo(t){return"Query(target="+function(t){var e=t.path.rt();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.rt()+" "+e.op+" "+Bi(e.value);var e})).join(", ")+"]"),xi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.rt()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+bo(t.startAt)),t.endAt&&(e+=", endAt: "+bo(t.endAt)),"Target("+e+")"}(Ro(t))+"; limitType="+t.limitType+")"}function jo(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.dt(t.collectionGroup)&&t.path.nt(n):Ei.wt(t.path)?t.path.isEqual(n):t.path.st(n)}(t,e)&&function(t,e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Eo(t.startAt,Oo(t),e)||t.endAt&&Eo(t.endAt,Oo(t),e))}(t,e)}function Uo(t){return function(e,n){for(var r=!1,i=0,o=Oo(t);i<o.length;i++){var s=o[i],a=Vo(s,e,n);if(0!==a)return a;r=r||s.field.ut()}return 0}}function Vo(t,e,n){var r=t.field.ut()?Ei.H(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?Vi(r,i):Xr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Xr()}}var qo=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=gi.min()),void 0===o&&(o=gi.min()),void 0===s&&(s=oi.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.kt=function(e){return new t(this.target,this.targetId,this.Ft,e,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.Mt=function(e,n){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Lt=function(e){return new t(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,e,this.resumeToken)},t}();function Bo(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Li(e)?"-0":e}}function Go(t){return{integerValue:""+t}}function Wo(t,e){return Mi(e)?Go(e):Bo(t,e)}var Ho=function(){this.qt=void 0};function zo(t,e,n){return t instanceof Qo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Yo?Xo(t,e):t instanceof Zo?$o(t,e):function(t,e){var n=Jo(t,e),r=es(n)+es(t.Ut);return Hi(n)&&Hi(t.Ut)?Go(r):Bo(t.Qt,r)}(t,e)}function Ko(t,e,n){return t instanceof Yo?Xo(t,e):t instanceof Zo?$o(t,e):n}function Jo(t,e){return t instanceof ts?Hi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Qo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e}(Ho),Yo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,Br.ZT)(e,t),e}(Ho);function Xo(t,e){for(var n=ns(e),r=function(t){n.some((function(e){return ji(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Zo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,Br.ZT)(e,t),e}(Ho);function $o(t,e){for(var n=ns(e),r=function(t){n=n.filter((function(e){return!ji(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ts=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qt=e,r.Ut=n,r}return(0,Br.ZT)(e,t),e}(Ho);function es(t){return ki(t.integerValue||t.doubleValue)}function ns(t){return zi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var rs=function(t,e){this.field=t,this.transform=e},is=function(t,e){this.version=t,this.transformResults=e},os=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Kt=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function ss(t,e){return void 0!==t.updateTime?e instanceof to&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof to}var as=function(){};function us(t,e,n){return t instanceof ps?function(t,e,n){var r=t.value;if(n.transformResults){var i=ys(t.fieldTransforms,e,n.transformResults);r=ms(t.fieldTransforms,r,i)}return new to(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ds?function(t,e,n){if(!ss(t.jt,e))return new no(t.key,n.version);var r=vs(t,e,n.transformResults?ys(t.fieldTransforms,e,n.transformResults):[]);return new to(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new eo(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function cs(t,e,n){return t instanceof ps?function(t,e,n){if(!ss(t.jt,e))return e;var r=t.value,i=gs(t.fieldTransforms,n,e);r=ms(t.fieldTransforms,r,i);var o=fs(e);return new to(t.key,o,r,{Vt:!0})}(t,e,n):t instanceof ds?function(t,e,n){if(!ss(t.jt,e))return e;var r=fs(e),i=vs(t,e,gs(t.fieldTransforms,n,e));return new to(t.key,r,i,{Vt:!0})}(t,e,n):function(t,e){return ss(t.jt,e)?new eo(t.key,gi.min()):e}(t,e)}function hs(t,e){return function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof to?e.field(o.field):void 0,a=Jo(o.transform,s||null);null!=a&&(n=null==n?(new Xi).set(o.field,a):n.set(o.field,a))}return n?n.Pt():null}(t.fieldTransforms,e)}function ls(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&ri(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Yo&&e instanceof Yo||t instanceof Zo&&e instanceof Zo?ri(t.elements,e.elements,ji):t instanceof ts&&e instanceof ts?ji(t.Ut,e.Ut):t instanceof Qo&&e instanceof Qo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt))}function fs(t){return t instanceof to?t.version:gi.min()}var ps=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.jt=r,o.fieldTransforms=i,o.type=0,o}return(0,Br.ZT)(e,t),e}(as),ds=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var s=this;return(s=t.call(this)||this).key=e,s.data=n,s.Gt=r,s.jt=i,s.fieldTransforms=o,s.type=1,s}return(0,Br.ZT)(e,t),e}(as);function vs(t,e,n){var r;return r=function(t,e){var n=new Xi(e);return t.Gt.fields.forEach((function(e){if(!e.et()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Pt()}(t,r=e instanceof to?e.data():Yi.empty()),ms(t.fieldTransforms,r,n)}function ys(t,e,n){var r=[];Zr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=null;e instanceof to&&(a=e.field(o.field)),r.push(Ko(s,a,n[i]))}return r}function gs(t,e,n){for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i],a=s.transform,u=null;n instanceof to&&(u=n.field(s.field)),r.push(zo(a,u,e))}return r}function ms(t,e,n){for(var r=new Xi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var bs,_s,ws=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=2,r.fieldTransforms=[],r}return(0,Br.ZT)(e,t),e}(as),Es=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.jt=n,r.type=3,r.fieldTransforms=[],r}return(0,Br.ZT)(e,t),e}(as),Is=function(t){this.count=t};function Ts(t){switch(t){case si.OK:return Xr();case si.CANCELLED:case si.UNKNOWN:case si.DEADLINE_EXCEEDED:case si.RESOURCE_EXHAUSTED:case si.INTERNAL:case si.UNAVAILABLE:case si.UNAUTHENTICATED:return!1;case si.INVALID_ARGUMENT:case si.NOT_FOUND:case si.ALREADY_EXISTS:case si.PERMISSION_DENIED:case si.FAILED_PRECONDITION:case si.ABORTED:case si.OUT_OF_RANGE:case si.UNIMPLEMENTED:case si.DATA_LOSS:return!0;default:return Xr()}}function Ss(t){if(void 0===t)return Jr("GRPC error has no .code"),si.UNKNOWN;switch(t){case bs.OK:return si.OK;case bs.CANCELLED:return si.CANCELLED;case bs.UNKNOWN:return si.UNKNOWN;case bs.DEADLINE_EXCEEDED:return si.DEADLINE_EXCEEDED;case bs.RESOURCE_EXHAUSTED:return si.RESOURCE_EXHAUSTED;case bs.INTERNAL:return si.INTERNAL;case bs.UNAVAILABLE:return si.UNAVAILABLE;case bs.UNAUTHENTICATED:return si.UNAUTHENTICATED;case bs.INVALID_ARGUMENT:return si.INVALID_ARGUMENT;case bs.NOT_FOUND:return si.NOT_FOUND;case bs.ALREADY_EXISTS:return si.ALREADY_EXISTS;case bs.PERMISSION_DENIED:return si.PERMISSION_DENIED;case bs.FAILED_PRECONDITION:return si.FAILED_PRECONDITION;case bs.ABORTED:return si.ABORTED;case bs.OUT_OF_RANGE:return si.OUT_OF_RANGE;case bs.UNIMPLEMENTED:return si.UNIMPLEMENTED;case bs.DATA_LOSS:return si.DATA_LOSS;default:return Xr()}}(_s=bs||(bs={}))[_s.OK=0]="OK",_s[_s.CANCELLED=1]="CANCELLED",_s[_s.UNKNOWN=2]="UNKNOWN",_s[_s.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_s[_s.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_s[_s.NOT_FOUND=5]="NOT_FOUND",_s[_s.ALREADY_EXISTS=6]="ALREADY_EXISTS",_s[_s.PERMISSION_DENIED=7]="PERMISSION_DENIED",_s[_s.UNAUTHENTICATED=16]="UNAUTHENTICATED",_s[_s.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_s[_s.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_s[_s.ABORTED=10]="ABORTED",_s[_s.OUT_OF_RANGE=11]="OUT_OF_RANGE",_s[_s.UNIMPLEMENTED=12]="UNIMPLEMENTED",_s[_s.INTERNAL=13]="INTERNAL",_s[_s.UNAVAILABLE=14]="UNAVAILABLE",_s[_s.DATA_LOSS=15]="DATA_LOSS";var Cs=function(){function t(t,e){this.H=t,this.root=e||Ns.EMPTY}return t.prototype.zt=function(e,n){return new t(this.H,this.root.zt(e,n,this.H).copy(null,null,Ns.Ht,null,null))},t.prototype.remove=function(e){return new t(this.H,this.root.remove(e,this.H).copy(null,null,Ns.Ht,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.et=function(){return this.root.et()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.Jt=function(){return this.root.Jt()},t.prototype.Yt=function(){return this.root.Yt()},t.prototype.Xt=function(t){return this.root.Xt(t)},t.prototype.forEach=function(t){this.Xt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Xt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.Zt=function(t){return this.root.Zt(t)},t.prototype.te=function(){return new As(this.root,null,this.H,!1)},t.prototype.ee=function(t){return new As(this.root,t,this.H,!1)},t.prototype.ne=function(){return new As(this.root,null,this.H,!0)},t.prototype.se=function(t){return new As(this.root,t,this.H,!0)},t}(),As=function(){function t(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return t.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},t.prototype.ce=function(){return this.re.length>0},t.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},t}(),Ns=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.et=function(){return!1},t.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},t.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},t.prototype.min=function(){return this.left.et()?this:this.left.min()},t.prototype.Jt=function(){return this.min().key},t.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},t.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},t.prototype.he=function(){if(this.left.et())return t.EMPTY;var e=this;return e.left.le()||e.left.left.le()||(e=e._e()),(e=e.copy(null,null,null,e.left.he(),null)).ue()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),0===n(e,i.key)){if(i.right.et())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.ue()},t.prototype.le=function(){return this.color},t.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},t.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},t.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},t.prototype.we=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.fe=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},t.prototype.Ie=function(){if(this.le()&&this.left.le())throw Xr();if(this.right.le())throw Xr();var t=this.left.Ie();if(t!==this.right.Ie())throw Xr();return t+(this.le()?0:1)},t}();Ns.EMPTY=null,Ns.RED=!0,Ns.Ht=!1,Ns.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Xr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.zt=function(t,e,n){return new Ns(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.et=function(){return!0},t.prototype.Xt=function(t){return!1},t.prototype.Zt=function(t){return!1},t.prototype.Jt=function(){return null},t.prototype.Yt=function(){return null},t.prototype.le=function(){return!1},t.prototype.Te=function(){return!0},t.prototype.Ie=function(){return 0},t}());var ks=function(){function t(t){this.H=t,this.data=new Cs(this.H)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.Jt()},t.prototype.last=function(){return this.data.Yt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Xt((function(e,n){return t(e),!1}))},t.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(this.H(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ae=function(t,e){var n;for(n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},t.prototype.Re=function(t){var e=this.data.ee(t);return e.ce()?e.oe().key:null},t.prototype.te=function(){return new Ps(this.data.te())},t.prototype.ee=function(t){return new Ps(this.data.ee(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.et=function(){return this.data.et()},t.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.te(),r=e.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(0!==this.H(i,o))return!1}return!0},t.prototype.it=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.H);return n.data=e,n},t}(),Ps=function(){function t(t){this.ye=t}return t.prototype.oe=function(){return this.ye.oe().key},t.prototype.ce=function(){return this.ye.ce()},t}(),Ds=new Cs(Ei.H);function Os(){return Ds}function Rs(){return Os()}var xs=new Cs(Ei.H);function Ls(){return xs}var Ms=new Cs(Ei.H);function Fs(){return Ms}var js=new ks(Ei.H);function Us(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=js,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Vs=new ks(ni);function qs(){return Vs}var Bs=function(){function t(t){this.H=t?function(e,n){return t(e,n)||Ei.H(e.key,n.key)}:function(t,e){return Ei.H(t.key,e.key)},this.ge=Ls(),this.Ve=new Cs(this.H)}return t.pe=function(e){return new t(e.H)},t.prototype.has=function(t){return null!=this.ge.get(t)},t.prototype.get=function(t){return this.ge.get(t)},t.prototype.first=function(){return this.Ve.Jt()},t.prototype.last=function(){return this.Ve.Yt()},t.prototype.et=function(){return this.Ve.et()},t.prototype.indexOf=function(t){var e=this.ge.get(t);return e?this.Ve.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ve.Xt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ve.te(),r=e.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.H=this.H,r.ge=e,r.Ve=n,r},t}(),Gs=function(){function t(){this.be=new Cs(Ei.H)}return t.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);n?0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Xr():this.be=this.be.zt(e,t)},t.prototype.ve=function(){var t=[];return this.be.Xt((function(e,n){t.push(n)})),t},t}(),Ws=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=a}return t.Ne=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Bs.pe(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Lo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Hs=function(){function t(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}return t.Me=function(e,n){var r=new Map;return r.set(e,zs.Le(e,n)),new t(gi.min(),r,qs(),Os(),Us())},t}(),zs=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}return t.Le=function(e,n){return new t(oi.T,n,Us(),Us(),Us())},t}(),Ks=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},Js=function(t,e){this.targetId=t,this.je=e},Qs=function(t,e,n,r){void 0===n&&(n=oi.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Ys=function(){function t(){this.Ge=0,this.ze=$s(),this.He=oi.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(t.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),t.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},t.prototype.en=function(){var t=Us(),e=Us(),n=Us();return this.ze.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Xr()}})),new zs(this.He,this.Je,t,e,n)},t.prototype.nn=function(){this.Ye=!1,this.ze=$s()},t.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},t.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},t.prototype.on=function(){this.Ge+=1},t.prototype.cn=function(){this.Ge-=1},t.prototype.an=function(){this.Ye=!0,this.Je=!0},t}(),Xs=function(){function t(t){this.un=t,this.hn=new Map,this.ln=Os(),this._n=Zs(),this.fn=new ks(ni)}return t.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof to?this.wn(r,t.We):t.We instanceof eo&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},t.prototype.Tn=function(t){var e=this;this.In(t,(function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:Xr()}}))},t.prototype.In=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.hn.forEach((function(t,r){n.An(r)&&e(r)}))},t.prototype.Pn=function(t){var e=t.targetId,n=t.je.count,r=this.yn(e);if(r){var i=r.target;if(ao(i))if(0===n){var o=new Ei(i.path);this.En(e,o,new eo(o,gi.min()))}else Zr(1===n);else this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e))}},t.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach((function(r,i){var o=e.yn(i);if(o){if(r.Be&&ao(o.target)){var s=new Ei(o.target.path);null!==e.ln.get(s)||e.pn(i,s)||e.En(i,s,new eo(s,t))}r.Ze&&(n.set(i,r.en()),r.nn())}}));var r=Us();this._n.forEach((function(t,n){var i=!0;n.Ae((function(t){var n=e.yn(t);return!n||2===n.Ft||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Hs(t,n,this.fn,this.ln,r);return this.ln=Os(),this._n=Zs(),this.fn=new ks(ni),i},t.prototype.wn=function(t,e){if(this.An(t)){var n=this.pn(t,e.key)?2:0;this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t))}},t.prototype.En=function(t,e,n){if(this.An(t)){var r=this.mn(t);this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n))}},t.prototype.removeTarget=function(t){this.hn.delete(t)},t.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},t.prototype.on=function(t){this.mn(t).on()},t.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new Ys,this.hn.set(t,e)),e},t.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new ks(ni),this._n=this._n.zt(t,e)),e},t.prototype.An=function(t){var e=null!==this.yn(t);return e||Kr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},t.prototype.Rn=function(t){var e=this;this.hn.set(t,new Ys),this.un.vn(t).forEach((function(n){e.En(t,n,null)}))},t.prototype.pn=function(t,e){return this.un.vn(t).has(e)},t}();function Zs(){return new Cs(Ei.H)}function $s(){return new Cs(Ei.H)}var ta={asc:"ASCENDING",desc:"DESCENDING"},ea={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},na=function(t,e){this.t=t,this.Bt=e};function ra(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ia(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function oa(t,e){return ra(t,e.j())}function sa(t){return Zr(!!t),gi.K(function(t){var e=Ni(t);return new yi(e.seconds,e.nanos)}(t))}function aa(t,e){return function(t){return new bi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).rt()}function ua(t){var e=bi.ot(t);return Zr(Oa(e)),e}function ca(t,e){return aa(t.t,e.path)}function ha(t,e){var n=ua(e);if(n.get(1)!==t.t.projectId)throw new ai(si.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new ai(si.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new Ei(da(n))}function la(t,e){return aa(t.t,e)}function fa(t){var e=ua(t);return 4===e.length?bi.ct():da(e)}function pa(t){return new bi(["projects",t.t.projectId,"databases",t.t.database]).rt()}function da(t){return Zr(t.length>4&&"documents"===t.get(4)),t.Y(5)}function va(t,e,n){return{name:ca(t,e),fields:n.proto.mapValue.fields}}function ya(t,e,n){var r=ha(t,e.name),i=sa(e.updateTime),o=new Yi({mapValue:{fields:e.fields}});return new to(r,i,o,{hasCommittedMutations:!!n})}function ga(t,e){var n;if(e instanceof ps)n={update:va(t,e.key,e.value)};else if(e instanceof ws)n={delete:ca(t,e.key)};else if(e instanceof ds)n={update:va(t,e.key,e.data),updateMask:Da(e.Gt)};else{if(!(e instanceof Es))return Xr();n={verify:ca(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Qo)return{fieldPath:e.field.rt(),setToServerValue:"REQUEST_TIME"};if(n instanceof Yo)return{fieldPath:e.field.rt(),appendMissingElements:{values:n.elements}};if(n instanceof Zo)return{fieldPath:e.field.rt(),removeAllFromArray:{values:n.elements}};if(n instanceof ts)return{fieldPath:e.field.rt(),increment:n.Ut};throw Xr()}(0,t)}))),e.jt.Wt||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:oa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Xr()}(t,e.jt)),n}function ma(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?os.updateTime(sa(t.updateTime)):void 0!==t.exists?os.exists(t.exists):os.Kt()}(e.currentDocument):os.Kt(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Zr("REQUEST_TIME"===e.setToServerValue),n=new Qo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new Yo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new Zo(i)}else"increment"in e?n=new ts(t,e.increment):Xr();var o=wi.lt(e.fieldPath);return new rs(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=ha(t,e.update.name),o=new Yi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=function(t){var e=t.fieldPaths||[];return new Ci(e.map((function(t){return wi.lt(t)})))}(e.updateMask);return new ds(i,o,s,n,r)}return new ps(i,o,n,r)}if(e.delete){var a=ha(t,e.delete);return new ws(a,n)}if(e.verify){var u=ha(t,e.verify);return new Es(u,n)}return Xr()}function ba(t,e){return{documents:[la(t,e.path)]}}function _a(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=la(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=la(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ji(t.value))return{unaryFilter:{field:Aa(t.field),op:"IS_NAN"}};if(Ki(t.value))return{unaryFilter:{field:Aa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ji(t.value))return{unaryFilter:{field:Aa(t.field),op:"IS_NOT_NAN"}};if(Ki(t.value))return{unaryFilter:{field:Aa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Aa(t.field),op:Ca(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Aa(t.field),direction:Sa(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Bt||xi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Ia(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ia(e.endAt)),n}function wa(t){var e=fa(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Zr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Ea(n.where));var a=[];n.orderBy&&(a=n.orderBy.map((function(t){return function(t){return new _o(Na(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return xi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Ta(n.startAt));var h=null;return n.endAt&&(h=Ta(n.endAt)),So(e,i,a,s,u,"F",c,h)}function Ea(t){return t?void 0!==t.unaryFilter?[Pa(t)]:void 0!==t.fieldFilter?[ka(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Ea(t)})).reduce((function(t,e){return t.concat(e)})):Xr():[]}function Ia(t){return{before:t.before,values:t.position}}function Ta(t){var e=!!t.before,n=t.values||[];return new mo(n,e)}function Sa(t){return ta[t]}function Ca(t){return ea[t]}function Aa(t){return{fieldPath:t.rt()}}function Na(t){return wi.lt(t.fieldPath)}function ka(t){return uo.create(Na(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Xr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Pa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Na(t.unaryFilter.field);return uo.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Na(t.unaryFilter.field);return uo.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Na(t.unaryFilter.field);return uo.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Na(t.unaryFilter.field);return uo.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Xr()}}function Da(t){var e=[];return t.fields.forEach((function(t){return e.push(t.rt())})),{fieldPaths:e}}function Oa(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ra=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},xa=function(){function t(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t((function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)}),(function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Nn&&Xr(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(e,this.result):new t((function(t,i){r.Dn=function(n){r.Fn(e,n).next(t,i)},r.Cn=function(e){r.$n(n,e).next(t,i)}}))},t.prototype.On=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.kn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Fn=function(e,n){return e?this.kn((function(){return e(n)})):t.resolve(n)},t.prototype.$n=function(e,n){return e?this.kn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Mn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Ln=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Mn(r)},t}(),La=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new Ra,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new ja(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){var r=Ga(e.target.error);n.Bn.reject(new ja(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ja(n,e)}},Object.defineProperty(t.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(Kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Va(e)},t}(),Ma=function(){function t(e,n,r){this.name=e,this.version=n,this.Un=r,12.2===t.Qn((0,L.z$)())&&Jr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Kr("SimpleDb","Removing database:",t),qa(window.indexedDB.deleteDatabase(t)).On()},t.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(t.Wn())return!0;var e=(0,L.z$)(),n=t.Qn(e),r=0<n&&n<10,i=t.jn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},t.zn=function(t,e){return t.store(e)},t.Qn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.jn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Hn=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ja(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new ai(si.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ja(t,n))},i.onupgradeneeded=function(t){Kr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next((function(){Kr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}}))}))},t.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,s=function(){var e,s,u,c,h;return(0,Br.Jh)(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,a.Hn(t)];case 2:return a.db=l.sent(),e=La.open(a.db,t,i?"readonly":"readwrite",n),s=r(e).catch((function(t){return e.abort(t),xa.reject(t)})).On(),u={},s.catch((function(){})),[4,e.qn];case 3:return[2,(u.value=(l.sent(),s),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,Kr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),a.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},a=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Fa=function(){function t(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(t.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.ts=!0},t.prototype.ss=function(t){this.es=t},t.prototype.delete=function(){return qa(this.Zn.delete())},t}(),ja=function(t){function e(e,n){var r=this;return(r=t.call(this,si.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,Br.ZT)(e,t),e}(ai);function Ua(t){return"IndexedDbTransactionError"===t.name}var Va=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Kr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),qa(n)},t.prototype.add=function(t){return Kr("SimpleDb","ADD",this.store.name,t,t),qa(this.store.add(t))},t.prototype.get=function(t){var e=this;return qa(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Kr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Kr("SimpleDb","DELETE",this.store.name,t),qa(this.store.delete(t))},t.prototype.count=function(){return Kr("SimpleDb","COUNT",this.store.name),qa(this.store.count())},t.prototype.rs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.os(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.cs=function(t,e){Kr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.us=!1;var r=this.cursor(n);return this.os(r,(function(t,e,n){return n.delete()}))},t.prototype.hs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.os(r,e)},t.prototype.ls=function(t){var e=this.cursor({});return new xa((function(n,r){e.onerror=function(t){var e=Ga(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.os=function(t,e){var n=[];return new xa((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Fa(i),s=e(i.primaryKey,i.value,o);if(s instanceof xa){var a=s.catch((function(t){return o.done(),xa.reject(t)}));n.push(a)}o.xn?r():null===o.ns?i.continue():i.continue(o.ns)}else r()}})).next((function(){return xa.Mn(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function qa(t){return new xa((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Ga(t.target.error);n(e)}}))}var Ba=!1;function Ga(t){var e=Ma.Qn((0,L.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new ai("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ba||(Ba=!0,setTimeout((function(){throw r}),0)),r}}return t}var Wa=function(){function t(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new Ra,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch((function(t){}))}return t.Ts=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Is=setTimeout((function(){return e.As()}),t)},t.prototype.Rs=function(){return this.As()},t.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new ai(si.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.As=function(){var t=this;this._s.Ps((function(){return null!==t.Is?(t.clearTimeout(),t.op().then((function(e){return t.Es.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},t}();function Ha(t,e){if(Jr("AsyncQueue",e+": "+t),Ua(t))return new ai(si.UNAVAILABLE,e+": "+t);throw t}var za="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ka=function(){function t(){this.ys=[]}return t.prototype.gs=function(t){this.ys.push(t)},t.prototype.Vs=function(){this.ys.forEach((function(t){return t()}))},t}();function Ja(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ya(e)),e=Qa(t.get(n),e);return Ya(e)}function Qa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ya(t){return t+""}function Xa(t){var e=t.length;if(Zr(e>=2),2===e)return Zr(""===t.charAt(0)&&""===t.charAt(1)),bi.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Xr(),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Xr()}o=s+2}return new bi(r)}var Za=function(t,e){this.seconds=t,this.nanoseconds=e},$a=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};$a.store="owner",$a.key="owner";var tu=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};tu.store="mutationQueues",tu.keyPath="userId";var eu=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};eu.store="mutations",eu.keyPath="batchId",eu.userMutationsIndex="userMutationsIndex",eu.userMutationsKeyPath=["userId","batchId"];var nu=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ja(e)]},t.key=function(t,e,n){return[t,Ja(e),n]},t}();nu.store="documentMutations",nu.PLACEHOLDER=new nu;var ru=function(t,e){this.path=t,this.readTime=e},iu=function(t,e){this.path=t,this.version=e},ou=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ou.store="remoteDocuments",ou.readTimeIndex="readTimeIndex",ou.readTimeIndexPath="readTime",ou.collectionReadTimeIndex="collectionReadTimeIndex",ou.collectionReadTimeIndexPath=["parentPath","readTime"];var su=function(t){this.byteSize=t};su.store="remoteDocumentGlobal",su.key="remoteDocumentGlobalKey";var au=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};au.store="targets",au.keyPath="targetId",au.queryTargetsIndexName="queryTargetsIndex",au.queryTargetsKeyPath=["canonicalId","targetId"];var uu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};uu.store="targetDocuments",uu.keyPath=["targetId","path"],uu.documentTargetsIndex="documentTargetsIndex",uu.documentTargetsKeyPath=["path","targetId"];var cu=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};cu.key="targetGlobalKey",cu.store="targetGlobal";var hu=function(t,e){this.collectionId=t,this.parent=e};hu.store="collectionParents",hu.keyPath=["collectionId","parent"];var lu=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};lu.store="clientMetadata",lu.keyPath="clientId";var fu=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};fu.store="bundles",fu.keyPath="bundleId";var pu=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};pu.store="namedQueries",pu.keyPath="name";var du=(0,Br.pr)((0,Br.pr)((0,Br.pr)((0,Br.pr)([tu.store,eu.store,nu.store,ou.store,au.store,$a.store,cu.store,uu.store],[lu.store]),[su.store]),[hu.store]),[fu.store,pu.store]),vu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ps=e,r.bs=n,r}return(0,Br.ZT)(e,t),e}(Ka);function yu(t,e){var n=$r(t);return Ma.zn(n.ps,e)}var gu=function(){function t(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}return t.prototype.Ss=function(t,e,n){for(var r=n.Ds,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=us(o,e,r[i]))}return e},t.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(s=r[n]).key.isEqual(t)&&(e=cs(s,e,this.vs));for(var i=0,o=this.mutations;i<o.length;i++){var s;(s=o[i]).key.isEqual(t)&&(e=cs(s,e,this.vs))}return e},t.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Us())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ri(this.mutations,t.mutations,(function(t,e){return ls(t,e)}))&&ri(this.baseMutations,t.baseMutations,(function(t,e){return ls(t,e)}))},t}(),mu=function(){function t(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}return t.from=function(e,n,r){Zr(e.mutations.length===r.length);for(var i=Fs(),o=e.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),bu=function(t){this.Fs=t};function _u(t,e){if(e.document)return ya(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ei.Et(e.noDocument.path),r=Su(e.noDocument.readTime);return new eo(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Ei.Et(e.unknownDocument.path);return r=Su(e.unknownDocument.version),new no(i,r)}return Xr()}function wu(t,e,n){var r=Eu(n),i=e.key.path.X().it();if(e instanceof to){var o=function(t,e){return{name:ca(t,e.key),fields:e.bt().mapValue.fields,updateTime:ra(t,e.version.j())}}(t.Fs,e),s=e.hasCommittedMutations;return new ou(null,null,o,s,r,i)}if(e instanceof eo){var a=e.key.path.it(),u=Tu(e.version);return s=e.hasCommittedMutations,new ou(null,new ru(a,u),null,s,r,i)}if(e instanceof no){var c=e.key.path.it(),h=Tu(e.version);return new ou(new iu(c,h),null,null,!0,r,i)}return Xr()}function Eu(t){var e=t.j();return[e.seconds,e.nanoseconds]}function Iu(t){var e=new yi(t[0],t[1]);return gi.K(e)}function Tu(t){var e=t.j();return new Za(e.seconds,e.nanoseconds)}function Su(t){var e=new yi(t.seconds,t.nanoseconds);return gi.K(e)}function Cu(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ma(t.Fs,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var s=e.mutations.map((function(e){return ma(t.Fs,e)})),a=yi.fromMillis(e.localWriteTimeMs);return new gu(e.batchId,a,n,s)}function Au(t){var e,n,r=Su(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Su(t.lastLimboFreeSnapshotVersion):gi.min();return void 0!==t.query.documents?(Zr(1===(n=t.query).documents.length),e=Ro(Co(fa(n.documents[0])))):e=function(t){return Ro(wa(t))}(t.query),new qo(e,t.targetId,0,t.lastListenSequenceNumber,r,i,oi.fromBase64String(t.resumeToken))}function Nu(t,e){var n,r=Tu(e.Ot),i=Tu(e.lastLimboFreeSnapshotVersion);n=ao(e.target)?ba(t.Fs,e.target):_a(t.Fs,e.target);var o=e.resumeToken.toBase64();return new au(e.targetId,oo(e.target),r,o,e.sequenceNumber,i,n)}function ku(t){var e=wa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?xo(e,e.limit,"L"):e}var Pu=function(){function t(){}return t.prototype.Os=function(t,e){return Du(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Su(e.createTime),version:e.version};var e}))},t.prototype.ks=function(t,e){return Du(t).put({bundleId:(n=e).id,createTime:Tu(sa(n.createTime)),version:n.version});var n},t.prototype.Ms=function(t,e){return Ou(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:ku(e.bundledQuery),readTime:Su(e.readTime)};var e}))},t.prototype.Ls=function(t,e){return Ou(t).put(function(t){return{name:t.name,readTime:Tu(sa(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Du(t){return yu(t,fu.store)}function Ou(t){return yu(t,pu.store)}var Ru=function(){function t(){this.Bs=new xu}return t.prototype.qs=function(t,e){return this.Bs.add(e),xa.resolve()},t.prototype.Us=function(t,e){return xa.resolve(this.Bs.getEntries(e))},t}(),xu=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new ks(bi.H),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.tt(),n=t.X(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new ks(bi.H)).it()},t}(),Lu=function(){function t(){this.Qs=new xu}return t.prototype.qs=function(t,e){var n=this;if(!this.Qs.has(e)){var r=e.tt(),i=e.X();t.gs((function(){n.Qs.add(e)}));var o={collectionId:r,parent:Ja(i)};return Mu(t).put(o)}return xa.resolve()},t.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ii(e),""],!1,!0);return Mu(t).rs(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Xa(o.parent))}return n}))},t}();function Mu(t){return yu(t,hu.store)}var Fu={Ks:!1,Ws:0,js:0,Gs:0},ju=function(){function t(t,e,n){this.zs=t,this.Hs=e,this.Js=n}return t.Ys=function(e){return new t(e,t.Xs,t.Zs)},t}();function Uu(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){if(t.code!==si.FAILED_PRECONDITION||t.message!==za)throw t;return Kr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}ju.Xs=10,ju.Zs=1e3,ju.ti=new ju(41943040,ju.Xs,ju.Zs),ju.ei=new ju(-1,0,0);var Vu=function(){function t(t,e){this.ni=t,this.si=e,this.ii={}}return t.prototype.get=function(t){var e=this.ni(t),n=this.ii[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.si(s,t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Ti(this.ii,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.et=function(){return Si(this.ii)},t}(),qu=function(){function t(){this.ri=new Vu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.oi=!1}return t.prototype.ci=function(t){var e=this.ri.get(t);return e?e.readTime:gi.min()},t.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},t.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},t.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?xa.resolve(n.hi):this.fi(t,e)},t.prototype.getEntries=function(t,e){return this.di(t,e)},t.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},t.prototype.ui=function(){},t}();function Bu(t,e,n){var r=t.store(eu.store),i=t.store(nu.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.hs({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Zr(1===a)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=nu.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return xa.Mn(o).next((function(){return c}))}function Gu(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Xr();e=t.noDocument}return JSON.stringify(e).length}var Wu=function(){function t(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}return t.mi=function(e,n,r,i){return Zr(""!==e.uid),new t(e.m()?e.uid:"",n,r,i)},t.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zu(t).hs({index:eu.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ri=function(t,e,n,r){var i=this,o=Ku(t),s=zu(t);return s.add({}).next((function(a){Zr("number"==typeof a);for(var u=new gu(a,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return ga(t.Fs,e)})),i=n.mutations.map((function(e){return ga(t.Fs,e)}));return new eu(e,n.batchId,n.vs.toMillis(),r,i)}(i.Qt,i.userId,u),h=[],l=new ks((function(t,e){return ni(t.rt(),e.rt())})),f=0,p=r;f<p.length;f++){var d=p[f],v=nu.key(i.userId,d.key.path,a);l=l.add(d.key.path.X()),h.push(s.put(c)),h.push(o.put(v,nu.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ei.qs(t,e))})),t.gs((function(){i.Ii[a]=u.keys()})),xa.Mn(h).next((function(){return u}))}))},t.prototype.Pi=function(t,e){var n=this;return zu(t).get(e).next((function(t){return t?(Zr(t.userId===n.userId),Cu(n.Qt,t)):null}))},t.prototype.yi=function(t,e){var n=this;return this.Ii[e]?xa.resolve(this.Ii[e]):this.Pi(t,e).next((function(t){if(t){var r=t.keys();return n.Ii[e]=r,r}return null}))},t.prototype.gi=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return zu(t).hs({index:eu.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Zr(e.batchId>=r),o=Cu(n.Qt,e)),i.done()})).next((function(){return o}))},t.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return zu(t).hs({index:eu.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zu(t).rs(eu.userMutationsIndex,n).next((function(t){return t.map((function(t){return Cu(e.Qt,t)}))}))},t.prototype.bi=function(t,e){var n=this,r=nu.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ku(t).hs({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=Xa(u);if(a===n.userId&&e.path.isEqual(h))return zu(t).get(c).next((function(t){if(!t)throw Xr();Zr(t.userId===n.userId),o.push(Cu(n.Qt,t))}));s.done()})).next((function(){return o}))},t.prototype.vi=function(t,e){var n=this,r=new ks(ni),i=[];return e.forEach((function(e){var o=nu.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Ku(t).hs({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=Xa(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),xa.Mn(i).next((function(){return n.Si(t,r)}))},t.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=nu.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new ks(ni);return Ku(t).hs({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=Xa(u);s===n.userId&&r.nt(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n.Si(t,a)}))},t.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(zu(t).get(e).next((function(t){if(null===t)throw Xr();Zr(t.userId===n.userId),r.push(Cu(n.Qt,t))})))})),xa.Mn(i).next((function(){return r}))},t.prototype.Ci=function(t,e){var n=this;return Bu(t.ps,this.userId,e).next((function(r){return t.gs((function(){n.xi(e.batchId)})),xa.forEach(r,(function(e){return n.Ti.Ni(t,e)}))}))},t.prototype.xi=function(t){delete this.Ii[t]},t.prototype.$i=function(t){var e=this;return this.Ai(t).next((function(n){if(!n)return xa.resolve();var r=IDBKeyRange.lowerBound(nu.prefixForUser(e.userId)),i=[];return Ku(t).hs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Xa(t[1]);i.push(o)}else r.done()})).next((function(){Zr(0===i.length)}))}))},t.prototype.Fi=function(t,e){return Hu(t,this.userId,e)},t.prototype.Oi=function(t){var e=this;return Ju(t).get(this.userId).next((function(t){return t||new tu(e.userId,-1,"")}))},t}();function Hu(t,e,n){var r=nu.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ku(t).hs({range:o,us:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function zu(t){return yu(t,eu.store)}function Ku(t){return yu(t,nu.store)}function Ju(t){return yu(t,tu.store)}var Qu=function(){function t(t){this.ki=t}return t.prototype.next=function(){return this.ki+=2,this.ki},t.Mi=function(){return new t(0)},t.Li=function(){return new t(-1)},t}(),Yu=function(){function t(t,e){this.Ti=t,this.Qt=e}return t.prototype.Bi=function(t){var e=this;return this.qi(t).next((function(n){var r=new Qu(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.Qi=function(t){return this.qi(t).next((function(t){return gi.K(new yi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ki=function(t){return this.qi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)}))},t.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next((function(){return n.qi(t).next((function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)}))}))},t.prototype.Hi=function(t,e){return this.Gi(t,e)},t.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next((function(){return Xu(t).delete(e.targetId)})).next((function(){return n.qi(t)})).next((function(e){return Zr(e.targetCount>0),e.targetCount-=1,n.Ui(t,e)}))},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return Xu(t).hs((function(s,a){var u=Au(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Ji(t,u)))})).next((function(){return xa.Mn(o)})).next((function(){return i}))},t.prototype.In=function(t,e){return Xu(t).hs((function(t,n){var r=Au(n);e(r)}))},t.prototype.qi=function(t){return Zu(t).get(cu.key).next((function(t){return Zr(null!==t),t}))},t.prototype.Ui=function(t,e){return Zu(t).put(cu.key,e)},t.prototype.Gi=function(t,e){return Xu(t).put(Nu(this.Qt,e))},t.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Zi=function(t){return this.qi(t).next((function(t){return t.targetCount}))},t.prototype.tr=function(t,e){var n=oo(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Xu(t).hs({range:r,index:au.queryTargetsIndexName},(function(t,n,r){var o=Au(n);so(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.er=function(t,e,n){var r=this,i=[],o=$u(t);return e.forEach((function(e){var s=Ja(e.path);i.push(o.put(new uu(n,s))),i.push(r.Ti.nr(t,n,e))})),xa.Mn(i)},t.prototype.sr=function(t,e,n){var r=this,i=$u(t);return xa.forEach(e,(function(e){var o=Ja(e.path);return xa.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])}))},t.prototype.Yi=function(t,e){var n=$u(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.rr=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=$u(t),i=Us();return r.hs({range:n,us:!0},(function(t,e,n){var r=Xa(t[1]),o=new Ei(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Fi=function(t,e){var n=Ja(e.path),r=IDBKeyRange.bound([n],[ii(n)],!1,!0),i=0;return $u(t).hs({index:uu.documentTargetsIndex,us:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Sn=function(t,e){return Xu(t).get(e).next((function(t){return t?Au(t):null}))},t}();function Xu(t){return yu(t,au.store)}function Zu(t){return yu(t,cu.store)}function $u(t){return yu(t,uu.store)}function tc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ni(n,i);return 0===s?ni(r,o):s}var ec=function(){function t(t){this.cr=t,this.buffer=new ks(tc),this.ar=0}return t.prototype.ur=function(){return++this.ar},t.prototype.hr=function(t){var e=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();tc(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),nc=function(){function t(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}return t.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},t.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(t.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),t.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;Kr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,(function(){return(0,Br.mG)(e,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return Ua(e=n.sent())?(Kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Uu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),rc=function(){function t(t,e){this.mr=t,this.params=e}return t.prototype.Ar=function(t,e){return this.mr.Rr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Pr=function(t,e){var n=this;if(0===e)return xa.resolve(vi.q);var r=new ec(e);return this.mr.In(t,(function(t){return r.hr(t.sequenceNumber)})).next((function(){return n.mr.yr(t,(function(t){return r.hr(t)}))})).next((function(){return r.maxValue}))},t.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},t.prototype.gr=function(t,e){return this.mr.gr(t,e)},t.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(Kr("LruGarbageCollector","Garbage collection skipped; disabled"),xa.resolve(Fu)):this.pr(t).next((function(r){return r<n.params.zs?(Kr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),Fu):n.br(t,e)}))},t.prototype.pr=function(t){return this.mr.pr(t)},t.prototype.br=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.Ar(t,this.params.Hs).next((function(e){return e>c.params.Js?(Kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Js+" from "+e),r=c.params.Js):r=e,o=Date.now(),c.Pr(t,r)})).next((function(r){return n=r,s=Date.now(),c.Xi(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.gr(t,n)})).next((function(t){return u=Date.now(),zr()<=x.in.DEBUG&&Kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),xa.resolve({Ks:!0,Ws:r,js:i,Gs:t})}))},t}(),ic=function(){function t(t,e){this.db=t,this.lr=function(t,e){return new rc(t,e)}(this,e)}return t.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.vr=function(t){var e=0;return this.yr(t,(function(t){e++})).next((function(){return e}))},t.prototype.In=function(t,e){return this.db.Sr().In(t,e)},t.prototype.yr=function(t,e){return this.Dr(t,(function(t,n){return e(n)}))},t.prototype.nr=function(t,e,n){return oc(t,n)},t.prototype.ir=function(t,e,n){return oc(t,n)},t.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},t.prototype.Ni=function(t,e){return oc(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return Ju(t).ls((function(r){return Hu(t,r,e).next((function(t){return t&&(n=!0),xa.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,(function(s,a){if(a<=e){var u=n.Cr(t,s).next((function(e){if(!e)return o++,r._i(t,s).next((function(){return r.li(s),$u(t).delete([0,Ja(s.path)])}))}));i.push(u)}})).next((function(){return xa.Mn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.kt(t.bs);return this.db.Sr().Hi(t,n)},t.prototype.Fr=function(t,e){return oc(t,e)},t.prototype.Dr=function(t,e){var n,r=$u(t),i=vi.q;return r.hs({index:uu.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==vi.q&&e(new Ei(Xa(n)),i),i=a,n=s):i=vi.q})).next((function(){i!==vi.q&&e(new Ei(Xa(n)),i)}))},t.prototype.pr=function(t){return this.db.$r().Or(t)},t}();function oc(t,e){return $u(t).put(function(t,e){return new uu(0,Ja(t.path),e)}(e,t.bs))}var sc=function(){function t(t,e){this.Qt=t,this.Ei=e}return t.prototype.ai=function(t,e,n){return cc(t).put(hc(e),n)},t.prototype.li=function(t,e){var n=cc(t),r=hc(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.kr(t,r)}))},t.prototype._i=function(t,e){var n=this;return cc(t).get(hc(e)).next((function(t){return n.Mr(t)}))},t.prototype.Lr=function(t,e){var n=this;return cc(t).get(hc(e)).next((function(t){var e=n.Mr(t);return e?{hi:e,size:Gu(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Rs();return this.Br(t,e,(function(t,e){var i=n.Mr(e);r=r.zt(t,i)})).next((function(){return r}))},t.prototype.qr=function(t,e){var n=this,r=Rs(),i=new Cs(Ei.H);return this.Br(t,e,(function(t,e){var o=n.Mr(e);o?(r=r.zt(t,o),i=i.zt(t,Gu(e))):(r=r.zt(t,null),i=i.zt(t,0))})).next((function(){return{Ur:r,Qr:i}}))},t.prototype.Br=function(t,e,n){if(e.et())return xa.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return cc(t).hs({range:r},(function(t,e,r){for(var s=Ei.Et(t);o&&Ei.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()})).next((function(){for(;o;)n(o,null),o=i.ce()?i.oe():null}))},t.prototype.Kr=function(t,e,n){var r=this,i=Ls(),o=e.path.length+1,s={};if(n.isEqual(gi.min())){var a=e.path.it();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.it(),c=Eu(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=ou.collectionReadTimeIndex}return cc(t).hs(s,(function(t,n,s){if(t.length===o){var a=_u(r.Qt,n);e.path.nt(a.key.path)?a instanceof to&&jo(e,a)&&(i=i.zt(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.Nr=function(t){return new ac(this,!!t&&t.Wr)},t.prototype.Or=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return uc(t).get(su.key).next((function(t){return Zr(!!t),t}))},t.prototype.kr=function(t,e){return uc(t).put(su.key,e)},t.prototype.Mr=function(t){if(t){var e=_u(this.Qt,t);return e instanceof eo&&e.version.isEqual(gi.min())?null:e}return null},t}(),ac=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jr=e,r.Wr=n,r.Gr=new Vu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,Br.ZT)(e,t),e.prototype.wi=function(t){var e=this,n=[],r=0,i=new ks((function(t,e){return ni(t.rt(),e.rt())}));return this.ri.forEach((function(o,s){var a=e.Gr.get(o);if(s.hi){var u=wu(e.jr.Qt,s.hi,e.ci(o));i=i.add(o.path.X());var c=Gu(u);r+=c-a,n.push(e.jr.ai(t,o,u))}else if(r-=a,e.Wr){var h=wu(e.jr.Qt,new eo(o,gi.min()),e.ci(o));n.push(e.jr.ai(t,o,h))}else n.push(e.jr.li(t,o))})),i.forEach((function(r){n.push(e.jr.Ei.qs(t,r))})),n.push(this.jr.updateMetadata(t,r)),xa.Mn(n)},e.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next((function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)}))},e.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next((function(t){var e=t.Ur;return t.Qr.forEach((function(t,e){n.Gr.set(t,e)})),e}))},e}(qu);function uc(t){return yu(t,su.store)}function cc(t){return yu(t,ou.store)}function hc(t){return t.path.it()}var lc=function(){function t(t){this.Qt=t}return t.prototype.Jn=function(t,e,n,r){var i=this;Zr(n<r&&n>=0&&r<=11);var o=new La("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore($a.store)}(t),function(t){t.createObjectStore(tu.store,{keyPath:tu.keyPath}),t.createObjectStore(eu.store,{keyPath:eu.keyPath,autoIncrement:!0}).createIndex(eu.userMutationsIndex,eu.userMutationsKeyPath,{unique:!0}),t.createObjectStore(nu.store)}(t),fc(t),function(t){t.createObjectStore(ou.store)}(t));var s=xa.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(uu.store),t.deleteObjectStore(au.store),t.deleteObjectStore(cu.store)}(t),fc(t)),s=s.next((function(){return function(t){var e=t.store(cu.store),n=new cu(0,0,gi.min().j(),0);return e.put(cu.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(eu.store).rs().next((function(n){t.deleteObjectStore(eu.store),t.createObjectStore(eu.store,{keyPath:eu.keyPath,autoIncrement:!0}).createIndex(eu.userMutationsIndex,eu.userMutationsKeyPath,{unique:!0});var r=e.store(eu.store),i=n.map((function(t){return r.put(t)}));return xa.Mn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(lu.store,{keyPath:lu.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.zr(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(su.store)}(t),i.Hr(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.Jr(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.Yr(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ou.store);e.createIndex(ou.readTimeIndex,ou.readTimeIndexPath,{unique:!1}),e.createIndex(ou.collectionReadTimeIndex,ou.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.Xr(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(fu.store,{keyPath:fu.keyPath})}(t),function(t){t.createObjectStore(pu.store,{keyPath:pu.keyPath})}(t)}))),s},t.prototype.Hr=function(t){var e=0;return t.store(ou.store).hs((function(t,n){e+=Gu(n)})).next((function(){var n=new su(e);return t.store(su.store).put(su.key,n)}))},t.prototype.zr=function(t){var e=this,n=t.store(tu.store),r=t.store(eu.store);return n.rs().next((function(n){return xa.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(eu.userMutationsIndex,i).next((function(r){return xa.forEach(r,(function(r){Zr(r.userId===n.userId);var i=Cu(e.Qt,r);return Bu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.Jr=function(t){var e=t.store(uu.store),n=t.store(ou.store);return t.store(cu.store).get(cu.key).next((function(t){var r=[];return n.hs((function(n,i){var o=new bi(n),s=function(t){return[0,Ja(t)]}(o);r.push(e.get(s).next((function(n){return n?xa.resolve():function(n){return e.put(new uu(0,Ja(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return xa.Mn(r)}))}))},t.prototype.Yr=function(t,e){t.createObjectStore(hu.store,{keyPath:hu.keyPath});var n=e.store(hu.store),r=new xu,i=function(t){if(r.add(t)){var e=t.tt(),i=t.X();return n.put({collectionId:e,parent:Ja(i)})}};return e.store(ou.store).hs({us:!0},(function(t,e){var n=new bi(t);return i(n.X())})).next((function(){return e.store(nu.store).hs({us:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Xa(n));return i(r.X())}))}))},t.prototype.Xr=function(t){var e=this,n=t.store(au.store);return n.hs((function(t,r){var i=Au(r),o=Nu(e.Qt,i);return n.put(o)}))},t}();function fc(t){t.createObjectStore(uu.store,{keyPath:uu.keyPath}).createIndex(uu.documentTargetsIndex,uu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(au.store,{keyPath:au.keyPath}).createIndex(au.queryTargetsIndexName,au.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(cu.store)}var pc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",dc=function(){function t(e,n,r,i,o,s,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=a,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!t.Kn())throw new ai(si.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new ic(this,i),this.ho=n+"main",this.Qt=new bu(u),this.lo=new Ma(this.ho,11,new lc(this.Qt)),this._o=new Yu(this.Ti,this.Qt),this.Ei=new Lu,this.fo=function(t,e){return new sc(t,e)}(this.Qt,this.Ei),this.wo=new Pu,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===h&&Jr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.To().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new ai(si.FAILED_PRECONDITION,pc);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t._o.Ki(e)}))})).then((function(e){t.so=new vi(e,t.eo)})).then((function(){t.io=!0})).catch((function(e){return t.lo&&t.lo.close(),Promise.reject(e)}))},t.prototype.Ro=function(t){var e=this;return this.uo=function(n){return(0,Br.mG)(e,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return this.Er?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Po=function(t){var e=this;this.lo.Xn((function(n){return(0,Br.mG)(e,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps((function(){return(0,Br.mG)(e,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return yc(e).put(new lu(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Vo(e).next((function(e){e||(t.isPrimary=!1,t.Zr.po((function(){return t.uo(!1)})))}))})).next((function(){return t.bo(e)})).next((function(n){return t.isPrimary&&!n?t.vo(e).next((function(){return!1})):!!n&&t.So(e).next((function(){return!0}))}))})).catch((function(e){if(Ua(e))return Kr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Zr.po((function(){return t.uo(e)})),t.isPrimary=e}))},t.prototype.Vo=function(t){var e=this;return vc(t).get($a.key).next((function(t){return xa.resolve(e.Do(t))}))},t.prototype.Co=function(t){return yc(t).delete(this.clientId)},t.prototype.xo=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=yu(t,lu.store);return e.rs().next((function(t){var n=i.$o(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return xa.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,(function(){return t.To().then((function(){return t.xo()})).then((function(){return t.Ao()}))}))},t.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.bo=function(t){var e=this;return this.no?xa.resolve(!0):vc(t).get($a.key).next((function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new ai(si.FAILED_PRECONDITION,pc);return!1}}return!(!e.networkEnabled||!e.inForeground)||yc(t).rs().next((function(t){return void 0===e.$o(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.ko=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t=this;return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[$a.store,lu.store],(function(e){var n=new vu(e,vi.q);return t.vo(n).next((function(){return t.Co(n)}))}))];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}}))}))},t.prototype.$o=function(t,e){var n=this;return t.filter((function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)}))},t.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return yc(e).rs().next((function(e){return t.$o(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Qo=function(t){return Wu.mi(t,this.Qt,this.Ei,this.Ti)},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Ko=function(){return this.Ei},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;Kr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,du,(function(o){return i=new vu(o,r.so?r.so.next():vi.q),"readwrite-primary"===e?r.Vo(i).next((function(t){return!!t||r.bo(i)})).next((function(e){if(!e)throw Jr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po((function(){return r.uo(!1)})),new ai(si.FAILED_PRECONDITION,za);return n(i)})).next((function(t){return r.So(i).next((function(){return t}))})):r.jo(i).next((function(){return n(i)}))})).then((function(t){return i.Vs(),t}))},t.prototype.jo=function(t){var e=this;return vc(t).get($a.key).next((function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new ai(si.FAILED_PRECONDITION,pc)}))},t.prototype.So=function(t){var e=new $a(this.clientId,this.allowTabSynchronization,Date.now());return vc(t).put($a.key,e)},t.Kn=function(){return Ma.Kn()},t.prototype.vo=function(t){var e=this,n=vc(t);return n.get($a.key).next((function(t){return e.Do(t)?(Kr("IndexedDbPersistence","Releasing primary lease."),n.delete($a.key)):xa.resolve()}))},t.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Jr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps((function(){return t.inForeground="visible"===t.document.visibilityState,t.To()}))},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},t.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps((function(){return e.ko()}))},this.window.addEventListener("unload",this.ro))},t.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},t.prototype.Oo=function(t){var e;try{var n=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return Kr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Jr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){Jr("Failed to set zombie client id.",t)}},t.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},t.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function vc(t){return yu(t,$a.store)}function yc(t){return yu(t,lu.store)}function gc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var mc=function(t,e){this.progress=t,this.Go=e},bc=function(){function t(t,e,n){this.fo=t,this.zo=e,this.Ei=n}return t.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next((function(r){return n.Jo(t,e,r)}))},t.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t}))},t.prototype.Yo=function(t,e,n){var r=Rs();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)})),r},t.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next((function(e){return n.Zo(t,e)}))},t.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next((function(r){var i=n.Yo(t,e,r),o=Os();return i.forEach((function(t,e){e||(e=new eo(t,gi.min())),o=o.zt(t,e)})),o}))},t.prototype.Kr=function(t,e,n){return function(t){return Ei.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.tc(t,e.path):Do(e)?this.ec(t,e,n):this.nc(t,e,n)},t.prototype.tc=function(t,e){return this.Ho(t,new Ei(e)).next((function(t){var e=Ls();return t instanceof to&&(e=e.zt(t.key,t)),e}))},t.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=Ls();return this.Ei.Us(t,i).next((function(s){return xa.forEach(s,(function(s){var a=function(t,e){return new To(e,null,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.nc(t,a,n).next((function(t){t.forEach((function(t,e){o=o.zt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next((function(n){return r=n,o.zo.Di(t,e)})).next((function(e){return i=e,o.sc(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=cs(u,r.get(c),o.vs);r=h instanceof to?r.zt(c,h):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){jo(e,n)||(r=r.remove(t))})),r}))},t.prototype.sc=function(t,e,n){for(var r=Us(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ds&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.fo.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof to&&(c=c.zt(t,e))})),c}))},t}(),_c=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}return t.oc=function(e,n){for(var r=Us(),i=Us(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),wc=function(){function t(){}return t.prototype.cc=function(t){this.ac=t},t.prototype.Kr=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.xt.length||1===t.xt.length&&t.xt[0].field.ut())}(e)||n.isEqual(gi.min())?this.uc(t,e):this.ac.Xo(t,r).next((function(o){var s=i.hc(e,o);return(Ao(e)||No(e))&&i.lc(e.limitType,s,r,n)?i.uc(t,e):(zr()<=x.in.DEBUG&&Kr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Fo(e)),i.ac.Kr(t,e,n).next((function(t){return s.forEach((function(e){t=t.zt(e.key,e)})),t})))}))},t.prototype.hc=function(t,e){var n=new ks(Uo(t));return e.forEach((function(e,r){r instanceof to&&jo(t,r)&&(n=n.add(r))})),n},t.prototype.lc=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version._(r)>0)},t.prototype.uc=function(t,e){return zr()<=x.in.DEBUG&&Kr("QueryEngine","Using full collection scan to execute query:",Fo(e)),this.ac.Kr(t,e,gi.min())},t}(),Ec=function(){function t(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Cs(ni),this.dc=new Vu((function(t){return oo(t)}),so),this.wc=gi.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new bc(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return t.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Vr(n,e.fc)}))},t}();function Ic(t,e,n,r){return new Ec(t,e,n,r)}function Tc(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return n=$r(t),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.zo.pi(t).next((function(s){return o=s,r=n.persistence.Qo(e),i=new bc(n.Ec,r,n.persistence.Ko()),r.pi(t)})).next((function(e){for(var n=[],r=[],s=Us(),a=0,u=o;a<u.length;a++){var c=u[a];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return i.Xo(t,s).next((function(t){return{Ic:t,mc:n,Ac:r}}))}))}))];case 1:return o=s.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}}))}))}function Sc(t,e){var n=$r(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Ec.Nr({Wr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=xa.resolve();return o.forEach((function(t){s=s.next((function(){return r._i(e,t)})).next((function(e){var o=e,s=n.$s.get(t);Zr(null!==s),(!o||o.version._(s)<0)&&(o=i.Ss(t,o,n))&&r.ai(o,n.Ns)}))})),s.next((function(){return t.zo.Ci(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}function Cc(t){var e=$r(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e._o.Qi(t)}))}function Ac(t,e){var n=$r(t),r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.$e.forEach((function(e,o){var a=i.get(o);if(a){s.push(n._o.sr(t,e.Qe,o).next((function(){return n._o.er(t,e.qe,o)})));var u=e.resumeToken;if(u.l()>0){var c=a.Mt(u,r).kt(t.bs);i=i.zt(o,c),function(t,e,n){return Zr(e.resumeToken.l()>0),0===t.resumeToken.l()||e.Ot.W()-t.Ot.W()>=3e8||n.qe.size+n.Ue.size+n.Qe.size>0}(a,c,e)&&s.push(n._o.Hi(t,c))}}}));var a=Os();if(e.Oe.forEach((function(r,i){e.ke.has(r)&&s.push(n.persistence.Ti.Fr(t,r))})),s.push(Nc(t,o,e.Oe,r,void 0).next((function(t){a=t}))),!r.isEqual(gi.min())){var u=n._o.Qi(t).next((function(e){return n._o.Wi(t,t.bs,r)}));s.push(u)}return xa.Mn(s).next((function(){return o.apply(t)})).next((function(){return n.Tc.Zo(t,a)}))})).then((function(t){return n.fc=i,t}))}function Nc(t,e,n,r,i){var o=Us();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Os();return n.forEach((function(n,s){var a=t.get(n),u=(null==i?void 0:i.get(n))||r;s instanceof eo&&s.version.isEqual(gi.min())?(e.li(n,u),o=o.zt(n,s)):null==a||s.version._(a.version)>0||0===s.version._(a.version)&&a.hasPendingWrites?(e.ai(s,u),o=o.zt(n,s)):Kr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),o}))}function kc(t,e){var n=$r(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.zo.gi(t,e)}))}function Pc(t,e){var n=$r(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n._o.tr(t,e).next((function(i){return i?(r=i,xa.resolve(r)):n._o.Bi(t).next((function(i){return r=new qo(e,i,0,t.bs),n._o.ji(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.fc.get(t.targetId);return(null===r||t.Ot._(r.Ot)>0)&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t}))}function Dc(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:r=$r(t),i=r.fc.get(e),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Ti.removeTarget(t,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!Ua(s=a.sent()))throw s;return Kr("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}}))}))}function Oc(t,e,n){var r=$r(t),i=gi.min(),o=Us();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=$r(t),i=r.dc.get(n);return void 0!==i?xa.resolve(r.fc.get(i)):r._o.tr(e,n)}(r,t,Ro(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next((function(t){o=t}))})).next((function(){return r._c.Kr(t,e,n?i:gi.min(),n?o:Us())})).next((function(t){return{documents:t,Rc:o}}))}))}function Rc(t,e){var n=$r(t),r=$r(n._o),i=n.fc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Sn(t,e).next((function(t){return t?t.target:null}))}))}function xc(t){var e=$r(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=$r(t),i=Os(),o=Eu(n),s=cc(e),a=IDBKeyRange.lowerBound(o,!0);return s.hs({index:ou.readTimeIndex,range:a},(function(t,e){var n=_u(r.Qt,e);i=i.zt(n.key,n),o=e.readTime})).next((function(){return{Go:i,readTime:Iu(o)}}))}(e.Ec,t,e.wc)})).then((function(t){var n=t.Go,r=t.readTime;return e.wc=r,n}))}function Lc(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){return[2,(e=$r(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=cc(t),n=gi.min();return e.hs({index:ou.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Iu(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.wc=t}))]}))}))}function Mc(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s,a,u,c,h,l,f,p;return(0,Br.Jh)(this,(function(d){switch(d.label){case 0:for(i=$r(t),o=Us(),s=Os(),a=Fs(),u=0,c=n;u<c.length;u++)h=c[u],l=e.Pc(h.metadata.name),h.document&&(o=o.add(l)),s=s.zt(l,e.yc(h)),a=a.zt(l,e.gc(h.metadata.readTime));return f=i.Ec.Nr({Wr:!0}),[4,Pc(i,function(t){return Ro(Co(bi.ot("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Nc(t,f,s,gi.min(),a).next((function(e){return f.apply(t),e})).next((function(e){return i._o.Yi(t,p.targetId).next((function(){return i._o.er(t,o,p.targetId)})).next((function(){return i.Tc.Zo(t,e)}))}))}))]}}))}))}function Fc(t,e,n){return void 0===n&&(n=Us()),(0,Br.mG)(this,void 0,void 0,(function(){var r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return[4,Pc(t,Ro(ku(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=$r(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=sa(e.readTime);if(r.Ot._(o)>=0)return i.wo.Ls(t,e);var s=r.Mt(oi.T,o);return i.fc=i.fc.zt(s.targetId,s),i._o.Hi(t,s).next((function(){return i._o.Yi(t,r.targetId)})).next((function(){return i._o.er(t,n,r.targetId)})).next((function(){return i.wo.Ls(t,e)}))}))]}}))}))}var jc=function(){function t(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return t.prototype.Os=function(t,e){return xa.resolve(this.Vc.get(e))},t.prototype.ks=function(t,e){var n;return this.Vc.set(e.id,{id:(n=e).id,version:n.version,createTime:sa(n.createTime)}),xa.resolve()},t.prototype.Ms=function(t,e){return xa.resolve(this.bc.get(e))},t.prototype.Ls=function(t,e){return this.bc.set(e.name,function(t){return{name:t.name,query:ku(t.bundledQuery),readTime:sa(t.readTime)}}(e)),xa.resolve()},t}(),Uc=function(){function t(){this.vc=new ks(Vc.Sc),this.Dc=new ks(Vc.Cc)}return t.prototype.et=function(){return this.vc.et()},t.prototype.nr=function(t,e){var n=new Vc(t,e);this.vc=this.vc.add(n),this.Dc=this.Dc.add(n)},t.prototype.xc=function(t,e){var n=this;t.forEach((function(t){return n.nr(t,e)}))},t.prototype.ir=function(t,e){this.Nc(new Vc(t,e))},t.prototype.$c=function(t,e){var n=this;t.forEach((function(t){return n.ir(t,e)}))},t.prototype.Fc=function(t){var e=this,n=new Ei(new bi([])),r=new Vc(n,t),i=new Vc(n,t+1),o=[];return this.Dc.me([r,i],(function(t){e.Nc(t),o.push(t.key)})),o},t.prototype.Oc=function(){var t=this;this.vc.forEach((function(e){return t.Nc(e)}))},t.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},t.prototype.kc=function(t){var e=new Ei(new bi([])),n=new Vc(e,t),r=new Vc(e,t+1),i=Us();return this.Dc.me([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Fi=function(t){var e=new Vc(t,0),n=this.vc.Re(e);return null!==n&&t.isEqual(n.key)},t}(),Vc=function(){function t(t,e){this.key=t,this.Mc=e}return t.Sc=function(t,e){return Ei.H(t.key,e.key)||ni(t.Mc,e.Mc)},t.Cc=function(t,e){return ni(t.Mc,e.Mc)||Ei.H(t.key,e.key)},t}(),qc=function(){function t(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new ks(Vc.Sc)}return t.prototype.Ai=function(t){return xa.resolve(0===this.zo.length)},t.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var o=new gu(i,e,n,r);this.zo.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.Bc=this.Bc.add(new Vc(u.key,i)),this.Ei.qs(t,u.key.path.X())}return xa.resolve(o)},t.prototype.Pi=function(t,e){return xa.resolve(this.qc(e))},t.prototype.gi=function(t,e){var n=e+1,r=this.Uc(n),i=r<0?0:r;return xa.resolve(this.zo.length>i?this.zo[i]:null)},t.prototype.Vi=function(){return xa.resolve(0===this.zo.length?-1:this.Lc-1)},t.prototype.pi=function(t){return xa.resolve(this.zo.slice())},t.prototype.bi=function(t,e){var n=this,r=new Vc(e,0),i=new Vc(e,Number.POSITIVE_INFINITY),o=[];return this.Bc.me([r,i],(function(t){var e=n.qc(t.Mc);o.push(e)})),xa.resolve(o)},t.prototype.vi=function(t,e){var n=this,r=new ks(ni);return e.forEach((function(t){var e=new Vc(t,0),i=new Vc(t,Number.POSITIVE_INFINITY);n.Bc.me([e,i],(function(t){r=r.add(t.Mc)}))})),xa.resolve(this.Qc(r))},t.prototype.Di=function(t,e){var n=e.path,r=n.length+1,i=n;Ei.wt(i)||(i=i.child(""));var o=new Vc(new Ei(i),0),s=new ks(ni);return this.Bc.Ae((function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(s=s.add(t.Mc)),!0)}),o),xa.resolve(this.Qc(s))},t.prototype.Qc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.qc(t);null!==r&&n.push(r)})),n},t.prototype.Ci=function(t,e){var n=this;Zr(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return xa.forEach(e.mutations,(function(i){var o=new Vc(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)})).next((function(){n.Bc=r}))},t.prototype.xi=function(t){},t.prototype.Fi=function(t,e){var n=new Vc(e,0),r=this.Bc.Re(n);return xa.resolve(e.isEqual(r&&r.key))},t.prototype.$i=function(t){return this.zo.length,xa.resolve()},t.prototype.Kc=function(t,e){return this.Uc(t)},t.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},t.prototype.qc=function(t){var e=this.Uc(t);return e<0||e>=this.zo.length?null:this.zo[e]},t}(),Bc=function(){function t(t,e){this.Ei=t,this.Wc=e,this.docs=new Cs(Ei.H),this.size=0}return t.prototype.ai=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:s,readTime:n}),this.size+=s-o,this.Ei.qs(t,r.path.X())},t.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype._i=function(t,e){var n=this.docs.get(e);return xa.resolve(n?n.hi:null)},t.prototype.getEntries=function(t,e){var n=this,r=Rs();return e.forEach((function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)})),xa.resolve(r)},t.prototype.Kr=function(t,e,n){for(var r=Ls(),i=new Ei(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=o.oe(),a=s.key,u=s.value,c=u.hi,h=u.readTime;if(!e.path.nt(a.path))break;h._(n)<=0||c instanceof to&&jo(e,c)&&(r=r.zt(c.key,c))}return xa.resolve(r)},t.prototype.jc=function(t,e){return xa.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Nr=function(t){return new Gc(this)},t.prototype.Or=function(t){return xa.resolve(this.size)},t}(),Gc=function(t){function e(e){var n=this;return(n=t.call(this)||this).jr=e,n}return(0,Br.ZT)(e,t),e.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach((function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)})),xa.Mn(n)},e.prototype.fi=function(t,e){return this.jr._i(t,e)},e.prototype.di=function(t,e){return this.jr.getEntries(t,e)},e}(qu),Wc=function(){function t(t){this.persistence=t,this.Gc=new Vu((function(t){return oo(t)}),so),this.lastRemoteSnapshotVersion=gi.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Uc,this.targetCount=0,this.Jc=Qu.Mi()}return t.prototype.In=function(t,e){return this.Gc.forEach((function(t,n){return e(n)})),xa.resolve()},t.prototype.Qi=function(t){return xa.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ki=function(t){return xa.resolve(this.zc)},t.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),xa.resolve(this.highestTargetId)},t.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),xa.resolve()},t.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Qu(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},t.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,xa.resolve()},t.prototype.Hi=function(t,e){return this.Gi(e),xa.resolve()},t.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),this.targetCount-=1,xa.resolve()},t.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,a.targetId)),i++)})),xa.Mn(o).next((function(){return i}))},t.prototype.Zi=function(t){return xa.resolve(this.targetCount)},t.prototype.tr=function(t,e){var n=this.Gc.get(e)||null;return xa.resolve(n)},t.prototype.er=function(t,e,n){return this.Hc.xc(e,n),xa.resolve()},t.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach((function(e){i.push(r.Ni(t,e))})),xa.Mn(i)},t.prototype.Yi=function(t,e){return this.Hc.Fc(e),xa.resolve()},t.prototype.rr=function(t,e){var n=this.Hc.kc(e);return xa.resolve(n)},t.prototype.Fi=function(t,e){return xa.resolve(this.Hc.Fi(e))},t}(),Hc=function(){function t(t,e){var n=this;this.Yc={},this.so=new vi(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Wc(this),this.Ei=new Ru,this.fo=function(t,e){return new Bc(t,(function(t){return n.Ti.Xc(t)}))}(this.Ei),this.Qt=new bu(e),this.wo=new jc(this.Qt)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),t.prototype.Po=function(){},t.prototype.yo=function(){},t.prototype.Ko=function(){return this.Ei},t.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new qc(this.Ei,this.Ti),this.Yc[t.A()]=e),e},t.prototype.Sr=function(){return this._o},t.prototype.$r=function(){return this.fo},t.prototype.Wo=function(){return this.wo},t.prototype.runTransaction=function(t,e,n){var r=this;Kr("MemoryPersistence","Starting transaction:",t);var i=new zc(this.so.next());return this.Ti.Zc(),n(i).next((function(t){return r.Ti.ta(i).next((function(){return t}))})).On().then((function(t){return i.Vs(),t}))},t.prototype.ea=function(t,e){return xa.Ln(Object.values(this.Yc).map((function(n){return function(){return n.Fi(t,e)}})))},t}(),zc=function(t){function e(e){var n=this;return(n=t.call(this)||this).bs=e,n}return(0,Br.ZT)(e,t),e}(Ka),Kc=function(){function t(t){this.persistence=t,this.na=new Uc,this.sa=null}return t.ia=function(e){return new t(e)},Object.defineProperty(t.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Xr()},enumerable:!1,configurable:!0}),t.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),xa.resolve()},t.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),xa.resolve()},t.prototype.Ni=function(t,e){return this.ra.add(e.toString()),xa.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach((function(t){return n.ra.add(t.toString())}));var r=this.persistence.Sr();return r.rr(t,e.targetId).next((function(t){t.forEach((function(t){return n.ra.add(t.toString())}))})).next((function(){return r.Ji(t,e)}))},t.prototype.Zc=function(){this.sa=new Set},t.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return xa.forEach(this.ra,(function(r){var i=Ei._t(r);return e.oa(t,i).next((function(t){t||n.li(i)}))})).next((function(){return e.sa=null,n.apply(t)}))},t.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next((function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())}))},t.prototype.Xc=function(t){return 0},t.prototype.oa=function(t,e){var n=this;return xa.Ln([function(){return xa.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},t}();function Jc(t,e){return"firestore_clients_"+t+"_"+e}function Qc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.m()&&(r+="_"+e.uid),r}function Yc(t,e){return"firestore_targets_"+t+"_"+e}var Xc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ca=function(e,n,r){var i,o=JSON.parse(r),s="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return s&&o.error&&(s="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new ai(o.error.code,o.error.message)),s?new t(e,n,o.state,i):(Jr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Zc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ca=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new ai(i.error.code,i.error.message)),o?new t(e,i.state,r):(Jr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),$c=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ca=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=qs(),s=0;i&&s<r.activeTargetIds.length;++s)i=Mi(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Jr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),th=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ca=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Jr("SharedClientState","Failed to parse online state: "+e),null)},t}(),eh=function(){function t(){this.activeTargetIds=qs()}return t.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),nh=function(){function t(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Cs(ni),this.Er=!1,this.Ta=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ia=Jc(this.persistenceKey,this.la),this.ma=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new eh),this.Aa=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ya=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.ga=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return t.Kn=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,l=this;return(0,Br.Jh)(this,(function(f){switch(f.label){case 0:return[4,this._a.Uo()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(Jc(this.persistenceKey,r)))&&(o=$c.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(s=this.storage.getItem(this.ya))&&(a=this.pa(s))&&this.ba(a),u=0,c=this.Ta;u<c.length;u++)h=c[u],this.wa(h);return this.Ta=[],this.window.addEventListener("unload",(function(){return l.ko()})),this.Er=!0,[2]}}))}))},t.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},t.prototype.va=function(){return this.Sa(this.Ea)},t.prototype.Da=function(t){var e=!1;return this.Ea.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Ca=function(t){this.xa(t,"pending")},t.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},t.prototype.Fa=function(t){var e="not-current";if(this.Da(t)){var n=this.storage.getItem(Yc(this.persistenceKey,t));if(n){var r=Zc.ca(t,n);r&&(e=r.state)}}return this.Oa.ua(t),this.Va(),e},t.prototype.ka=function(t){this.Oa.ha(t),this.Va()},t.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},t.prototype.La=function(t){this.removeItem(Yc(this.persistenceKey,t))},t.prototype.Ba=function(t,e,n){this.qa(t,e,n)},t.prototype.Ua=function(t,e,n){var r=this;e.forEach((function(t){r.$a(t)})),this.currentUser=t,n.forEach((function(t){r.Ca(t)}))},t.prototype.Qa=function(t){this.Ka(t)},t.prototype.Wa=function(){this.ja()},t.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Kr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wa=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Kr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ia)return void Jr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po((function(){return(0,Br.mG)(e,void 0,void 0,(function(){var t,e,r,i,o,s;return(0,Br.Jh)(this,(function(a){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(e=this.Ha(n.key,n.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(r=this.Ja(n.key,n.newValue)))return[2,this.Ya(r)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(i=this.Xa(n.key,n.newValue)))return[2,this.Za(i)]}else if(n.key===this.ya){if(null!==n.newValue&&(o=this.pa(n.newValue)))return[2,this.ba(o)]}else if(n.key===this.ma)(s=function(t){var e=vi.q;if(null!=t)try{var n=JSON.parse(t);Zr("number"==typeof n),e=n}catch(t){Jr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==vi.q&&this.k(s);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),t.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},t.prototype.xa=function(t,e,n){var r=new Xc(this.currentUser,t,e,n),i=Qc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.aa())},t.prototype.$a=function(t){var e=Qc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ka=function(t){var e={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(e))},t.prototype.qa=function(t,e,n){var r=Yc(this.persistenceKey,t),i=new Zc(t,e,n);this.setItem(r,i.aa())},t.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},t.prototype.Ga=function(t){var e=this.Aa.exec(t);return e?e[1]:null},t.prototype.Ha=function(t,e){var n=this.Ga(t);return $c.ca(n,e)},t.prototype.Ja=function(t,e){var n=this.Ra.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Xc.ca(new ci(i),r,e)},t.prototype.Xa=function(t,e){var n=this.Pa.exec(t),r=Number(n[1]);return Zc.ca(r,e)},t.prototype.pa=function(t){return th.ca(t)},t.prototype.Ya=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(Kr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},t.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],a=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||a.push(t)})),this._a.su(s,a).then((function(){n.Ea=r}))},t.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},t.prototype.Sa=function(t){var e=qs();return t.forEach((function(t,n){e=e.Pe(n.activeTargetIds)})),e},t}(),rh=function(){function t(){this.iu=new eh,this.ru={},this.fa=null,this.k=null}return t.prototype.Ca=function(t){},t.prototype.Na=function(t,e,n){},t.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},t.prototype.Ba=function(t,e,n){this.ru[t]=e},t.prototype.ka=function(t){this.iu.ha(t)},t.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.La=function(t){delete this.ru[t]},t.prototype.va=function(){return this.iu.activeTargetIds},t.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},t.prototype.start=function(){return this.iu=new eh,Promise.resolve()},t.prototype.Ua=function(t,e,n){},t.prototype.Qa=function(t){},t.prototype.ko=function(){},t.prototype.B=function(t){},t.prototype.Wa=function(){},t}(),ih=function(){function t(){}return t.prototype.ou=function(t){},t.prototype.ko=function(){},t}(),oh=function(){function t(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return t.prototype.ou=function(t){this.lu.push(t)},t.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},t.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},t.prototype.au=function(){Kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},t.prototype.hu=function(){Kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},t.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),sh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ah=function(){function t(t){this.fu=t.fu,this.du=t.du}return t.prototype.wu=function(t){this.Eu=t},t.prototype.Tu=function(t){this.Iu=t},t.prototype.onMessage=function(t){this.mu=t},t.prototype.close=function(){this.du()},t.prototype.send=function(t){this.fu(t)},t.prototype.Au=function(){this.Eu()},t.prototype.Ru=function(t){this.Iu(t)},t.prototype.Pu=function(t){this.mu(t)},t}(),uh=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return(0,Br.ZT)(e,t),e.prototype.Su=function(t,e,n,r){return new Promise((function(i,o){var s=new qr;s.listenOnce(Mr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Lr.NO_ERROR:var e=s.getResponseJson();Kr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Lr.TIMEOUT:Kr("Connection",'RPC "'+t+'" timed out'),o(new ai(si.DEADLINE_EXCEEDED,"Request time out"));break;case Lr.HTTP_ERROR:var n=s.getStatus();if(Kr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var a=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(si).indexOf(e)>=0?e:si.UNKNOWN}(r.status);o(new ai(a,r.message))}else o(new ai(si.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new ai(si.UNAVAILABLE,"Connection failed."));break;default:Xr()}}finally{Kr("Connection",'RPC "'+t+'" completed.')}}));var a=JSON.stringify(r);s.send(e,"POST",a,n,15)}))},e.prototype.Cu=function(t,e){var n=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new Pr,i=De(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(o.initMessageHeaders,e),(0,L.uI)()||(0,L.b$)()||(0,L.d)()||(0,L.w1)()||(0,L.Mn)()||(0,L.ru)()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Kr("Connection","Creating WebChannel: "+s,o);var a=r.createWebChannel(s,o),u=!1,c=!1,h=new ah({fu:function(t){c?Kr("Connection","Not sending because WebChannel is closed:",t):(u||(Kr("Connection","Opening WebChannel transport."),a.open(),u=!0),Kr("Connection","WebChannel sending:",t),a.send(t))},du:function(){return a.close()}}),l=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(a,Vr.EventType.OPEN,(function(){c||Kr("Connection","WebChannel transport opened.")})),l(a,Vr.EventType.CLOSE,(function(){c||(c=!0,Kr("Connection","WebChannel transport closed"),h.Ru())})),l(a,Vr.EventType.ERROR,(function(t){c||(c=!0,Qr("Connection","WebChannel transport errored:",t),h.Ru(new ai(si.UNAVAILABLE,"The operation could not be completed")))})),l(a,Vr.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];Zr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Kr("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=bs[t];if(void 0!==e)return Ss(e)}(o),u=i.message;void 0===s&&(s=si.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,h.Ru(new ai(s,u)),a.close()}else Kr("Connection","WebChannel received:",n),h.Pu(n)}})),l(i,Fr.STAT_EVENT,(function(t){t.stat===jr?Kr("Connection","Detected buffering proxy"):t.stat===Ur&&Kr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Au()}),0),h},e}(function(){function t(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);Kr("RestConnection","Sending: ",i,n);var o={};return this.vu(o,r),this.Su(t,i,o,n).then((function(t){return Kr("RestConnection","Received: ",t),t}),(function(e){throw Qr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},t.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.7",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},t.prototype.bu=function(t,e){var n=sh[t];return this.gu+"/v1/"+e+":"+n},t}());function ch(){return"undefined"!=typeof window?window:null}function hh(){return"undefined"!=typeof document?document:null}function lh(t){return new na(t,!0)}var fh=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return t.prototype.reset=function(){this.Fu=0},t.prototype.Mu=function(){this.Fu=this.$u},t.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);i>0&&Kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,(function(){return e.ku=Date.now(),t()})),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},t.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},t.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},t.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},t}(),ph=function(){function t(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new fh(t,e)}return t.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Hu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ju()},t.prototype.stop=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Yu=function(){this.state=0,this.Gu.reset()},t.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,(function(){return t.Zu()})))},t.prototype.th=function(t){this.eh(),this.stream.send(t)},t.prototype.Zu=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){return this.Hu()?[2,this.close(0)]:[2]}))}))},t.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},t.prototype.close=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===si.RESOURCE_EXHAUSTED?(Jr(e.toString()),Jr("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===si.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.nh=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then((function(e){t.Wu===n&&t.ih(e)}),(function(n){e((function(){var e=new ai(si.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)}))}))},t.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu((function(){n((function(){return e.state=2,e.listener.wu()}))})),this.stream.Tu((function(t){n((function(){return e.rh(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu((function(){return(0,Br.mG)(t,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.rh=function(t){return Kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps((function(){return e.Wu===t?n():(Kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),dh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).Qt=i,s}return(0,Br.ZT)(e,t),e.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},e.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Xr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Bt?(Zr(void 0===e||"string"==typeof e),oi.fromBase64String(e||"")):(Zr(void 0===e||e instanceof Uint8Array),oi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=(a=e.targetChange.cause)&&function(t){var e=void 0===t.code?si.UNKNOWN:Ss(t.code);return new ai(e,t.message||"")}(a);n=new Qs(r,i,o,s||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=ha(t,r.document.name),o=sa(r.document.updateTime);var a=new Yi({mapValue:{fields:r.document.fields}}),u=(s=new to(i,o,a,{}),r.targetIds||[]),c=r.removedTargetIds||[];n=new Ks(u,c,s.key,s)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=ha(t,r.document),o=r.readTime?sa(r.readTime):gi.min(),a=new eo(i,o),s=r.removedTargetIds||[],n=new Ks([],s,a.key,a);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=ha(t,r.document),o=r.removedTargetIds||[],n=new Ks([],o,i,null);else{if(!("filter"in e))return Xr();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Is(r),o=h.targetId,n=new Js(o,i)}return n}(this.Qt,t),n=function(t){if(!("targetChange"in t))return gi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?gi.min():e.readTime?sa(e.readTime):gi.min()}(t);return this.listener.ah(e,n)},e.prototype.uh=function(t){var e={};e.database=pa(this.Qt),e.addTarget=function(t,e){var n,r=e.target;return(n=ao(r)?{documents:ba(t,r)}:{query:_a(t,r)}).targetId=e.targetId,e.resumeToken.l()>0?n.resumeToken=ia(t,e.resumeToken):e.Ot._(gi.min())>0&&(n.readTime=ra(t,e.Ot.j())),n}(this.Qt,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xr()}}(0,e.Ft);return null==n?null:{"goog-listen-tags":n}}(this.Qt,t);n&&(e.labels=n),this.th(e)},e.prototype.hh=function(t){var e={};e.database=pa(this.Qt),e.removeTarget=t,this.th(e)},e}(ph),vh=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).Qt=i,s.lh=!1,s}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.nh=function(){this.lh&&this.fh([])},e.prototype.oh=function(t){return this.Qu.Cu("Write",t)},e.prototype.onMessage=function(t){if(Zr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=function(t,e){return t&&t.length>0?(Zr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?sa(t.updateTime):sa(e);n.isEqual(gi.min())&&(n=sa(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new is(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=sa(t.commitTime);return this.listener.dh(n,e)}return Zr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},e.prototype.Eh=function(){var t={};t.database=pa(this.Qt),this.th(t)},e.prototype.fh=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return ga(e.Qt,t)}))};this.th(n)},e}(ph),yh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qu=n,i.Qt=r,i.Th=!1,i}return(0,Br.ZT)(e,t),e.prototype.Ih=function(){if(this.Th)throw new ai(si.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.pu(t,e,n,i)})).catch((function(t){throw t.code===si.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then((function(i){return r.Qu.Du(t,e,n,i)})).catch((function(t){throw t.code===si.UNAUTHENTICATED&&r.credentials.p(),t}))},e.prototype.terminate=function(){this.Th=!1},e}((function(){})),gh=function(){function t(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return t.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,(function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()})))},t.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},t.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},t.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},t.prototype.gh=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rh?(Jr(e),this.Rh=!1):Kr("OnlineStateTracker",e)},t.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},t}(),mh=function(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou((function(t){n.Ps((function(){return(0,Br.mG)(o,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return Ah(this)?(Kr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return(e=$r(t)).Nh.add(4),[4,_h(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,bh(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Oh=new gh(n,r)};function bh(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:if(!Ah(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function _h(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function wh(t,e){var n=$r(t);n.xh.has(e.targetId)||(n.xh.set(e.targetId,e),Ch(n)?Sh(n):Bh(n).Hu()&&Ih(n,e))}function Eh(t,e){var n=$r(t),r=Bh(n);n.xh.delete(e),r.Hu()&&Th(n,e),0===n.xh.size&&(r.Hu()?r.Xu():Ah(n)&&n.Oh.set("Unknown"))}function Ih(t,e){t.kh.on(e.targetId),Bh(t).uh(e)}function Th(t,e){t.kh.on(e),Bh(t).hh(e)}function Sh(t){t.kh=new Xs({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),Bh(t).start(),t.Oh.Ph()}function Ch(t){return Ah(t)&&!Bh(t).zu()&&t.xh.size>0}function Ah(t){return 0===$r(t).Nh.size}function Nh(t){t.kh=void 0}function kh(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return t.xh.forEach((function(e,n){Ih(t,e)})),[2]}))}))}function Ph(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(n){return Nh(t),Ch(t)?(t.Oh.Vh(e),Sh(t)):t.Oh.set("Unknown"),[2]}))}))}function Dh(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:if(t.Oh.set("Online"),!(e instanceof Qs&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.xh.has(o)?[4,t.Dh.Mh(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.xh.delete(o),t.kh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Kr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Oh(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ks?t.kh.dn(e):e instanceof Js?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(gi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Cc(t.bh)];case 8:return i=s.sent(),n._(i)>=0?[4,function(t,e){var n=t.kh.Vn(e);return n.$e.forEach((function(n,r){if(n.resumeToken.l()>0){var i=t.xh.get(r);i&&t.xh.set(r,i.Mt(n.resumeToken,e))}})),n.Fe.forEach((function(e){var n=t.xh.get(e);if(n){t.xh.set(e,n.Mt(oi.T,n.Ot)),Th(t,e);var r=new qo(n.target,e,1,n.sequenceNumber);Ih(t,r)}})),t.Dh.Lh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Kr("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Oh(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function Oh(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r=this;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:if(!Ua(e))throw e;return t.Nh.add(1),[4,_h(t)];case 1:return i.sent(),t.Oh.set("Offline"),n||(n=function(){return Cc(t.bh)}),t._s.po((function(){return(0,Br.mG)(r,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return Kr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,bh(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Rh(t,e){return e().catch((function(n){return Oh(t,n,e)}))}function xh(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:e=$r(t),n=Gh(e),r=e.Ch.length>0?e.Ch[e.Ch.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Ah(t)&&t.Ch.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,kc(e.bh,r)];case 3:return null===(i=s.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e);var n=Gh(t);n.Hu()&&n._h&&n.fh(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Oh(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Lh(e)&&Mh(e),[2]}}))}))}function Lh(t){return Ah(t)&&!Gh(t).zu()&&t.Ch.length>0}function Mh(t){Gh(t).start()}function Fh(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return Gh(t).Eh(),[2]}))}))}function jh(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,Br.Jh)(this,(function(o){for(e=Gh(t),n=0,r=t.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]}))}))}function Uh(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=mu.from(r,e,n),[4,Rh(t,(function(){return t.Dh.Bh(i)}))];case 1:return o.sent(),[4,xh(t)];case 2:return o.sent(),[2]}}))}))}function Vh(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e&&Gh(t)._h?[4,function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return Ts(r=e.code)&&r!==si.ABORTED?(n=t.Ch.shift(),Gh(t).Yu(),[4,Rh(t,(function(){return t.Dh.qh(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,xh(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Lh(t)&&Mh(t),[2]}}))}))}function qh(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return n=$r(t),e?(n.Nh.delete(2),[4,bh(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,_h(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Bh(t){var e=this;return t.Uh||(t.Uh=function(t,e,n){var r=$r(t);return r.Ih(),new dh(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:kh.bind(null,t),Tu:Ph.bind(null,t),ah:Dh.bind(null,t)}),t.$h.push((function(n){return(0,Br.mG)(e,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Uh.Yu(),Ch(t)?Sh(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:e.sent(),Nh(t),e.label=3;case 3:return[2]}}))}))}))),t.Uh}function Gh(t){var e=this;return t.Qh||(t.Qh=function(t,e,n){var r=$r(t);return r.Ih(),new vh(e,r.Qu,r.credentials,r.Qt,n)}(t.Sh,t._s,{wu:Fh.bind(null,t),Tu:Vh.bind(null,t),wh:jh.bind(null,t),dh:Uh.bind(null,t)}),t.$h.push((function(n){return(0,Br.mG)(e,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Qh.Yu(),[4,xh(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:e.sent(),t.Ch.length>0&&(Kr("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qh}var Wh=function(){this.Kh=void 0,this.listeners=[]},Hh=function(){this.queries=new Vu((function(t){return Mo(t)}),Lo),this.onlineState="Unknown",this.Wh=new Set};function zh(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:if(n=$r(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Wh),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.jh(r)];case 2:return s.Kh=c.sent(),[3,4];case 3:return a=c.sent(),u=Ha(a,"Initialization of query '"+Fo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Gh(n.onlineState),o.Kh&&e.zh(o.Kh)&&Yh(n),[2]}}))}))}function Kh(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,Br.Jh)(this,(function(a){return n=$r(t),r=e.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]}))}))}function Jh(t,e){for(var n=$r(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.queries.get(a);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].zh(s)&&(r=!0);u.Kh=s}}r&&Yh(n)}function Qh(t,e,n){var r=$r(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function Yh(t){t.Wh.forEach((function(t){t.next()}))}var Xh=function(){function t(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ws(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},t.prototype.onError=function(t){this.Jh.error(t)},t.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},t.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},t.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.el=function(t){t=Ws.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},t}(),Zh=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.sl=function(){return"metadata"in this.payload},t}(),$h=function(){function t(t){this.Qt=t}return t.prototype.Pc=function(t){return ha(this.Qt,t)},t.prototype.yc=function(t){return t.metadata.exists?ya(this.Qt,t.document,!1):new eo(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},t.prototype.gc=function(t){return sa(t)},t}(),tl=function(){function t(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=el(t)}return t.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.ol=function(t){for(var e=new Map,n=new $h(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Us()).add(s);e.set(c,h)}}return e},t.prototype.complete=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return[4,Mc(this.bh,new $h(this.Qt),this.documents,this.il.id)];case 1:t=o.sent(),e=this.ol(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Fc(this.bh,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new mc(Object.assign({},this.progress),t))]}}))}))},t}();function el(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var nl=function(t){this.key=t},rl=function(t){this.key=t},il=function(){function t(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=Us(),this.De=Us(),this.hl=Uo(t),this.ll=new Bs(this.hl)}return Object.defineProperty(t.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),t.prototype.fl=function(t,e){var n=this,r=e?e.dl:new Gs,i=e?e.ll:this.ll,o=e?e.De:this.De,s=i,a=!1,u=Ao(this.query)&&i.size===this.query.limit?i.last():null,c=No(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt((function(t,e){var h=i.get(t),l=e instanceof to?e:null;l&&(l=jo(n.query,l)?l:null);var f=!!h&&n.De.has(h.key),p=!!l&&(l.Vt||n.De.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.wl(h,l)||(r.track({type:2,doc:l}),d=!0,(u&&n.hl(l,u)>0||c&&n.hl(l,c)<0)&&(a=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ao(this.query)||No(this.query))for(;s.size>this.query.limit;){var h=Ao(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ll:s,dl:r,lc:a,De:o}},t.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},t.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xr()}};return n(t)-n(e)}(t.type,e.type)||r.hl(t.doc,e.doc)})),this.El(n);var s=e?this.Tl():[],a=0===this.ul.size&&this.Be?1:0,u=a!==this.al;return this.al=a,0!==o.length||u?{snapshot:new Ws(this.query,t.ll,i,o,t.De,0===a,u,!1),Il:s}:{Il:s}},t.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new Gs,De:this.De,lc:!1},!1)):{Il:[]}},t.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},t.prototype.El=function(t){var e=this;t&&(t.qe.forEach((function(t){return e.cl=e.cl.add(t)})),t.Ue.forEach((function(t){})),t.Qe.forEach((function(t){return e.cl=e.cl.delete(t)})),this.Be=t.Be)},t.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=Us(),this.ll.forEach((function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))}));var n=[];return e.forEach((function(e){t.ul.has(e)||n.push(new rl(e))})),this.ul.forEach((function(t){e.has(t)||n.push(new nl(t))})),n},t.prototype.Al=function(t){this.cl=t.Rc,this.ul=Us();var e=this.fl(t.documents);return this.wi(e,!0)},t.prototype.Rl=function(){return Ws.Ne(this.query,this.ll,this.De,0===this.al)},t}(),ol=function(t,e,n){this.query=t,this.targetId=e,this.view=n},sl=function(t){this.key=t,this.Pl=!1},al=function(){function t(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Vu((function(t){return Mo(t)}),Lo),this.Sl=new Map,this.Dl=new Set,this.Cl=new Cs(Ei.H),this.xl=new Map,this.Nl=new Uc,this.$l={},this.Fl=new Map,this.Ol=Qu.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(t.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),t}();function ul(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return n=Fl(t),(o=n.vl.get(e))?(r=o.targetId,n.Vl.Fa(r),i=o.view.Rl(),[3,4]):[3,1];case 1:return[4,Pc(n.bh,Ro(e))];case 2:return s=u.sent(),a=n.Vl.Fa(s.targetId),r=s.targetId,[4,cl(n,e,r,"current"===a)];case 3:i=u.sent(),n.Ml&&wh(n.yl,s),u.label=4;case 4:return[2,i]}}))}))}function cl(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s,a,u,c;return(0,Br.Jh)(this,(function(h){switch(h.label){case 0:return t.Ll=function(e,n,r){return function(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return(i=e.view.fl(n)).lc?[4,Oc(t.bh,e.query,!1).then((function(t){var n=t.documents;return e.view.fl(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.$e.get(e.targetId),s=e.view.wi(i,t.Ml,o),[2,(El(t,e.targetId,s.Il),s.snapshot)]}}))}))}(t,e,n,r)},[4,Oc(t.bh,e,!0)];case 1:return i=h.sent(),o=new il(e,i.Rc),s=o.fl(i.documents),a=zs.Le(n,r&&"Offline"!==t.onlineState),u=o.wi(s,t.Ml,a),El(t,n,u.Il),c=new ol(e,n,o),[2,(t.vl.set(e,c),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),u.snapshot)]}}))}))}function hl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return n=$r(t),r=n.vl.get(e),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter((function(t){return!Lo(t,e)}))),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,Dc(n.bh,r.targetId,!1).then((function(){n.Vl.La(r.targetId),Eh(n.yl,r.targetId),_l(n,r.targetId)})).catch(Uu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return _l(n,r.targetId),[4,Dc(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function ll(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:r=jl(t),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(t,e){var n,r=$r(t),i=yi.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Us());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Tc.Xo(t,o).next((function(o){n=o;for(var s=[],a=0,u=e;a<u.length;a++){var c=u[a],h=hs(c,n.get(c.key));null!=h&&s.push(new ds(c.key,h,Zi(h.proto.mapValue),os.exists(!0)))}return r.zo.Ri(t,i,s,e)}))})).then((function(t){var e=t.xs(n);return{batchId:t.batchId,ri:e}}))}(r.bh,e)];case 2:return i=a.sent(),r.Vl.Ca(i.batchId),function(t,e,n){var r=t.$l[t.currentUser.A()];r||(r=new Cs(ni)),r=r.zt(e,n),t.$l[t.currentUser.A()]=r}(r,i.batchId,n),[4,Sl(r,i.ri)];case 3:return a.sent(),[4,xh(r.yl)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Ha(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function fl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:n=$r(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ac(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach((function(t,e){var r=n.xl.get(e);r&&(Zr(t.qe.size+t.Ue.size+t.Qe.size<=1),t.qe.size>0?r.Pl=!0:t.Ue.size>0?Zr(r.Pl):t.Qe.size>0&&(Zr(r.Pl),r.Pl=!1))})),[4,Sl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Uu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function pl(t,e,n){var r=$r(t);if(r.Ml&&0===n||!r.Ml&&1===n){var i=[];r.vl.forEach((function(t,n){var r=n.view.Gh(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=$r(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Gh(e)&&(r=!0)})),r&&Yh(n)}(r.gl,e),i.length&&r.bl.ah(i),r.onlineState=e,r.Ml&&r.Vl.Qa(e)}}function dl(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:return(r=$r(t)).Vl.Ba(e,"rejected",n),i=r.xl.get(e),(o=i&&i.key)?(s=(s=new Cs(Ei.H)).zt(o,new eo(o,gi.min())),a=Us().add(o),u=new Hs(gi.min(),new Map,new ks(ni),s,a),[4,fl(r,u)]):[3,2];case 1:return c.sent(),r.Cl=r.Cl.remove(o),r.xl.delete(e),Tl(r),[3,4];case 2:return[4,Dc(r.bh,e,!1).then((function(){return _l(r,e,n)})).catch(Uu)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function vl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:n=$r(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Sc(n.bh,e)];case 2:return i=o.sent(),bl(n,r,null),ml(n,r),n.Vl.Na(r,"acknowledged"),[4,Sl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Uu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function yl(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:r=$r(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=$r(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.zo.Pi(t,e).next((function(e){return Zr(null!==e),r=e.keys(),n.zo.Ci(t,e)})).next((function(){return n.zo.$i(t)})).next((function(){return n.Tc.Xo(t,r)}))}))}(r.bh,e)];case 2:return i=o.sent(),bl(r,e,n),ml(r,e),r.Vl.Na(e,"rejected",n),[4,Sl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Uu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function gl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:Ah((n=$r(t)).yl)||Kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(t){var e=$r(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.zo.Vi(t)}))}(n.bh)];case 2:return-1===(r=a.sent())?[2,void e.resolve()]:((i=n.Fl.get(r)||[]).push(e),n.Fl.set(r,i),[3,4]);case 3:return o=a.sent(),s=Ha(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}}))}))}function ml(t,e){(t.Fl.get(e)||[]).forEach((function(t){t.resolve()})),t.Fl.delete(e)}function bl(t,e,n){var r=$r(t),i=r.$l[r.currentUser.A()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i}}function _l(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach((function(e){t.Nl.Fi(e)||wl(t,e)}))}function wl(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Eh(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Tl(t))}function El(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof nl?(t.Nl.nr(o.key,e),Il(t,o)):o instanceof rl?(Kr("SyncEngine","Document no longer in limbo: "+o.key),t.Nl.ir(o.key,e),t.Nl.Fi(o.key)||wl(t,o.key)):Xr()}}function Il(t,e){var n=e.key,r=n.path.rt();t.Cl.get(n)||t.Dl.has(r)||(Kr("SyncEngine","New document in limbo: "+n),t.Dl.add(r),Tl(t))}function Tl(t){for(;t.Dl.size>0&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new Ei(bi.ot(e)),r=t.Ol.next();t.xl.set(r,new sl(n)),t.Cl=t.Cl.zt(n,r),wh(t.yl,new qo(Ro(Co(n.path)),r,2,vi.q))}}function Sl(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return r=$r(t),i=[],o=[],s=[],r.vl.et()?[3,3]:(r.vl.forEach((function(t,a){s.push(r.Ll(a,e,n).then((function(t){if(t){r.Ml&&r.Vl.Ba(a.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=_c.oc(a.targetId,t);o.push(e)}})))})),[4,Promise.all(s)]);case 1:return a.sent(),r.bl.ah(i),[4,function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h;return(0,Br.Jh)(this,(function(l){switch(l.label){case 0:n=$r(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return xa.forEach(e,(function(e){return xa.forEach(e.ic,(function(r){return n.persistence.Ti.nr(t,e.targetId,r)})).next((function(){return xa.forEach(e.rc,(function(r){return n.persistence.Ti.ir(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!Ua(r=l.sent()))throw r;return Kr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],a=s.targetId,s.fromCache||(u=n.fc.get(a),c=u.Ot,h=u.Lt(c),n.fc=n.fc.zt(a,h));return[2]}}))}))}(r.bh,o)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Cl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return(n=$r(t)).currentUser.isEqual(e)?[3,3]:(Kr("SyncEngine","User change. New user:",e.A()),[4,Tc(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fl.forEach((function(t){t.forEach((function(t){t.reject(new ai(si.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fl.clear()}(n),n.Vl.Ua(e,r.mc,r.Ac),[4,Sl(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Al(t,e){var n=$r(t),r=n.xl.get(e);if(r&&r.Pl)return Us().add(r.key);var i=Us(),o=n.Sl.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],c=n.vl.get(u);i=i.Pe(c.view._l)}return i}function Nl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return[4,Oc((n=$r(t)).bh,e.query,!0)];case 1:return r=o.sent(),i=e.view.Al(r),[2,(n.Ml&&El(n,e.targetId,i.Il),i)]}}))}))}function kl(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){return[2,xc((e=$r(t)).bh).then((function(t){return Sl(e,t)}))]}))}))}function Pl(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=$r(t),r=$r(n.zo);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.yi(t,e).next((function(e){return e?n.Tc.Xo(t,e):xa.resolve(null)}))}))}((i=$r(t)).bh,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,xh(i.yl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(bl(i,e,r||null),ml(i,e),function(t,e){$r($r(t).zo).xi(e)}(i.bh,e)):Xr(),s.label=4;case 4:return[4,Sl(i,o)];case 5:return s.sent(),[3,7];case 6:Kr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Dl(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c;return(0,Br.Jh)(this,(function(h){switch(h.label){case 0:return Fl(n=$r(t)),jl(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,Ol(n,r.it())]);case 1:return i=h.sent(),n.kl=!0,[4,qh(n.yl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)a=s[o],wh(n.yl,a);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(u=[],c=Promise.resolve(),n.Sl.forEach((function(t,e){n.Vl.Ma(e)?u.push(e):c=c.then((function(){return _l(n,e),Dc(n.bh,e,!0)})),Eh(n.yl,e)})),[4,c]);case 4:return h.sent(),[4,Ol(n,u)];case 5:return h.sent(),function(t){var e=$r(t);e.xl.forEach((function(t,n){Eh(e.yl,n)})),e.Nl.Oc(),e.xl=new Map,e.Cl=new Cs(Ei.H)}(n),n.kl=!1,[4,qh(n.yl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function Ol(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,l,f,p,d,v;return(0,Br.Jh)(this,(function(y){switch(y.label){case 0:n=$r(t),r=[],i=[],o=0,s=e,y.label=1;case 1:return o<s.length?(a=s[o],u=void 0,(c=n.Sl.get(a))&&0!==c.length?[4,Pc(n.bh,Ro(c[0]))]:[3,7]):[3,13];case 2:u=y.sent(),h=0,l=c,y.label=3;case 3:return h<l.length?(f=l[h],p=n.vl.get(f),[4,Nl(n,p)]):[3,6];case 4:(d=y.sent()).snapshot&&i.push(d.snapshot),y.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Rc(n.bh,a)];case 8:return v=y.sent(),[4,Pc(n.bh,v)];case 9:return u=y.sent(),[4,cl(n,Rl(v),a,!1)];case 10:y.sent(),y.label=11;case 11:r.push(u),y.label=12;case 12:return o++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}}))}))}function Rl(t){return So(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function xl(t){var e=$r(t);return $r($r(e.bh).persistence).Uo()}function Ll(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return(i=$r(t)).kl?(Kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,xc(i.bh)];case 3:return o=a.sent(),s=Hs.Me(e,"current"===n),[4,Sl(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,Dc(i.bh,e,!0)];case 6:return a.sent(),_l(i,e,r),[3,8];case 7:Xr(),a.label=8;case 8:return[2]}}))}))}function Ml(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f;return(0,Br.Jh)(this,(function(p){switch(p.label){case 0:if(!(r=Fl(t)).kl)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(s=o[i],r.Sl.has(s)?(Kr("SyncEngine","Adding an already active target "+s),[3,5]):[4,Rc(r.bh,s)]):[3,6];case 2:return a=p.sent(),[4,Pc(r.bh,a)];case 3:return u=p.sent(),[4,cl(r,Rl(a),u.targetId,!1)];case 4:p.sent(),wh(r.yl,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,Dc(r.bh,t,!1).then((function(){Eh(r.yl,t),_l(r,t)})).catch(Uu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,p.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Fl(t){var e=$r(t);return e.yl.Dh.Lh=fl.bind(null,e),e.yl.Dh.vn=Al.bind(null,e),e.yl.Dh.Mh=dl.bind(null,e),e.bl.ah=Jh.bind(null,e.gl),e.bl.Bl=Qh.bind(null,e.gl),e}function jl(t){var e=$r(t);return e.yl.Dh.Bh=vl.bind(null,e),e.yl.Dh.qh=yl.bind(null,e),e}function Ul(t,e,n){var r=$r(t);(function(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=$r(t),r=sa(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.wo.Os(t,e.id)})).then((function(t){return!!t&&t.createTime._(r)>=0}))}(t.bh,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n.ql(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n.Ul(el(r)),i=new tl(r,t.bh,e.Qt),[4,e.Ql()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.rl(o)]:[3,10];case 7:return(s=c.sent())&&n.Ul(s),[4,e.Ql()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return a=c.sent(),[4,Sl(t,a.Go,void 0)];case 12:return c.sent(),[4,function(t,e){var n=$r(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.wo.ks(t,e)}))}(t.bh,r)];case 13:return c.sent(),n.ql(a.progress),[3,15];case 14:return Qr("SyncEngine","Loading bundle failed with "+(u=c.sent())),n.Kl(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.Vl.Wa()}))}var Vl=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return this.Qt=lh(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}}))}))},t.prototype.zl=function(t){return null},t.prototype.Hl=function(t){return Ic(this.persistence,new wc,t.Jl,this.Qt)},t.prototype.jl=function(t){return new Hc(Kc.ia,this.Qt)},t.prototype.Wl=function(t){return new rh},t.prototype.terminate=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}}))}))},t}(),ql=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Yl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,Br.ZT)(e,t),e.prototype.initialize=function(e){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Lc(this.bh)];case 2:return n.sent(),[4,this.Yl.initialize(this,e)];case 3:return n.sent(),[4,jl(this.Yl._a)];case 4:return n.sent(),[4,xh(this.Yl.yl)];case 5:return n.sent(),[2]}}))}))},e.prototype.Hl=function(t){return Ic(this.persistence,new wc,t.Jl,this.Qt)},e.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new nc(e,t._s)},e.prototype.jl=function(t){var e=gc(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?ju.Ys(this.cacheSizeBytes):ju.ti;return new dc(this.synchronizeTabs,e,t.clientId,n,t._s,ch(),hh(),this.Qt,this.Vl,!!this.forceOwnership)},e.prototype.Wl=function(t){return new rh},e}(Vl),Bl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Yl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,Br.ZT)(e,t),e.prototype.initialize=function(e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Yl._a,this.Vl instanceof nh?(this.Vl._a={eu:Pl.bind(null,n),nu:Ll.bind(null,n),su:Ml.bind(null,n),Uo:xl.bind(null,n),tu:kl.bind(null,n)},[4,this.Vl.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Ro((function(t){return(0,Br.mG)(r,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return[4,Dl(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Wl=function(t){var e=ch();if(!nh.Kn(e))throw new ai(si.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=gc(t.yu.t,t.yu.persistenceKey);return new nh(e,t._s,n,t.clientId,t.Jl)},e}(ql),Gl=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return pl(n._a,t,1)},this.yl.Dh.n_=Cl.bind(null,this._a),[4,qh(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.t_=function(t){return new Hh},t.prototype.Xl=function(t){var e,n=lh(t.yu.t),r=(e=t.yu,new uh(e));return function(t,e,n){return new yh(t,e,n)}(t.credentials,r,n)},t.prototype.Zl=function(t){var e,n,r,i,o,s=this;return e=this.bh,n=this.Sh,r=t._s,i=function(t){return pl(s._a,t,0)},o=oh.Kn()?new oh:new ih,new mh(e,n,r,i,o)},t.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){var a=new al(t,e,n,r,i,o);return s&&(a.kl=!0),a}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},t.prototype.terminate=function(){return function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=$r(t),Kr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,_h(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}}))}))}(this.yl)},t}();function Wl(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,Br.mG)(this,void 0,void 0,(function(){var r;return(0,Br.Jh)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){return[2]}))}))},releaseLock:function(){}}}var Hl=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.i_=function(){this.muted=!0},t.prototype.s_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),zl=function(){function t(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new Ra,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then((function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.r_.cancel()},t.prototype.getMetadata=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Ql=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}}))}))},t.prototype.c_=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.a_()];case 1:return null===(t=i.sent())?[2,null]:(e=this.o_.decode(t),n=Number(e),isNaN(n)&&this.u_("length string ("+e+") is not valid number"),[4,this.h_(n)]);case 2:return r=i.sent(),[2,new Zh(JSON.parse(r),t.length+n)]}}))}))},t.prototype.l_=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.a_=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.h_=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.__=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),Kl=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new ai(si.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new wi(t)}return t.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},t}(),Jl=function(t){this._methodName=t},Ql=function(t){this.d_=t};function Yl(t,e,n){if(!n)throw new ai(si.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Xl(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ai(si.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zl(t,e,n,r){if(!0===e&&!0===r)throw new ai(si.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function $l(t){if(!Ei.wt(t))throw new ai(si.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function tf(t){if(Ei.wt(t))throw new ai(si.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ef(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Xr()}function nf(t,e){if("_delegate"in t&&(t=t.d_),!(t instanceof e)){if(e.name===t.constructor.name)throw new ai(si.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ef(t);throw new ai(si.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function rf(t,e){if(e<=0)throw new ai(si.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var of=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ai(si.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ai(si.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Zl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),sf=new Map,af=function(){function t(t,e){this.w_="(lite)",this.E_=new of({}),this.T_=!1,t instanceof Wr?(this.I_=t,this.m_=new li):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ai(si.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wr(t.options.projectId)}(t),this.m_=new fi(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.A_)throw new ai(si.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),t.prototype.g_=function(t){if(this.T_)throw new ai(si.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new of(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new li;switch(t.type){case"gapi":var e=t.client;return Zr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new di(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new ai(si.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.V_=function(){return this.E_},t.prototype.p_=function(){return this.T_=!0,this.E_},t.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},t.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},t.prototype.b_=function(){return(t=sf.get(this))&&(Kr("ComponentProvider","Removing Datastore"),sf.delete(this),t.terminate()),Promise.resolve();var t},t}(),uf=function(){function t(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new hf(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.S_)},t}(),cf=function(){function t(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.C_)},t}(),hf=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Co(r))||this).firestore=e,i.D_=r,i.type="collection",i}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new uf(this.firestore,null,new Ei(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.D_)},e}(cf);function lf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ql&&(t=t.d_),Yl("collection","path",e),t instanceof af)return tf(n=bi.ot.apply(bi,(0,Br.pr)([e],r))),new hf(t,null,n);if(!(t instanceof uf||t instanceof hf))throw new ai(si.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tf(n=bi.ot.apply(bi,(0,Br.pr)([t.path],r)).child(bi.ot(e))),new hf(t.firestore,null,n)}function ff(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof Ql&&(t=t.d_),1===arguments.length&&(e=ei.u()),Yl("doc","path",e),t instanceof af)return $l(n=bi.ot.apply(bi,(0,Br.pr)([e],r))),new uf(t,null,new Ei(n));if(!(t instanceof uf||t instanceof hf))throw new ai(si.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return $l(n=t.D_.child(bi.ot.apply(bi,(0,Br.pr)([e],r)))),new uf(t.firestore,t instanceof hf?t.v_:null,new Ei(n))}function pf(t,e){return t instanceof Ql&&(t=t.d_),e instanceof Ql&&(e=e.d_),(t instanceof uf||t instanceof hf)&&(e instanceof uf||e instanceof hf)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function df(t,e){return t instanceof Ql&&(t=t.d_),e instanceof Ql&&(e=e.d_),t instanceof cf&&e instanceof cf&&t.firestore===e.firestore&&Lo(t.C_,e.C_)&&t.v_===e.v_}var vf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new ai(si.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new ai(si.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},t.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},t.prototype.U=function(t){return ni(this.x_,t.x_)||ni(this.N_,t.N_)},t}(),yf=/^__.*__$/,gf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return null!==this.Gt?new ds(t,this.data,this.Gt,e,this.fieldTransforms):new ps(t,this.data,e,this.fieldTransforms)},t}(),mf=function(){function t(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}return t.prototype.F_=function(t,e){return new ds(t,this.data,this.Gt,e,this.fieldTransforms)},t}();function bf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xr()}}var _f=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),t.prototype.M_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},t.prototype.L_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.q_(t),r},t.prototype.U_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.M_({path:n,B_:!1});return r.O_(),r},t.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},t.prototype.K_=function(t){return Vf(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},t.prototype.contains=function(t){return void 0!==this.Gt.find((function(e){return t.nt(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.nt(e.field)}))},t.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},t.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(bf(this.k_)&&yf.test(t))throw this.K_('Document fields cannot begin and end with "__"')},t}(),wf=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||lh(t)}return t.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new _f({k_:t,methodName:e,j_:n,path:wi.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},t}();function Ef(t){var e=t.p_(),n=lh(t.I_);return new wf(t.I_,!!e.ignoreUndefinedProperties,n)}function If(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Mf("Data must be an object, but it was:",s,r);var a,u,c=xf(r,s);if(o.merge)a=new Ci(s.Gt),u=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=Ff(e,f[l],n);if(!s.contains(p))throw new ai(si.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");qf(h,p)||h.push(p)}a=new Ci(h),u=s.fieldTransforms.filter((function(t){return a.Tt(t.field)}))}else a=null,u=s.fieldTransforms;return new gf(new Yi(c),a,u)}var Tf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Jl);function Sf(t,e,n){return new _f({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var Cf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.z_=function(t){return new rs(t.path,new Qo)},e.prototype.isEqual=function(t){return t instanceof e},e}(Jl),Af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,Br.ZT)(e,t),e.prototype.z_=function(t){var e=Sf(this,t,!0),n=this.H_.map((function(t){return Rf(t,e)})),r=new Yo(n);return new rs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Jl),Nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).H_=n,r}return(0,Br.ZT)(e,t),e.prototype.z_=function(t){var e=Sf(this,t,!0),n=this.H_.map((function(t){return Rf(t,e)})),r=new Zo(n);return new rs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Jl),kf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).J_=n,r}return(0,Br.ZT)(e,t),e.prototype.z_=function(t){var e=new ts(t.Qt,Wo(t.Qt,this.J_));return new rs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Jl);function Pf(t,e,n,r){var i=t.G_(1,e,n);Mf("Data must be an object, but it was:",i,r);var o=[],s=new Xi;Ti(r,(function(t,r){var a=Uf(e,t,n);r instanceof Ql&&(r=r.d_);var u=i.U_(a);if(r instanceof Tf)o.push(a);else{var c=Rf(r,u);null!=c&&(o.push(a),s.set(a,c))}}));var a=new Ci(o);return new mf(s.Pt(),a,i.fieldTransforms)}function Df(t,e,n,r,i,o){var s=t.G_(1,e,n),a=[Ff(e,r,n)],u=[i];if(o.length%2!=0)throw new ai(si.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(Ff(e,o[c])),u.push(o[c+1]);for(var h=[],l=new Xi,f=a.length-1;f>=0;--f)if(!qf(h,a[f])){var p=a[f],d=u[f];d instanceof Ql&&(d=d.d_);var v=s.U_(p);if(d instanceof Tf)h.push(p);else{var y=Rf(d,v);null!=y&&(h.push(p),l.set(p,y))}}var g=new Ci(h);return new mf(l.Pt(),g,s.fieldTransforms)}function Of(t,e,n,r){return void 0===r&&(r=!1),Rf(n,t.G_(r?4:3,e))}function Rf(t,e){if(t instanceof Ql&&(t=t.d_),Lf(t))return Mf("Unsupported field value:",e,t),xf(t,e);if(t instanceof Jl)return function(t,e){if(!bf(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Rf(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Ql&&(t=t.d_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Wo(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=yi.fromDate(t);return{timestampValue:ra(e.Qt,n)}}if(t instanceof yi)return n=new yi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ra(e.Qt,n)};if(t instanceof vf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ui)return{bytesValue:ia(e.Qt,t.I)};if(t instanceof uf){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:aa(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+ef(t))}(t,e)}function xf(t,e){var n={};return Si(t)?e.path&&e.path.length>0&&e.Gt.push(e.path):Ti(t,(function(t,r){var i=Rf(r,e.L_(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Lf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof yi||t instanceof vf||t instanceof ui||t instanceof uf||t instanceof Jl)}function Mf(t,e,n){if(!Lf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=ef(n);throw"an object"===r?e.K_(t+" a custom object"):e.K_(t+" "+r)}}function Ff(t,e,n){if(e instanceof Ql&&(e=e.d_),e instanceof Kl)return e.f_;if("string"==typeof e)return Uf(t,e);throw Vf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var jf=new RegExp("[~\\*/\\[\\]]");function Uf(t,e,n){if(e.search(jf)>=0)throw Vf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Kl.bind.apply(Kl,(0,Br.pr)([void 0],e.split("."))))).f_}catch(r){throw Vf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Vf(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new ai(si.INVALID_ARGUMENT,(a+=". ")+t+u)}function qf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Bf=function(){function t(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return t.prototype.ef=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:if(this.nf(),this.mutations.length>0)throw new ai(si.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return n=$r(t),r=pa(n.Qt)+"/documents",i={documents:e.map((function(t){return ca(n.Qt,t)}))},[4,n.Du("BatchGetDocuments",r,i)];case 1:return o=u.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Zr(!!e.found),e.found.name,e.found.updateTime;var n=ha(t,e.found.name),r=sa(e.found.updateTime),i=new Yi({mapValue:{fields:e.found.fields}});return new to(n,r,i,{})}(t,e):"missing"in e?function(t,e){Zr(!!e.missing),Zr(!!e.readTime);var n=ha(t,e.missing),r=sa(e.readTime);return new eo(n,r)}(t,e):Xr()}(n.Qt,t);s.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=s.get(t.toString());Zr(!!e),a.push(e)})),a)]}}))}))}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof eo||t instanceof to?n.sf(t):Xr()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},t.prototype.delete=function(t){this.write(new ws(t,this.jt(t))),this.tf.add(t.toString())},t.prototype.commit=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Ei._t(n);e.mutations.push(new Es(r,e.jt(r)))})),[4,function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return n=$r(t),r=pa(n.Qt)+"/documents",i={writes:e.map((function(t){return ga(n.Qt,t)}))},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}}))}))},t.prototype.sf=function(t){var e;if(t instanceof to)e=t.version;else{if(!(t instanceof eo))throw Xr();e=gi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new ai(si.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},t.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?os.updateTime(e):os.Kt()},t.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&e){if(e.isEqual(gi.min()))throw new ai(si.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return os.updateTime(e)}return os.exists(!0)},t.prototype.write=function(t){this.nf(),this.mutations.push(t)},t.prototype.nf=function(){},t}(),Gf=function(){function t(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new fh(this._s,"transaction_retry")}return t.prototype.run=function(){this.af()},t.prototype.af=function(){var t=this;this.Gu.Lu((function(){return(0,Br.mG)(t,void 0,void 0,(function(){var t,e,n=this;return(0,Br.Jh)(this,(function(r){return t=new Bf(this.Sh),(e=this.uf(t))&&e.then((function(e){n._s.Ps((function(){return t.commit().then((function(){n.Es.resolve(e)})).catch((function(t){n.hf(t)}))}))})).catch((function(t){n.hf(t)})),[2]}))}))}))},t.prototype.uf=function(t){try{var e=this.updateFunction(t);return!xi(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},t.prototype.hf=function(t){var e=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps((function(){return e.af(),Promise.resolve()}))):this.Es.reject(t)},t.prototype.lf=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ts(e)}return!1},t}(),Wf=function(){function t(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=ci.UNAUTHENTICATED,this.clientId=ei.u(),this._f=function(){},this.C=new Ra,this.credentials.v((function(t){Kr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()}))}return t.prototype.getConfiguration=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}}))}))},t.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then((function(){return e._f(e.user)}))},t.prototype.df=function(){if(this._s.wf)throw new ai(si.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this._s.Ef();var e=new Ra;return this._s.Tf((function(){return(0,Br.mG)(t,void 0,void 0,(function(){var t,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Ha(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function Hf(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i=this;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return t._s.Af(),Kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Jl,t.ff((function(n){r.isEqual(n)||(r=n,t._s.po((function(){return(0,Br.mG)(i,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return[4,Tc(e.bh,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.Po((function(){return t.terminate()})),t.mf=e,[2]}}))}))}function zf(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return t._s.Af(),[4,Kf(t)];case 1:return n=i.sent(),Kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff((function(n){return t._s.po((function(){return function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return(n=$r(t))._s.Af(),Kr("RemoteStore","RemoteStore received new credentials"),r=Ah(n),n.Nh.add(3),[4,_h(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,bh(n)];case 3:return i.sent(),[2]}}))}))}(e.yl,n)}))})),t.If=e,[2]}}))}))}function Kf(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return t.mf?[3,2]:(Kr("FirestoreClient","Using default OfflineComponentProvider"),[4,Hf(t,new Vl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}}))}))}function Jf(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return t.If?[3,2]:(Kr("FirestoreClient","Using default OnlineComponentProvider"),[4,zf(t,new Gl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}}))}))}function Qf(t){return Kf(t).then((function(t){return t.persistence}))}function Yf(t){return Kf(t).then((function(t){return t.bh}))}function Xf(t){return Jf(t).then((function(t){return t.yl}))}function Zf(t){return Jf(t).then((function(t){return t._a}))}function $f(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,Jf(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=ul.bind(null,e._a),n.Hh=hl.bind(null,e._a),n)]}}))}))}function tp(t,e,n){var r=this;void 0===n&&(n={});var i=new Ra;return t._s.Ps((function(){return(0,Br.mG)(r,void 0,void 0,(function(){var r;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Hl({next:function(o){e.Ps((function(){return Kh(t,s)}));var a=o.docs.has(n);!a&&o.fromCache?i.reject(new ai(si.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new ai(si.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Xh(Co(n.path),o,{includeMetadataChanges:!0,nl:!0});return zh(t,s)},[4,$f(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}function ep(t,e,n){var r=this;void 0===n&&(n={});var i=new Ra;return t._s.Ps((function(){return(0,Br.mG)(r,void 0,void 0,(function(){var r;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new Hl({next:function(n){e.Ps((function(){return Kh(t,s)})),n.fromCache&&"server"===r.source?i.reject(new ai(si.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Xh(n,o,{includeMetadataChanges:!0,nl:!0});return zh(t,s)},[4,$f(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}}))}))})),i.promise}var np=function(){function t(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new fh(this,"async_queue_retry"),this.vf=function(){var e=hh();e&&Kr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=hh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(t.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),t.prototype.Ps=function(t){this.enqueue(t)},t.prototype.Tf=function(t){this.Sf(),this.Df(t)},t.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=hh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf)}},t.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise((function(t){})):this.Df(t)},t.prototype.po=function(t){var e=this;this.Ps((function(){return e.Pf.push(t),e.Cf()}))},t.prototype.Cf=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!Ua(t=n.sent()))throw t;return Kr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu((function(){return e.Cf()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Df=function(t){var e=this,n=this.Rf.then((function(){return e.pf=!0,t().catch((function(t){throw e.Vf=t,e.pf=!1,Jr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.pf=!1,t}))}));return this.Rf=n,n},t.prototype.Tr=function(t,e,n){var r=this;this.Sf(),this.bf.indexOf(t)>-1&&(e=0);var i=Wa.Ts(this,t,e,n,(function(t){return r.xf(t)}));return this.gf.push(i),i},t.prototype.Sf=function(){this.Vf&&Xr()},t.prototype.Af=function(){},t.prototype.Nf=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t;return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},t.prototype.Ff=function(t){var e=this;return this.Nf().then((function(){e.gf.sort((function(t,e){return t.ds-e.ds}));for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()}))},t.prototype.Of=function(t){this.bf.push(t)},t.prototype.xf=function(t){var e=this.gf.indexOf(t);this.gf.splice(e,1)},t}();function rp(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var ip=function(){function t(){this.kf={},this.Mf=new Ra,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this.Mf.promise.catch(t)},t.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},t.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},t.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},t.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)},t}(),op=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Bf=new np,r.w_="name"in e?e.name:"[DEFAULT]",r}return(0,Br.ZT)(e,t),e.prototype.b_=function(){return this.qf||ap(this),this.qf.terminate()},e}(af);function sp(t){return t.qf||ap(t),t.qf.df(),t.qf}function ap(t){var e=t.p_(),n=function(t,e,n){return new Gr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.I_,t.w_,e);t.qf=new Wf(t.m_,t.Bf,n)}function up(t,e,n){var r=this,i=new Ra;return t._s.enqueue((function(){return(0,Br.mG)(r,void 0,void 0,(function(){var r;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Hf(t,n)];case 1:return o.sent(),[4,zf(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===si.FAILED_PRECONDITION||t.code===si.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function cp(t){if(t.R_||t.P_)throw new ai(si.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var hp=function(){function t(){}return t.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Fi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ki(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Pi(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Xr()}},t.prototype.Hf=function(t,e){var n=this,r={};return Ti(t.fields||{},(function(t,i){r[t]=n.Uf(i,e)})),r},t.prototype.Gf=function(t){return new vf(ki(t.latitude),ki(t.longitude))},t.prototype.zf=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.Uf(t,e)}))},t.prototype.Kf=function(t,e){switch(e){case"previous":var n=Oi(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Ri(t));default:return null}},t.prototype.Qf=function(t){var e=Ni(t);return new yi(e.seconds,e.nanos)},t.prototype.Jf=function(t,e){var n=bi.ot(t);Zr(Oa(n));var r=new Wr(n.get(1),n.get(3)),i=new Ei(n.Y(5));return r.isEqual(e)||Jr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),lp=function(){function t(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new uf(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.Zf},t.prototype.data=function(){if(this.Zf){if(this.v_){var t=new fp(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},t.prototype.get=function(t){if(this.Zf){var e=this.Zf.data().field(pp("DocumentSnapshot.get",t));if(null!==e)return this.Xf.Uf(e)}},t}(),fp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(lp);function pp(t,e){return"string"==typeof e?Uf(t,e):e instanceof Ql?e.d_.f_:e.f_}function dp(t){if(No(t)&&0===t.xt.length)throw new ai(si.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vp=function(){};function yp(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.td(t)}return t}var gp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).ed=e,i.nd=n,i.sd=r,i.type="where",i}return(0,Br.ZT)(e,t),e.prototype.td=function(t){var e=Ef(t.firestore),n=function(t,e,n,r,i,o,s){var a;if(i.ut()){if("array-contains"===o||"array-contains-any"===o)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Tp(s,o);for(var u=[],c=0,h=s;c<h.length;c++){var l=h[c];u.push(Ip(r,t,l))}a={arrayValue:{values:u}}}else a=Ip(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Tp(s,o),a=Of(n,"where",s,"in"===o||"not-in"===o);var f=uo.create(i,o,a);return function(t,e){if(e.Ct()){var n=Po(t);if(null!==n&&!n.isEqual(e.field))throw new ai(si.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=ko(t);null!==r&&Sp(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new ai(si.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new ai(si.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t.C_,0,e,t.firestore.I_,this.ed,this.nd,this.sd);return new cf(t.firestore,t.v_,function(t,e){var n=t.filters.concat([e]);return new To(t.path,t.collectionGroup,t.xt.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,n))},e}(vp),mp=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).ed=e,r.rd=n,r.type="orderBy",r}return(0,Br.ZT)(e,t),e.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new ai(si.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new ai(si.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new _o(e,n);return function(t,e){if(null===ko(t)){var n=Po(t);null!==n&&Sp(0,n,e.field)}}(t,r),r}(t.C_,this.ed,this.rd);return new cf(t.firestore,t.v_,function(t,e){var n=t.xt.concat([e]);return new To(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.C_,e))},e}(vp),bp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.od=n,i.ad=r,i}return(0,Br.ZT)(e,t),e.prototype.td=function(t){return new cf(t.firestore,t.v_,xo(t.C_,this.od,this.ad))},e}(vp),_p=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return(0,Br.ZT)(e,t),e.prototype.td=function(t){var e=Ep(t,this.type,this.ud,this.hd);return new cf(t.firestore,t.v_,function(t,e){return new To(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.C_,e))},e}(vp),wp=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.ud=n,i.hd=r,i}return(0,Br.ZT)(e,t),e.prototype.td=function(t){var e=Ep(t,this.type,this.ud,this.hd);return new cf(t.firestore,t.v_,function(t,e){return new To(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.C_,e))},e}(vp);function Ep(t,e,n,r){if(n[0]instanceof Ql&&(n[0]=n[0].d_),n[0]instanceof lp)return function(t,e,n,r,i){if(!r)throw new ai(si.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,a=Oo(t);s<a.length;s++){var u=a[s];if(u.field.ut())o.push(Wi(e,r.key));else{var c=r.field(u.field);if(Di(c))throw new ai(si.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.rt();throw new ai(si.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new mo(o,i)}(t.C_,t.firestore.I_,e,n[0].Zf,r);var i=Ef(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new ai(si.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.ut()){if("string"!=typeof c)throw new ai(si.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Do(t)&&-1!==c.indexOf("/"))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(bi.ot(c));if(!Ei.wt(h))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Ei(h);a.push(Wi(e,l))}else{var f=Of(n,r,c);a.push(f)}}return new mo(a,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ip(t,e,n){if(n instanceof Ql&&(n=n.d_),"string"==typeof n){if(""===n)throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Do(e)&&-1!==n.indexOf("/"))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(bi.ot(n));if(!Ei.wt(r))throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Wi(t,new Ei(r))}if(n instanceof uf)return Wi(t,n.S_);throw new ai(si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ef(n)+".")}function Tp(t,e){if(!Array.isArray(t)||0===t.length)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new ai(si.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Sp(t,e,n){if(!n.isEqual(e))throw new ai(si.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Cp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Ap=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,Br.ZT)(e,t),e.prototype.Wf=function(t){return new ui(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new uf(this.firestore,null,e)},e}(hp),Np=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),kp=function(t){function e(e,n,r,i,o,s){var a=this;return(a=t.call(this,e,n,r,i,s)||this).Yf=e,a.ld=e,a.metadata=o,a}return(0,Br.ZT)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Pp(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf){var n=this.Zf.data().field(pp("DocumentSnapshot.get",t));if(null!==n)return this.Xf.Uf(n,e.serverTimestamps)}},e}(lp),Pp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(kp),Dp=function(){function t(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Np(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach((function(r){t.call(e,new Pp(n.Yf,n.Xf,r.key,r,new Np(n._d.De.has(r.key),n._d.fromCache),n.query.v_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._d.xe)throw new ai(si.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===e||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map((function(e){var r=new Pp(t.Yf,t.Xf,e.doc.key,e.doc,new Np(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._d.Se;return t._d.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Pp(t.Yf,t.Xf,e.doc.key,e.doc,new Np(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Op(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.dd=e),this.fd},t}();function Op(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xr()}}function Rp(t,e){return t instanceof kp&&e instanceof kp?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Dp&&e instanceof Dp&&t.Yf===e.Yf&&df(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var xp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,Br.ZT)(e,t),e.prototype.Wf=function(t){return new ui(t)},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return new uf(this.firestore,null,e)},e}(hp);function Lp(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=nf(t,uf);var o=nf(t.firestore,op),s=Ef(o);return e instanceof Ql&&(e=e.d_),Fp(o,[("string"==typeof e||e instanceof Kl?Df(s,"updateDoc",t.S_,e,n,r):Pf(s,"updateDoc",t.S_,e)).F_(t.S_,os.exists(!0))])}function Mp(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t instanceof Ql&&(t=t.d_);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||rp(i[a])||(s=i[a],a++);var u,c,h,l={includeMetadataChanges:s.includeMetadataChanges};if(rp(i[a])){var f=i[a];i[a]=null===(e=f.next)||void 0===e?void 0:e.bind(f),i[a+1]=null===(n=f.error)||void 0===n?void 0:n.bind(f),i[a+2]=null===(r=f.complete)||void 0===r?void 0:r.bind(f)}if(t instanceof uf)c=nf(t.firestore,op),h=Co(t.S_.path),u={next:function(e){i[a]&&i[a](jp(c,t,e))},error:i[a+1],complete:i[a+2]};else{var p=nf(t,cf);c=nf(p.firestore,op),h=p.C_;var d=new xp(c);u={next:function(t){i[a]&&i[a](new Dp(c,d,p,t))},error:i[a+1],complete:i[a+2]},dp(t.C_)}return function(t,e,n,r){var i=this,o=new Hl(r),s=new Xh(e,o,n);return t._s.Ps((function(){return(0,Br.mG)(i,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=zh,[4,$f(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.i_(),t._s.Ps((function(){return(0,Br.mG)(i,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=Kh,[4,$f(t)];case 1:return[2,e.apply(void 0,[n.sent(),s])]}}))}))}))}}(sp(c),h,l,u)}function Fp(t,e){return function(t,e){var n=this,r=new Ra;return t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return n=ll,[4,Zf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(sp(t),e)}function jp(t,e,n){var r=n.docs.get(e.S_),i=new xp(t);return new kp(t,i,e.S_,r,new Np(n.hasPendingWrites,n.fromCache),e.v_)}var Up=function(){function t(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=Ef(t)}return t.prototype.set=function(t,e,n){this.md();var r=Vp(t,this.Yf),i=Cp(r.v_,e,n),o=If(this.Id,"WriteBatch.set",r.S_,i,null!==r.v_,n);return this.Ed.push(o.F_(r.S_,os.Kt())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.md();var o,s=Vp(t,this.Yf);return e instanceof Ql&&(e=e.d_),o="string"==typeof e||e instanceof Kl?Df(this.Id,"WriteBatch.update",s.S_,e,n,r):Pf(this.Id,"WriteBatch.update",s.S_,e),this.Ed.push(o.F_(s.S_,os.exists(!0))),this},t.prototype.delete=function(t){this.md();var e=Vp(t,this.Yf);return this.Ed=this.Ed.concat(new ws(e.S_,os.Kt())),this},t.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},t.prototype.md=function(){if(this.Td)throw new ai(si.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Vp(t,e){if(t instanceof Ql&&(t=t.d_),t.firestore!==e)throw new ai(si.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var qp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).Yf=e,r}return(0,Br.ZT)(e,t),e.prototype.get=function(e){var n=this,r=Vp(e,this.Yf),i=new xp(this.Yf);return t.prototype.get.call(this,e).then((function(t){return new kp(n.Yf,i,r.S_,t.Zf,new Np(!1,!1),r.v_)}))},e}(function(){function t(t,e){this.Yf=t,this.Ad=e,this.Id=Ef(t)}return t.prototype.get=function(t){var e=this,n=Vp(t,this.Yf),r=new Ap(this.Yf);return this.Ad.ef([n.S_]).then((function(t){if(!t||1!==t.length)return Xr();var i=t[0];if(i instanceof eo)return new lp(e.Yf,r,n.S_,null,n.v_);if(i instanceof to)return new lp(e.Yf,r,i.key,i,n.v_);throw Xr()}))},t.prototype.set=function(t,e,n){var r=Vp(t,this.Yf),i=Cp(r.v_,e,n),o=If(this.Id,"Transaction.set",r.S_,i,null!==r.v_,n);return this.Ad.set(r.S_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=Vp(t,this.Yf);return e instanceof Ql&&(e=e.d_),o="string"==typeof e||e instanceof Kl?Df(this.Id,"Transaction.update",s.S_,e,n,r):Pf(this.Id,"Transaction.update",s.S_,e),this.Ad.update(s.S_,o),this},t.prototype.delete=function(t){var e=Vp(t,this.Yf);return this.Ad.delete(e.S_),this},t}());function Bp(){if("undefined"==typeof Uint8Array)throw new ai(si.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Gp(){if("undefined"==typeof atob)throw new ai(si.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.fromBase64String=function(t){return Gp(),new e(ui.fromBase64String(t))},e.fromUint8Array=function(t){return Bp(),new e(ui.fromUint8Array(t))},e.prototype.toBase64=function(){return Gp(),this.d_.toBase64()},e.prototype.toUint8Array=function(){return Bp(),this.d_.toUint8Array()},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Ql),Hp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){cp(t=nf(t,op));var n=sp(t),r=t.p_(),i=new Gl;return up(n,i,new ql(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){cp(t=nf(t,op));var e=sp(t),n=t.p_(),r=new Gl;return up(e,r,new Bl(r,n.cacheSizeBytes))}(t.d_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new ai(si.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Ra;return t.Bf.Tf((function(){return(0,Br.mG)(e,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return Ma.Kn()?(e=t+"main",[4,Ma.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(gc(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.d_)},t}(),zp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).Rd=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Wr||(i.Pd=e),i}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},e.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=nf(t,af)).V_();"firestore.googleapis.com"!==r.host&&r.host!==e&&Qr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t.g_(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this.d_,t,e)},e.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return(0,Br.mG)(e,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,Qf(t)];case 1:return e=r.sent(),[4,Xf(t)];case 2:return n=r.sent(),[2,(e.yo(!0),function(t){var e=$r(t);return e.Nh.delete(0),bh(e)}(n))]}}))}))}))}(sp(nf(this.d_,op)))},e.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue((function(){return(0,Br.mG)(e,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,Qf(t)];case 1:return e=r.sent(),[4,Xf(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return(e=$r(t)).Nh.add(0),[4,_h(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(sp(nf(this.d_,op)))},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Zl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Ra;return t._s.Ps((function(){return(0,Br.mG)(e,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return e=gl,[4,Zf(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(sp(nf(this.d_,op)))},e.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new Hl(e);return t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){$r(t).Wh.add(e),e.next()},[4,$f(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.i_(),t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){$r(t).Wh.delete(e)},[4,$f(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(sp(t=nf(t,op)),rp(e)?e:{next:e})}(this.d_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Pd)throw new ai(si.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new sd(this,lf(this.d_,t))}catch(t){throw Zp(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Xp(this,ff(this.d_,t))}catch(t){throw Zp(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new rd(this,function(t,e){if(t=nf(t,af),Yl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ai(si.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new cf(t,null,function(t){return new To(bi.ct(),t)}(e))}(this.d_,t))}catch(t){throw Zp(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Ra;return t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,function(t){return Jf(t).then((function(t){return t.Sh}))}(t)];case 1:return n=i.sent(),new Gf(t._s,n,e,r).run(),[2]}}))}))})),r.promise}(sp(t),(function(n){return e(new qp(t,n))}))}(this.d_,(function(n){return t(new Jp(e,n))}))},e.prototype.batch=function(){var t=this;return sp(this.d_),new Qp(new Up(this.d_,(function(e){return Fp(t.d_,e)})))},e.prototype.loadBundle=function(t){throw new ai(si.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(t){throw new ai(si.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(Ql),Kp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,Br.ZT)(e,t),e.prototype.Wf=function(t){return new Wp(new ui(t))},e.prototype.jf=function(t){var e=this.Jf(t,this.firestore.I_);return Xp.yd(e,this.firestore,null)},e}(hp),Jp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r.Xf=new Kp(e),r}return(0,Br.ZT)(e,t),e.prototype.get=function(t){var e=this,n=ad(t);return this.d_.get(n).then((function(t){return new ed(e.Yf,new kp(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))}))},e.prototype.set=function(t,e,n){var r=ad(t);return n?(Xl("Transaction.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ad(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,(0,Br.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ad(t);return this.d_.delete(e),this},e}(Ql),Qp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.set=function(t,e,n){var r=ad(t);return n?(Xl("WriteBatch.set",n),this.d_.set(r,e,n)):this.d_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=ad(t);return 2===arguments.length?this.d_.update(s,e):(r=this.d_).update.apply(r,(0,Br.pr)([s,e,n],i)),this},e.prototype.delete=function(t){var e=ad(t);return this.d_.delete(e),this},e.prototype.commit=function(){return this.d_.commit()},e}(Ql),Yp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,r)||this).Yf=e,i.Xf=n,i}return(0,Br.ZT)(e,t),e.prototype.fromFirestore=function(t,e){var n=new Pp(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null);return this.d_.fromFirestore(new nd(this.Yf,n),null!=e?e:{})},e.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},e.gd=function(t,n){var r=e.Vd,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new Kp(t),n),i.set(n,o)),o},e}(Ql);Yp.Vd=new WeakMap;var Xp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Kp(e),r}return(0,Br.ZT)(e,t),e.pd=function(t,n,r){if(t.length%2!=0)throw new ai(si.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new e(n,new uf(n.d_,r,new Ei(t)))},e.yd=function(t,n,r){return new e(n,new uf(n.d_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new sd(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new sd(this.firestore,lf(this.d_,t))}catch(t){throw Zp(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Ql&&(t=t.d_),t instanceof uf&&pf(this.d_,t)},e.prototype.set=function(t,e){e=Xl("DocumentReference.set",e);try{return function(t,e,n){t=nf(t,uf);var r=nf(t.firestore,op),i=Cp(t.v_,e,n);return Fp(r,[If(Ef(r),"setDoc",t.S_,i,null!==t.v_,n).F_(t.S_,os.Kt())])}(this.d_,t,e)}catch(t){throw Zp(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Lp(this.d_,t):Lp.apply(void 0,(0,Br.pr)([this.d_,t,e],n))}catch(t){throw Zp(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Fp(nf((t=this.d_).firestore,op),[new ws(t.S_,os.Kt())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=$p(e),i=td(e,(function(e){return new ed(t.firestore,new kp(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))}));return Mp(this.d_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nf(t,uf);var e=nf(t.firestore,op),n=sp(e),r=new xp(e);return function(t,e){var n=this,r=new Ra;return t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=$r(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Tc.Ho(t,e)}))}(t,e)];case 1:return(i=o.sent())instanceof to?n.resolve(i):i instanceof eo?n.resolve(null):n.reject(new ai(si.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ha(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Yf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.S_).then((function(n){return new kp(e,r,t.S_,n,new Np(n instanceof to&&n.Vt,!0),t.v_)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=nf(t,uf);var e=nf(t.firestore,op);return tp(sp(e),t.S_,{source:"server"}).then((function(n){return jp(e,t,n)}))}(this.d_):function(t){t=nf(t,uf);var e=nf(t.firestore,op);return tp(sp(e),t.S_).then((function(n){return jp(e,t,n)}))}(this.d_)).then((function(t){return new ed(e.firestore,new kp(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Yp.gd(this.firestore,t)))},e}(Ql);function Zp(t,e,n){return t.message=t.message.replace(e,n),t}function $p(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!rp(r))return r}return{}}function td(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=rp(t[0])?t[0]:rp(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var ed=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Xp(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.d_.data(t)},e.prototype.get=function(t,e){return this.d_.get(t,e)},e.prototype.isEqual=function(t){return Rp(this.d_,t.d_)},e}(Ql),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.prototype.data=function(t){return this.d_.data(t)},e}(ed),rd=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Xf=new Kp(e),r}return(0,Br.ZT)(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,yp(this.d_,function(t,e,n){var r=e,i=pp("where",t);return new gp(i,r,n)}(t,n,r)))}catch(t){throw Zp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,yp(this.d_,function(t,e){void 0===e&&(e="asc");var n=e,r=pp("orderBy",t);return new mp(r,n)}(t,n)))}catch(t){throw Zp(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,yp(this.d_,function(t){return rf("limit",t),new bp("limit",t,"F")}(t)))}catch(t){throw Zp(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,yp(this.d_,function(t){return rf("limitToLast",t),new bp("limitToLast",t,"L")}(t)))}catch(t){throw Zp(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,yp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _p("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Zp(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,yp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _p("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Zp(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,yp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Zp(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,yp(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new wp("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Zp(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return df(this.d_,t.d_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=nf(t,cf);var e=nf(t.firestore,op),n=sp(e),r=new xp(e);return function(t,e){var n=this,r=new Ra;return t._s.Ps((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,Oc(t,e,!0)];case 1:return a=u.sent(),r=new il(e,a.Rc),i=r.fl(a.documents),o=r.wi(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=u.sent(),a=Ha(s,"Failed to execute query '"+e+" against cache"),n.reject(a),[3,3];case 3:return[2]}}))}))},[4,Yf(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t.C_).then((function(n){return new Dp(e,r,t,n)}))}(this.d_):"server"===(null==t?void 0:t.source)?function(t){t=nf(t,cf);var e=nf(t.firestore,op),n=sp(e),r=new xp(e);return ep(n,t.C_,{source:"server"}).then((function(n){return new Dp(e,r,t,n)}))}(this.d_):function(t){t=nf(t,cf);var e=nf(t.firestore,op),n=sp(e),r=new xp(e);return dp(t.C_),ep(n,t.C_).then((function(n){return new Dp(e,r,t,n)}))}(this.d_)).then((function(t){return new od(e.firestore,new Dp(e.firestore.d_,e.Xf,e.d_,t._d))}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=$p(e),i=td(e,(function(e){return new od(t.firestore,new Dp(t.firestore.d_,t.Xf,t.d_,e._d))}));return Mp(this.d_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Yp.gd(this.firestore,t)))},e}(Ql),id=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new nd(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),e}(Ql),od=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).Yf=e,r}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new rd(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map((function(e){return new nd(t.Yf,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map((function(t){return new id(e.Yf,t)}))},e.prototype.forEach=function(t,e){var n=this;this.d_.forEach((function(r){t.call(e,new nd(n.Yf,r))}))},e.prototype.isEqual=function(t){return Rp(this.d_,t.d_)},e}(Ql),sd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.d_=n,r}return(0,Br.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Xp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Xp(this.firestore,void 0===t?ff(this.d_):ff(this.d_,t))}catch(t){throw Zp(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=nf(t.firestore,op),r=ff(t),i=Cp(t.v_,e);return Fp(n,[If(Ef(t.firestore),"addDoc",r.S_,i,null!==t.v_,{}).F_(r.S_,os.exists(!1))]).then((function(){return r}))}(this.d_,t).then((function(t){return new Xp(e.firestore,t)}))},e.prototype.isEqual=function(t){return pf(this.d_,t.d_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.d_.withConverter(Yp.gd(this.firestore,t)))},e}(rd);function ad(t){return t instanceof Ql&&(t=t.d_),nf(t,uf)}var ud=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(Kl.bind.apply(Kl,(0,Br.pr)([void 0],e))))||this}return(0,Br.ZT)(e,t),e.documentId=function(){return new e(wi.ht().rt())},e.prototype.isEqual=function(t){return t instanceof Ql&&(t=t.d_),t instanceof Kl&&this.d_.f_.isEqual(t.f_)},e}(Ql),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,Br.ZT)(e,t),e.serverTimestamp=function(){var t=new Cf("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Tf("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Af("arrayUnion",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nf("arrayRemove",t)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new kf("increment",t)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},e}(Ql);var hd,ld,fd=n(909),pd={Firestore:zp,GeoPoint:vf,Timestamp:yi,Blob:Wp,Transaction:Jp,WriteBatch:Qp,DocumentReference:Xp,DocumentSnapshot:ed,Query:rd,QueryDocumentSnapshot:nd,QuerySnapshot:od,CollectionReference:sd,FieldPath:ud,FieldValue:cd,setLogLevel:function(t){var e;e=t,Hr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new fd.wA("firestore",(function(t){return function(t,e){return new zp(t,new op(t,e),new Hp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},pd)))})(hd=b.Z),hd.registerVersion("@firebase/firestore","2.1.6"),(ld=zp).prototype.loadBundle=function(t){return function(t,e){var n=sp(t=nf(t,op)),r=new ip;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new zl(t,e)}(function(t,e){if(t instanceof Uint8Array)return Wl(t,e);if(t instanceof ArrayBuffer)return Wl(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,lh(e));t._s.Ps((function(){return(0,Br.mG)(i,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return e=Ul,[4,Zf(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t.I_,e,r),r}(this.d_,t)},ld.prototype.namedQuery=function(t){var e,n,r=this;return(e=this.d_,n=t,function(t,e){var n=this;return t._s.enqueue((function(){return(0,Br.mG)(n,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=$r(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.wo.Ms(t,e)}))},[4,Yf(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(sp(e=nf(e,op)),n).then((function(t){return t?new cf(e,null,t.query):null}))).then((function(t){return t?new rd(r,t):null}))};var dd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},vd=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return(0,Br.ZT)(e,t),e}(Error),yd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t;return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function gd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var md,bd,_d,wd=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return gd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?gd(t,(function(t){return e.decode(t)})):t},t}(),Ed=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new wd,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new yd(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var s=new URL(r);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a,u,c,h,l,f,p;return(0,Br.Jh)(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(s=d.sent()).authToken&&(o.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=s.instanceIdToken),a=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new vd("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(a),c=u.timer,h=u.promise,[4,Promise.race([Id(c,this.postJSON(r,i,o)),h,Id(c,this.cancelAllRequests)])];case 2:if(!(l=d.sent()))throw new vd("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!dd[a])return new vd("internal","internal");r=dd[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new vd(r,i,o)}(l.status,l.json,this.serializer))throw f;if(!l.json)throw new vd("internal","Response is not valid JSON object.");if(void 0===(p=l.json.data)&&(p=l.json.result),void 0===p)throw new vd("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function Id(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}md=b.Z,bd=fetch.bind(self),_d={Functions:Ed},md.INTERNAL.registerComponent(new fd.wA("functions",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new Ed(n,r,i,e,bd)}),"PUBLIC").setServiceProps(_d).setMultipleInstances(!0)),b.Z.registerVersion("@firebase/functions","0.6.1");var Td,Sd=n(676),Cd="w:0.4.19",Ad=((Td={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Td["not-registered"]="Firebase Installation is not registered.",Td["installation-not-found"]="Firebase Installation not found.",Td["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Td["app-offline"]="Could not process request. Application offline.",Td["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Td),Nd=new L.LL("installations","Installations",Ad);function kd(t){return t instanceof L.ZR&&t.code.includes("request-failed")}function Pd(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function Dd(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function Od(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,Nd.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function Rd(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function xd(t,e){var n=e.refreshToken,r=Rd(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function Ld(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Md(t,e){var n=e.fid;return(0,Br.mG)(this,void 0,void 0,(function(){var e,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return e=Pd(t),r=Rd(t),i={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:Cd},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,Ld((function(){return fetch(e,o)}))];case 1:return(s=u.sent()).ok?[4,s.json()]:[3,3];case 2:return[2,{fid:(a=u.sent()).fid||n,registrationStatus:2,refreshToken:a.refreshToken,authToken:Dd(a.authToken)}];case 3:return[4,Od("Create Installation",s)];case 4:throw u.sent()}}))}))}function Fd(t){return new Promise((function(e){setTimeout(e,t)}))}var jd=/^[cdef][\w-]{21}$/;function Ud(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,(0,Br.fl)(e))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return jd.test(e)?e:""}catch(t){return""}}function Vd(t){return t.appName+"!"+t.appId}var qd=new Map;function Bd(t,e){var n=Vd(t);Gd(n,e),function(t,e){var n=Hd();n&&n.postMessage({key:t,fid:e}),zd()}(n,e)}function Gd(t,e){var n,r,i=qd.get(t);if(i)try{for(var o=(0,Br.XA)(i),s=o.next();!s.done;s=o.next())(0,s.value)(e)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var Wd=null;function Hd(){return!Wd&&"BroadcastChannel"in self&&((Wd=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Gd(t.data.key,t.data.fid)}),Wd}function zd(){0===qd.size&&Wd&&(Wd.close(),Wd=null)}var Kd,Jd="firebase-installations-store",Qd=null;function Yd(){return Qd||(Qd=(0,Sd.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Jd)}}))),Qd}function Xd(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return n=Vd(t),[4,Yd()];case 1:return r=a.sent(),i=r.transaction(Jd,"readwrite"),[4,(o=i.objectStore(Jd)).get(n)];case 2:return s=a.sent(),[4,o.put(e,n)];case 3:return a.sent(),[4,i.complete];case 4:return a.sent(),s&&s.fid===e.fid||Bd(t,e.fid),[2,e]}}))}))}function Zd(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return e=Vd(t),[4,Yd()];case 1:return n=i.sent(),[4,(r=n.transaction(Jd,"readwrite")).objectStore(Jd).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function $d(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return n=Vd(t),[4,Yd()];case 1:return r=u.sent(),i=r.transaction(Jd,"readwrite"),[4,(o=i.objectStore(Jd)).get(n)];case 2:return s=u.sent(),void 0!==(a=e(s))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(a,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!a||s&&s.fid===a.fid||Bd(t,a.fid),[2,a]}}))}))}function tv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,$d(t,(function(n){var r=function(t){return rv(t||{fid:Ud(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Nd.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Md(t,e)];case 1:return n=i.sent(),[2,Xd(t,n)];case 2:return kd(r=i.sent())&&409===r.customData.serverCode?[4,Zd(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Xd(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:ev(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function ev(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return[4,nv(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Fd(100)];case 3:return o.sent(),[4,nv(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,tv(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function nv(t){return $d(t,(function(t){if(!t)throw Nd.create("installation-not-found");return rv(t)}))}function rv(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function iv(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return(0,Br.mG)(this,void 0,void 0,(function(){var t,i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:return t=function(t,e){var n=e.fid;return Pd(t)+"/"+n+"/authTokens:generate"}(n,e),i=xd(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),s={installation:{sdkVersion:Cd}},a={method:"POST",headers:i,body:JSON.stringify(s)},[4,Ld((function(){return fetch(t,a)}))];case 1:return(u=c.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,Dd(c.sent())];case 3:return[4,Od("Generate Auth Token",u)];case 4:throw c.sent()}}))}))}function ov(t,e){return void 0===e&&(e=!1),(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return[4,$d(t.appConfig,(function(r){if(!av(r))throw Nd.create("not-registered");var i,o=r.authToken;if(!e&&(2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return r;if(1===o.requestStatus)return n=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,sv(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Fd(100)];case 3:return i.sent(),[4,sv(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,ov(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw Nd.create("app-offline");var s=function(t){var e={requestStatus:1,requestTime:Date.now()};return(0,Br.pi)((0,Br.pi)({},t),{authToken:e})}(r);return n=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,iv(t,e)];case 1:return n=o.sent(),i=(0,Br.pi)((0,Br.pi)({},e),{authToken:n}),[4,Xd(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!kd(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Zd(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=(0,Br.pi)((0,Br.pi)({},e),{authToken:{requestStatus:0}}),[4,Xd(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,s),s}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function sv(t){return $d(t,(function(t){if(!av(t))throw Nd.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?(0,Br.pi)((0,Br.pi)({},t),{authToken:{requestStatus:0}}):t}))}function av(t){return void 0!==t&&2===t.registrationStatus}function uv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,tv(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function cv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return n=function(t,e){var n=e.fid;return Pd(t)+"/"+n}(t,e),r=xd(t,e),i={method:"DELETE",headers:r},[4,Ld((function(){return fetch(n,i)}))];case 1:return(o=s.sent()).ok?[3,3]:[4,Od("Delete Installation",o)];case 2:throw s.sent();case 3:return[2]}}))}))}function hv(t){return Nd.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new fd.wA("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw hv("App Configuration");if(!t.name)throw hv("App Name");try{for(var r=(0,Br.XA)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw hv(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,tv(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):ov(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,uv(t.appConfig)];case 1:return n.sent(),[4,ov(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,$d(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw Nd.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw Nd.create("app-offline");case 3:return[4,cv(e,n)];case 4:return r.sent(),[4,Zd(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){Hd();var n=Vd(t),r=qd.get(n);r||(r=new Set,qd.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=Vd(t),r=qd.get(n);r&&(r.delete(e),0===r.size&&qd.delete(n),zd())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.19")}(b.Z);var lv,fv=((Kd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Kd["only-available-in-window"]="This method is available in a Window context.",Kd["only-available-in-sw"]="This method is available in a service worker context.",Kd["permission-default"]="The notification permission was not granted and dismissed instead.",Kd["permission-blocked"]="The notification permission was not granted and blocked instead.",Kd["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Kd["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Kd["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Kd["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Kd["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Kd["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Kd["token-update-no-token"]="FCM returned no token when updating the user to push.",Kd["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Kd["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Kd["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Kd["invalid-vapid-key"]="The public VAPID key must be a string.",Kd["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Kd),pv=new L.LL("messaging","Messaging",fv),dv="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function vv(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,(0,Br.fl)(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function yv(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(lv||(lv={}));var gv="fcm_token_details_db",mv="fcm_token_object_Store";function bv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes(gv))return[2,null];r.label=2;case 2:return e=null,[4,(0,Sd.openDb)(gv,5,(function(r){return(0,Br.mG)(n,void 0,void 0,(function(){var n,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains(mv)?[4,(n=r.transaction.objectStore(mv)).index("fcmSenderId").get(t)]:[2];case 1:return i=a.sent(),[4,n.clear()];case 2:if(a.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(s=o.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:vv(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:vv(o.auth),p256dh:vv(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:vv(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,(0,Sd.deleteDb)(gv)];case 4:return r.sent(),[4,(0,Sd.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,Sd.deleteDb)("undefined")];case 6:return r.sent(),[2,_v(e)?e:null]}}))}))}function _v(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var wv="firebase-messaging-store",Ev=null;function Iv(){return Ev||(Ev=(0,Sd.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(wv)}}))),Ev}function Tv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return e=Av(t),[4,Iv()];case 1:return[4,i.sent().transaction(wv).objectStore(wv).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,bv(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,Sv(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function Sv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return n=Av(t),[4,Iv()];case 1:return r=o.sent(),[4,(i=r.transaction(wv,"readwrite")).objectStore(wv).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Cv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return e=Av(t),[4,Iv()];case 1:return n=i.sent(),[4,(r=n.transaction(wv,"readwrite")).objectStore(wv).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Av(t){return t.appConfig.appId}function Nv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return[4,Ov(t)];case 1:n=u.sent(),r=Rv(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Dv(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw s=u.sent(),pv.create("token-subscribe-failed",{errorInfo:s});case 6:if(o.error)throw a=o.error.message,pv.create("token-subscribe-failed",{errorInfo:a});if(!o.token)throw pv.create("token-subscribe-no-token");return[2,o.token]}}))}))}function kv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return[4,Ov(t)];case 1:n=u.sent(),r=Rv(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Dv(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw s=u.sent(),pv.create("token-update-failed",{errorInfo:s});case 6:if(o.error)throw a=o.error.message,pv.create("token-update-failed",{errorInfo:a});if(!o.token)throw pv.create("token-update-no-token");return[2,o.token]}}))}))}function Pv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return[4,Ov(t)];case 1:n=a.sent(),r={method:"DELETE",headers:n},a.label=2;case 2:return a.trys.push([2,5,,6]),[4,fetch(Dv(t.appConfig)+"/"+e,r)];case 3:return[4,a.sent().json()];case 4:if((i=a.sent()).error)throw o=i.error.message,pv.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw s=a.sent(),pv.create("token-unsubscribe-failed",{errorInfo:s});case 6:return[2]}}))}))}function Dv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function Ov(t){var e=t.appConfig,n=t.installations;return(0,Br.mG)(this,void 0,void 0,(function(){var t;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function Rv(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==dv&&(o.web.applicationPubKey=i),o}function xv(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:if("granted"!==Notification.permission)throw pv.create("permission-blocked");return[4,jv(e,n)];case 1:return r=a.sent(),[4,Tv(t)];case 2:return i=a.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:vv(r.getKey("auth")),p256dh:vv(r.getKey("p256dh"))},i?[3,3]:[2,Fv(t,o)];case 3:if(u=i.subscriptionOptions,h=(c=o).vapidKey===u.vapidKey,l=c.endpoint===u.endpoint,f=c.auth===u.auth,p=c.p256dh===u.p256dh,h&&l&&f&&p)return[3,8];a.label=4;case 4:return a.trys.push([4,6,,7]),[4,Pv(t,i.token)];case 5:return a.sent(),[3,7];case 6:return s=a.sent(),console.warn(s),[3,7];case 7:return[2,Fv(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Mv({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,h,l,f,p}))}))}function Lv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,Tv(t)];case 1:return(n=i.sent())?[4,Pv(t,n.token)]:[3,4];case 2:return i.sent(),[4,Cv(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Mv(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,5]),[4,kv(e,t)];case 1:return r=s.sent(),i=(0,Br.pi)((0,Br.pi)({},t),{token:r,createTime:Date.now()}),[4,Sv(e,i)];case 2:return s.sent(),[2,r];case 3:return o=s.sent(),[4,Lv(e,n)];case 4:throw s.sent(),o;case 5:return[2]}}))}))}function Fv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,Nv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,Sv(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function jv(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:yv(e)})]}}))}))}function Uv(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function Vv(t){return new Promise((function(e){setTimeout(e,t)}))}var qv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw pv.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,Tv(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:dv,r.label=2;case 2:return[2,xv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return Lv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw pv.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw pv.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw pv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw pv.create("only-available-in-window")},t.prototype.onMessage=function(){throw pv.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw pv.create("only-available-in-window")},t.prototype.onPush=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,Hv()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Wv(n,e)]:(r=!1,e.notification?[4,zv(Bv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,Vv(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return(0,Br.mG)(this,void 0,void 0,(function(){var r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Lv(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,Tv(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Lv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,xv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:dv)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;return i||(Uv(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),s=new URL(self.location.origin),o.host!==s.host?[2]:[4,Gv(o)]):[2]):[2];case 1:return(a=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return a=u.sent(),[4,Vv(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,a.focus()];case 5:a=u.sent(),u.label=6;case 6:return a?(r.messageType=lv.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,a.postMessage(r)]):[2]}}))}))},t}();function Bv(t){var e,n=(0,Br.pi)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function Gv(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i,o,s,a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return[4,Hv()];case 1:e=u.sent();try{for(n=(0,Br.XA)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){s={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(s)throw s.error}}return[2,null]}}))}))}function Wv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=lv.PUSH_RECEIVED;try{for(var i=(0,Br.XA)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Hv(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function zv(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Kv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===lv.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),Uv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw pv.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,xv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=dv),[2]}))}))},t.prototype.updateSwReg=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw pv.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),pv.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Lv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t;return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?pv.create("permission-blocked"):pv.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw pv.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw pv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw pv.create("invalid-sw-registration");if(this.swRegistration)throw pv.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw pv.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw pv.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case lv.NOTIFICATION_CLICKED:return"notification_open";case lv.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Jv(t){return pv.create("missing-app-config-values",{valueName:t})}var Qv={isSupported:Yv};function Yv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}b.Z.INTERNAL.registerComponent(new fd.wA("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Jv("App Configuration Object");if(!t.name)throw Jv("App Name");var r=t.options;try{for(var i=(0,Br.XA)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw Jv(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Yv())throw pv.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new qv(n):new Kv(n)}),"PUBLIC").setServiceProps(Qv));var Xv="firebasestorage.googleapis.com",Zv=function(t){function e(n,r){var i=t.call(this,ny(n),"Firebase Storage: "+r+" ("+ny(n)+")")||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,e.prototype),i}return(0,Br.ZT)(e,t),e.prototype.codeEquals=function(t){return ny(t)===this.code},Object.defineProperty(e.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t},enumerable:!1,configurable:!0}),e}(L.ZR),$v="canceled",ty="invalid-argument",ey="unsupported-environment";function ny(t){return"storage/"+t}function ry(){return new Zv("unknown","An unknown error occurred, please check the error payload for server response.")}function iy(){return new Zv($v,"User canceled the upload/download.")}function oy(){return new Zv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function sy(t){return new Zv(ty,t)}function ay(){return new Zv("app-deleted","The Firebase app was deleted.")}function uy(t){return new Zv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function cy(t,e){return new Zv("invalid-format","String does not match format '"+t+"': "+e)}function hy(t){throw new Zv("internal-error","Internal error: "+t)}var ly={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},fy=function(t,e){this.data=t,this.contentType=e||null};function py(t,e){switch(t){case ly.RAW:return new fy(dy(e));case ly.BASE64:case ly.BASE64URL:return new fy(vy(t,e));case ly.DATA_URL:return new fy((n=new gy(e)).base64?vy(ly.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw cy(ly.DATA_URL,"Malformed data URL.")}return dy(e)}(n.rest),new gy(e).contentType)}var n;throw ry()}function dy(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function vy(t,e){switch(t){case ly.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw cy(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case ly.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw cy(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(e){throw cy(t,"Invalid character found")}for(var a=new Uint8Array(s.length),u=0;u<s.length;u++)a[u]=s.charCodeAt(u);return a}var yy,gy=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw cy(ly.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},my={STATE_CHANGED:"state_changed"},by="running",_y="pausing",wy="paused",Ey="success",Iy="canceling",Ty="canceled",Sy="error",Cy={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ay(t){switch(t){case by:case _y:case Iy:return Cy.RUNNING;case wy:return Cy.PAUSED;case Ey:return Cy.SUCCESS;case Ty:return Cy.CANCELED;case Sy:default:return Cy.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(yy||(yy={}));var Ny=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=yy.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=yy.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=yy.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw hy("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw hy("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw hy("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw hy("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),ky=function(){function t(){}return t.prototype.createXhrIo=function(){return new Ny},t}();function Py(t){return"string"==typeof t||t instanceof String}function Dy(t){return Oy()&&t instanceof Blob}function Oy(){return"undefined"!=typeof Blob}function Ry(t,e,n,r){if(r<e)throw new Zv(ty,"Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw new Zv(ty,"Invalid value for '"+t+"'. Expected "+n+" or less.")}function xy(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Ly(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=xy();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(Oy())return new Blob(t);throw new Zv(ey,"This browser doesn't seem to support creating Blobs")}var My=function(){function t(t,e){var n=0,r="";Dy(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Dy(this.data_)){var r=(i=this.data_,o=e,s=n,i.webkitSlice?i.webkitSlice(o,s):i.mozSlice?i.mozSlice(o,s):i.slice?i.slice(o,s):null);return null===r?null:new t(r)}var i,o,s;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(Oy()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Ly.apply(null,r))}var i=e.map((function(t){return Py(t)?py(ly.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var s=new Uint8Array(o),a=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)s[a++]=t[e]})),new t(s,!0)},t.prototype.uploadData=function(){return this.data_},t}(),Fy=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw new Zv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e){var n=null,r="([A-Za-z0-9.\\-_]+)",i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(t){t.path_=decodeURIComponent(t.path)}for(var s=Xv.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+r+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+r+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:o}],u=0;u<a.length;u++){var c=a[u],h=c.regex.exec(e);if(h){var l=h[c.indices.bucket],f=h[c.indices.path];f||(f=""),n=new t(l,f),c.postModify(n);break}}if(null==n)throw function(t){return new Zv("invalid-url","Invalid URL '"+t+"'.")}(e);return n},t}();function jy(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function Uy(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Vy(t){return"https://"+Xv+"/v0"+t}function qy(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}function By(t,e){return e}var Gy=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||By},Wy=null;function Hy(){if(Wy)return Wy;var t=[];t.push(new Gy("bucket")),t.push(new Gy("generation")),t.push(new Gy("metageneration")),t.push(new Gy("name","fullPath",!0));var e=new Gy("name");e.xform=function(t,e){return function(t){return!Py(t)||t.length<2?t:Uy(t)}(e)},t.push(e);var n=new Gy("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Gy("timeCreated")),t.push(new Gy("updated")),t.push(new Gy("md5Hash",null,!0)),t.push(new Gy("cacheControl",null,!0)),t.push(new Gy("contentDisposition",null,!0)),t.push(new Gy("contentEncoding",null,!0)),t.push(new Gy("contentLanguage",null,!0)),t.push(new Gy("contentType",null,!0)),t.push(new Gy("metadata","customMetadata",!0)),Wy=t}function zy(t,e,n){var r=jy(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Fy(n,r);return e.makeStorageReference(i)}})}(r,t),r}(t,r,n)}function Ky(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var Jy=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Qy(t){if(!t)throw ry()}function Yy(t,e){return function(n,r){var i=zy(t,r,e);return Qy(null!==i),i}}function Xy(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new Zv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Zv("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Zv("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function Zy(t){var e=Xy(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Zv("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function $y(t,e,n){var r=Vy(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Jy(r,"GET",Yy(t,n),i);return o.errorHandler=Zy(e),o}function tg(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var s=Vy(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime,u=new Jy(s,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=jy(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var s=o[i].replace(/\/$/,""),a=t.makeStorageReference(new Fy(e,s));r.prefixes.push(a)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var h=c[u];a=t.makeStorageReference(new Fy(e,h.name)),r.items.push(a)}return r}(t,e,r)}(t,e,r);return Qy(null!==i),i}}(t,e.bucket),a);return u.urlParams=o,u.errorHandler=Xy(e),u}function eg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var ng=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function rg(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Qy(!1)}return Qy(!!n&&-1!==(e||["active"]).indexOf(n)),n}var ig=262144;var og=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}},sg=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function ag(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var ug=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Hy(),this._resumable=this._shouldDoResumable(this._blob),this._state=by,this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t.codeEquals($v)?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition(Sy))},this._metadataErrorHandler=function(t){r._request=void 0,t.codeEquals($v)?r.completeTransitions_():(r._error=t,r._transition(Sy))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){this._state===by&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage.getAuthToken().then((function(n){switch(e._state){case by:t(n);break;case Iy:e._transition(Ty);break;case _y:e._transition(wy)}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s=eg(e,r,i),a={name:s.fullPath},u=Vy(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},h=Ky(s,n),l=t.maxUploadRetryTime,f=new Jy(u,"POST",(function(t){var e;rg(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Qy(!1)}return Qy(Py(e)),e}),l);return f.urlParams=a,f.headers=c,f.body=h,f.errorHandler=Xy(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new Jy(n,"POST",(function(t){var e=rg(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Qy(!1)}n||Qy(!1);var i=Number(n);return Qy(!isNaN(i)),new ng(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Xy(e),o}(t._ref.storage,t._ref._location,e,t._blob),i=t._ref.storage.makeRequest(r,n);t._request=i,i.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=ig*this._chunkMultiplier,n=new ng(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i){var o;try{o=function(t,e,n,r,i,o,s,a){var u=new ng(0,0);if(s?(u.current=s.current,u.total=s.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Zv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,p={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(l,f);if(null===d)throw oy();var v=e.maxUploadRetryTime,y=new Jy(n,"POST",(function(t,n){var i,s=rg(t,["active","final"]),a=u.current+h,c=r.size();return i="final"===s?Yy(e,o)(t,n):null,new ng(a,c,"final"===s,i)}),v);return y.headers=p,y.body=d.uploadData(),y.progressCallback=a||null,y.errorHandler=Xy(t),y}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition(Sy)}var s=t._ref.storage.makeRequest(o,i);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition(Ey)):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){ig*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=$y(t._ref.storage,t._ref._location,t._mappings),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition(Ey)}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+a;var u=eg(e,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Ky(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+a+"--",l=My.getBlob(c,r,h);if(null===l)throw oy();var f={name:u.fullPath},p=Vy(o),d=t.maxUploadRetryTime,v=new Jy(p,"POST",Yy(t,n),d);return v.urlParams=f,v.headers=s,v.body=l.uploadData(),v.errorHandler=Xy(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage.makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition(Ey)}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case Iy:case _y:this._state=t,void 0!==this._request&&this._request.cancel();break;case by:var e=this._state===wy;this._state=t,e&&(this._notifyObservers(),this._start());break;case wy:this._state=t,this._notifyObservers();break;case Ty:this._error=iy(),this._state=t,this._notifyObservers();break;case Sy:case Ey:this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case _y:this._transition(wy);break;case Iy:this._transition(Ty);break;case by:this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Ay(this._state);return new sg(this._transferred,this._blob.size(),t,this._metadata,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new og(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(Ay(this._state)){case Cy.SUCCESS:ag(this._resolve.bind(null,this.snapshot))();break;case Cy.CANCELED:case Cy.ERROR:ag(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(Ay(this._state)){case Cy.RUNNING:case Cy.PAUSED:t.next&&ag(t.next.bind(t,this.snapshot))();break;case Cy.SUCCESS:t.complete&&ag(t.complete.bind(t))();break;case Cy.CANCELED:case Cy.ERROR:t.error&&ag(t.error.bind(t,this._error))();break;default:t.error&&ag(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t=this._state===wy||this._state===_y;return t&&this._transition(by),t},t.prototype.pause=function(){var t=this._state===by;return t&&this._transition(_y),t},t.prototype.cancel=function(){var t=this._state===by||this._state===_y;return t&&this._transition(Iy),t},t}(),cg=function(){function t(t,e){this._service=t,this._location=e instanceof Fy?e:Fy.makeFromUrl(e)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype.newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Fy(this._location.bucket,"");return this.newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Uy(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Fy(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw uy(t)},t}();function hg(t){var e={prefixes:[],items:[]};return lg(t,e).then((function(){return e}))}function lg(t,e,n){return(0,Br.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return[4,fg(t,{pageToken:n})];case 1:return r=s.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,lg(t,e,r.nextPageToken)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function fg(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return null!=e&&"number"==typeof e.maxResults&&Ry("options.maxResults",1,1e3,e.maxResults),[4,t.storage.getAuthToken()];case 1:return n=o.sent(),r=e||{},i=tg(t.storage,t._location,"/",r.pageToken,r.maxResults),[2,t.storage.makeRequest(i,n).getPromise()]}}))}))}function pg(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e,n){var r=Vy(e.fullServerUrl()),i=t.maxOperationRetryTime,o=new Jy(r,"GET",function(t,e){return function(n,r){var i=zy(t,r,e);return Qy(null!==i),function(t,e){var n=jy(e);if(null===n)return null;if(!Py(n.downloadTokens))return null;var r=n.downloadTokens;if(0===r.length)return null;var i=encodeURIComponent;return r.split(",").map((function(e){var n=t.bucket,r=t.fullPath;return Vy("/b/"+i(n)+"/o/"+i(r))+qy({alt:"media",token:e})}))[0]}(i,r)}}(t,n),i);return o.errorHandler=Zy(e),o}(t.storage,t._location,Hy()),[2,t.storage.makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new Zv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function dg(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Fy(t._location.bucket,n);return new cg(t.storage,r)}var vg=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),yg=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate),this._snapshot=new vg(this._delegate.snapshot,this,this._ref)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new vg(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new vg(t,i,i._ref))}:{next:e.next?function(t){return e.next(new vg(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),gg=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new mg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new mg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),mg=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(dg(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new yg(function(t,e,n){return void 0===n&&(n=null),t._throwIfRoot("uploadBytesResumable"),new ug(t,new My(e),n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){return void 0===e&&(e=ly.RAW),this._throwIfRoot("putString"),new yg(function(t,e,n,r){void 0===n&&(n=ly.RAW),t._throwIfRoot("putString");var i=py(n,e),o=(0,Br.pi)({},r);return null==o.contentType&&null!=i.contentType&&(o.contentType=i.contentType),new ug(t,new My(i.data,!0),o)}(this._delegate,t,e,n),this)},t.prototype.listAll=function(){var t=this;return hg(this._delegate).then((function(e){return new gg(e,t.storage)}))},t.prototype.list=function(t){var e=this;return fg(this._delegate,t).then((function(t){return new gg(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=$y(t.storage,t._location,Hy()),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage.getAuthToken()];case 1:return n=i.sent(),r=function(t,e,n,r){var i=Vy(e.fullServerUrl()),o=Ky(n,r),s=t.maxOperationRetryTime,a=new Jy(i,"PATCH",Yy(t,r),s);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=Zy(e),a}(t.storage,t._location,e,Hy()),[2,t.storage.makeRequest(r,n).getPromise()]}}))}))}(this._delegate,t)},t.prototype.getDownloadURL=function(){return pg(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage.getAuthToken()];case 1:return e=r.sent(),n=function(t,e){var n=Vy(e.fullServerUrl()),r=t.maxOperationRetryTime,i=new Jy(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=Zy(e),i}(t.storage,t._location),[2,t.storage.makeRequest(n,e).getPromise()]}}))}))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw uy(t)},t}(),bg=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}(),_g=function(){function t(t,e,n,r,i,o,s,a,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=s,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,s=n.xhr;if(n.wasSuccessCode)try{var a=t.callback_(s,s.getResponseText());!function(t){return void 0!==t}(a)?i():i(a)}catch(t){o(t)}else null!==s?((r=ry()).serverResponse=s.getResponseText(),t.errorCallback_?o(t.errorCallback_(s,r)):o(r)):n.canceled?o(r=t.appDelete_?ay():iy()):o(r=new Zv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new wg(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,s=!1,a=0;function u(){return 2===a}var c=!1;function h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function l(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new wg(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===yy.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var s=-1!==t.successCodes_.indexOf(o);e(!0,new wg(s,n))}else{var a=n.getErrorCode()===yy.ABORT;e(!1,new wg(!1,null,a))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)h.call.apply(h,(0,Br.pr)([null,t],e));else{var r;u()||s?h.call.apply(h,(0,Br.pr)([null,t],e)):(i<64&&(i*=2),1===a?(a=2,r=0):r=1e3*(i+Math.random()),l(r))}}var p=!1;function d(t){p||(p=!0,c||(null!==o?(t||(a=2),clearTimeout(o),l(0)):t||(a=1)))}return l(0),setTimeout((function(){s=!0,d(!0)}),r),d}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),wg=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function Eg(t){return/^[A-Za-z]+:\/\//.test(t)}function Ig(t,e){if(t instanceof Sg){var n=t;if(null==n._bucket)throw new Zv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new cg(n,n._bucket);return null!=e?Ig(r,e):r}if(void 0!==e){if(e.includes(".."))throw sy('`path` param cannot contain ".."');return dg(t,e)}return t}function Tg(t,e){if(e&&Eg(e)){if(t instanceof Sg)return new cg(t,e);throw sy("To use ref(service, url), the first argument must be a Storage instance.")}return Ig(t,e)}var Sg=function(){function t(t,e,n,r){var i,o;this.app=t,this._authProvider=e,this._pool=n,this._url=r,this._bucket=null,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Fy.makeFromBucketSpec(r):null==(o=null==(i=this.app.options)?void 0:i.storageBucket)?null:Fy.makeFromBucketSpec(o)}return Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){Ry("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){Ry("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype.getAuthToken=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype.makeStorageReference=function(t){return new cg(this,t)},t.prototype.makeRequest=function(t,e){var n=this;if(this._deleted)return new bg(ay());var r=function(t,e,n,r){var i=qy(t.urlParams),o=t.url+i,s=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(s,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(s,n),function(t){var e=void 0!==b.Z?b.Z.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(s),new _g(o,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this._appId,e,this._pool);return this._requests.add(r),r.getPromise().then((function(){return n._requests.delete(r)}),(function(){return n._requests.delete(r)})),r},t}(),Cg=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Eg(t))throw sy("ref() expected a child path but got a URL, use refFromURL instead.");return new mg(Tg(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Eg(t))throw sy("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Fy.makeFromUrl(t)}catch(t){throw sy("refFromUrl() expected a valid full URL but got an invalid one.")}return new mg(Tg(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t}();function Ag(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new Cg(n,new Sg(n,r,new ky,e))}!function(t){var e={TaskState:Cy,TaskEvent:my,StringFormat:ly,Storage:Sg,Reference:mg};t.INTERNAL.registerComponent(new fd.wA("storage",Ag,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.4.2")}(b.Z);var Ng,kg,Pg,Dg="0.4.5",Og=Dg,Rg="FB-PERF-TRACE-MEASURE",xg="_wt_",Lg="_fcp",Mg="_fid",Fg="@firebase/performance/config",jg="@firebase/performance/configexpire",Ug="Performance",Vg=((Ng={})["trace started"]="Trace {$traceName} was started before.",Ng["trace stopped"]="Trace {$traceName} is not running.",Ng["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Ng["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Ng["no window"]="Window is not available.",Ng["no app id"]="App id is not available.",Ng["no project id"]="Project id is not available.",Ng["no api key"]="Api key is not available.",Ng["invalid cc log"]="Attempted to queue invalid cc event",Ng["FB not default"]="Performance can only start when Firebase app instance is the default one.",Ng["RC response not ok"]="RC response is not ok",Ng["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Ng["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Ng["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Ng["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Ng),qg=new L.LL("performance",Ug,Vg),Bg=new x.Yd(Ug);Bg.logLevel=x.in.INFO;var Gg,Wg=function(){function t(t){if(this.window=t,!t)throw qg.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,L.hl)()||(Bg.info("IndexedDB is not supported by current browswer"),!1):(Bg.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===kg&&(kg=new t(Pg)),kg},t}();function Hg(t,e){var n=t.length-e.length;if(n<0||n>1)throw qg.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var zg,Kg,Jg=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Hg("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Hg("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw qg.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw qg.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw qg.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Gg&&(Gg=new t),Gg},t}();function Qg(){return zg}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Kg||(Kg={}));var Yg=["firebase_","google_","ga_"],Xg=new RegExp("^[a-zA-Z]\\w*$");function Zg(){var t=Wg.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function $g(){switch(Wg.getInstance().document.visibilityState){case"visible":return Kg.VISIBLE;case"hidden":return Kg.HIDDEN;default:return Kg.UNKNOWN}}function tm(){var t=Wg.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var em="Could not fetch config, will use default configs";function nm(t){if(!t)return t;var e=Jg.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=rm(e.tracesSamplingRate),e.logNetworkAfterSampling=rm(e.networkRequestsSamplingRate),t}function rm(t){return Math.random()<=t}var im,om=1;function sm(){return om=2,im=im||function(){var t=Wg.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=Jg.getInstance().installationsService.getId()).then((function(t){zg=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=Wg.getInstance().localStorage;if(t){var e=t.getItem(jg);if(e&&Number(e)>Date.now()){var n=t.getItem(Fg);if(n)try{return JSON.parse(n)}catch(t){return}}}}();return e?(nm(e),Promise.resolve()):function(t){return(e=Jg.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Jg.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Jg.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Jg.getInstance().getAppId(),app_version:Og,sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw qg.create("RC response not ok")}))})).catch((function(){Bg.info(em)}));var e}(t).then(nm).then((function(t){return function(t){var e=Wg.getInstance().localStorage;t&&e&&(e.setItem(Fg,JSON.stringify(t)),e.setItem(jg,String(Date.now()+60*Jg.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return am()}),(function(){return am()}))}function am(){om=3}var um,cm=1e4,hm=3,lm=[],fm=!1;function pm(t){setTimeout((function(){var t,e;if(0!==hm)return lm.length?(e=(t=lm.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=Jg.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||Bg.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=cm;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(lm=(0,Br.pr)(e,lm),Bg.info("Retry transport request later.")),hm=3,pm(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Jg.getInstance().logSource,log_event:e},t).catch((function(){lm=(0,Br.pr)(t,lm),hm--,Bg.info("Tries left: "+hm+"."),pm(cm)}))):pm(cm)}),t)}function dm(t){if(!t.eventTime||!t.message)throw qg.create("invalid cc log");lm=(0,Br.pr)(lm,[t])}function vm(t,e){um||(um=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];dm({message:t.apply(void 0,e),eventTime:Date.now()})}}(mm)),um(t,e)}function ym(t){var e=Jg.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Wg.getInstance().requiredApisAvailable()&&(t.isAuto&&$g()!==Kg.VISIBLE||(3===om?gm(t):sm().then((function(){return gm(t)}),(function(){return gm(t)}))))}function gm(t){if(Qg()){var e=Jg.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return vm(t,1)}),0)}}function mm(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:bm(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:bm(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function bm(){return{google_app_id:Jg.getInstance().getAppId(),app_instance_id:Qg(),web_app_info:{sdk_version:Og,page_url:Wg.getInstance().getUrl(),service_worker_status:Zg(),visibility_state:$g(),effective_connection_type:tm()},application_process_state:0}}var _m=["_fp",Lg,Mg],wm=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Wg.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw qg.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw qg.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ym(this)},t.prototype.record=function(t,e,n){if(t<=0)throw qg.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw qg.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=(0,Br.pi)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}ym(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||t.length>100)&&(e&&e.startsWith(xg)&&_m.indexOf(t)>-1||!t.startsWith("_"))}(t,this.name))throw qg.create("invalid custom metric name",{customMetricName:t});var n,r;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Bg.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n=function(t){return!(0===t.length||t.length>40||Yg.some((function(e){return t.startsWith(e)}))||!t.match(Xg))}(t),r=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw qg.create("invalid attribute name",{attributeName:t});if(!r)throw qg.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return(0,Br.pi)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Wg.getInstance().getUrl();if(i){var o=new t(xg+i,!0),s=Math.floor(1e3*Wg.getInstance().getTimeOrigin());if(o.setStartTime(s),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var a=n.find((function(t){return"first-paint"===t.name}));a&&a.startTime&&o.putMetric("_fp",Math.floor(1e3*a.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(Lg,Math.floor(1e3*u.startTime)),r&&o.putMetric(Mg,Math.floor(1e3*r))}ym(o)}},t.createUserTimingTrace=function(e){ym(new t(e,!1,e))},t}();function Em(t){var e=t;if(e&&void 0!==e.responseStart){var n=Wg.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Jg.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return vm(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Im(){Qg()&&(setTimeout((function(){return function(){var t=Wg.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){wm.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),wm.createOobTrace(e,n,t))}))}else wm.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Wg.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)Em(n[e]);t.setupObserver("resource",Em)}()}),0),setTimeout((function(){return function(){for(var t=Wg.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)Tm(n[e]);t.setupObserver("measure",Tm)}()}),0))}function Tm(t){var e=t.name;e.substring(0,Rg.length)!==Rg&&wm.createUserTimingTrace(e)}var Sm=function(){function t(t){this.app=t,Wg.getInstance().requiredApisAvailable()&&(0,L.eu)().then((function(t){t&&(fm||(pm(5500),fm=!0),sm().then(Im,Im))})).catch((function(t){Bg.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new wm(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Jg.getInstance().instrumentationEnabled},set:function(t){Jg.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Jg.getInstance().dataCollectionEnabled},set:function(t){Jg.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new fd.wA("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw qg.create("FB not default");if("undefined"==typeof window)throw qg.create("no window");return function(t){Pg=t}(window),Jg.getInstance().firebaseAppInstance=t,Jg.getInstance().installationsService=e,new Sm(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance",Dg)}(b.Z);var Cm,Am,Nm="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(Cm||(Cm={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(Am||(Am={}));var km,Pm=new x.Yd("@firebase/analytics");function Dm(t,e,n,r,i,o){return(0,Br.mG)(this,void 0,void 0,(function(){var s,a,u,c;return(0,Br.Jh)(this,(function(h){switch(h.label){case 0:s=r[i],h.label=1;case 1:return h.trys.push([1,7,,8]),s?[4,e[s]]:[3,3];case 2:return h.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return a=h.sent(),(u=a.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:h.sent(),h.label=6;case 6:return[3,8];case 7:return c=h.sent(),Pm.error(c),[3,8];case 8:return t(Cm.CONFIG,i,o),[2]}}))}))}function Om(t,e,n,r,i){return(0,Br.mG)(this,void 0,void 0,(function(){var o,s,a,u,c,h,l,f;return(0,Br.Jh)(this,(function(p){switch(p.label){case 0:return p.trys.push([0,4,,5]),o=[],i&&i.send_to?(s=i.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(n)]):[3,2];case 1:for(a=p.sent(),u=function(t){var n=a.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,h=s;c<h.length&&(l=h[c],"break"!==u(l));c++);p.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return p.sent(),t(Cm.EVENT,r,i||{}),[3,5];case 4:return f=p.sent(),Pm.error(f),[3,5];case 5:return[2]}}))}))}var Rm=((km={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",km["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",km["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",km["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",km["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",km["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",km["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",km["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',km["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',km),xm=new L.LL("analytics","Analytics",Rm),Lm=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Mm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function Fm(t){var e;return(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:Mm(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(s=c.sent()).status||304===s.status)return[3,6];a="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,s.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(a=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw xm.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a});case 6:return[2,s.json()]}}))}))}function jm(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=Lm),(0,Br.mG)(this,void 0,void 0,(function(){var e,s,a,u,c,h,l;return(0,Br.Jh)(this,(function(f){switch(f.label){case 0:e=t.appId,s=t.measurementId,f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Um(n,i)];case 2:return f.sent(),[3,4];case 3:if(a=f.sent(),s)return Pm.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+a.message+"]"),[2,{appId:e,measurementId:s}];throw a;case 4:return f.trys.push([4,6,,7]),[4,Fm(t)];case 5:return u=f.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof L.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c=f.sent())){if(r.deleteThrottleMetadata(e),s)return Pm.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:e,measurementId:s}];throw c}return h=503===Number(c.customData.httpStatus)?(0,L.$s)(o,r.intervalMillis,30):(0,L.$s)(o,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+h,backoffCount:o+1},r.setThrottleMetadata(e,l),Pm.debug("Calling attemptFetch again in "+h+" millis"),[2,jm(t,l,n,r)];case 7:return[2]}}))}))}function Um(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(xm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Vm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();var qm,Bm,Gm={},Wm=[],Hm={},zm="dataLayer",Km="gtag",Jm=!1;function Qm(t){if(Jm)throw xm.create("already-initialized");t.dataLayerName&&(zm=t.dataLayerName),t.gtagName&&(Km=t.gtagName)}function Ym(t,e){!function(){var t=[];if((0,L.ru)()&&t.push("This is a browser extension environment."),(0,L.zI)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=xm.create("invalid-analytics-context",{errorInfo:e});Pm.warn(n.message)}}();var n=t.options.appId;if(!n)throw xm.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw xm.create("no-api-key");Pm.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Gm[n])throw xm.create("already-exists",{id:n});if(!Jm){(function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(Nm))return r}return null})()||function(t){var e=document.createElement("script");e.src=Nm+"?l="+t,e.async=!0,document.head.appendChild(e)}(zm),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(zm);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,s){return(0,Br.mG)(this,void 0,void 0,(function(){var a;return(0,Br.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Cm.EVENT?[3,2]:[4,Om(t,e,n,o,s)];case 1:return u.sent(),[3,5];case 2:return i!==Cm.CONFIG?[3,4]:[4,Dm(t,e,n,r,o,s)];case 3:return u.sent(),[3,5];case 4:t(Cm.SET,o),u.label=5;case 5:return[3,7];case 6:return a=u.sent(),Pm.error(a),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(Gm,Wm,Hm,zm,Km),i=r.wrappedGtag,o=r.gtagCore;Bm=i,qm=o,Jm=!0}return Gm[n]=function(t,e,n,r,i){return(0,Br.mG)(this,void 0,void 0,(function(){var o,s,a,u,c,h,l;return(0,Br.Jh)(this,(function(f){switch(f.label){case 0:return(o=function(t,e,n){return void 0===e&&(e=Lm),(0,Br.mG)(this,void 0,void 0,(function(){var n,r,i,o,s,a,u=this;return(0,Br.Jh)(this,(function(c){if(n=t.options,r=n.appId,i=n.apiKey,o=n.measurementId,!r)throw xm.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw xm.create("no-api-key")}return s=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Vm,setTimeout((function(){return(0,Br.mG)(u,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){return a.abort(),[2]}))}))}),6e4),[2,jm({appId:r,apiKey:i,measurementId:o},s,a,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Pm.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Pm.error(t)})),e.push(o),s=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t;return(0,Br.Jh)(this,(function(e){switch(e.label){case 0:return(0,L.hl)()?[3,1]:(Pm.warn(xm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,L.eu)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Pm.warn(xm.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([o,s])];case 1:return a=f.sent(),u=a[0],c=a[1],i("js",new Date),(l={}).origin="firebase",l.update=!0,h=l,null!=c&&(h.firebase_id=c),i(Cm.CONFIG,u.measurementId,h),[2,u.measurementId]}}))}))}(t,Wm,Hm,e,qm),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return(0,Br.mG)(this,void 0,void 0,(function(){var o,s;return(0,Br.Jh)(this,(function(a){switch(a.label){case 0:return i&&i.global?(t(Cm.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=a.sent(),s=(0,Br.pi)((0,Br.pi)({},r),{send_to:o}),t(Cm.EVENT,n,s),a.label=3;case 3:return[2]}}))}))})(Bm,Gm[n],t,e,r).catch((function(t){return Pm.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Cm.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Cm.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(Bm,Gm[n],t,e).catch((function(t){return Pm.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i;return(0,Br.Jh)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Cm.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Cm.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(Bm,Gm[n],t,e).catch((function(t){return Pm.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return(0,Br.mG)(this,void 0,void 0,(function(){var i,o,s,a,u;return(0,Br.Jh)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,s=Object.keys(n);o<s.length;o++)a=s[o],i["user_properties."+a]=n[a];return t(Cm.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Cm.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(Bm,Gm[n],t,e).catch((function(t){return Pm.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Gm[n],t).catch((function(t){return Pm.error(t)}))},INTERNAL:{delete:function(){return delete Gm[n],Promise.resolve()}}}}var Xm="analytics";function Zm(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:if((0,L.ru)())return[2,!1];if(!(0,L.zI)())return[2,!1];if(!(0,L.hl)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,L.eu)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new fd.wA(Xm,(function(t){return Ym(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Qm,EventName:Am,isSupported:Zm})),t.INTERNAL.registerComponent(new fd.wA("analytics-internal",(function(t){try{return{logEvent:t.getProvider(Xm).getImmediate().logEvent}}catch(t){throw xm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.2")}(b.Z);var $m,tb=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=s.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=s.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return s.sent(),[2,i]}}))}))},t}(),eb=(($m={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",$m["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",$m["registration-api-key"]="Undefined API key. Check Firebase app initialization.",$m["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",$m["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",$m["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",$m["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",$m["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",$m["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",$m["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',$m["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',$m["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",$m["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",$m),nb=new L.LL("remoteconfig","Remote Config",eb),rb=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,h,l,f,p,d,v,y,g,m,b;return(0,Br.Jh)(this,(function(_){switch(_.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=_.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:s,body:JSON.stringify(a)},c=fetch(o,u),h=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),_.label=2;case 2:return _.trys.push([2,5,,6]),[4,Promise.race([c,h])];case 3:return _.sent(),[4,c];case 4:return l=_.sent(),[3,6];case 5:throw f=_.sent(),p="fetch-client-network","AbortError"===f.name&&(p="fetch-timeout"),nb.create(p,{originalErrorMessage:f.message});case 6:if(d=l.status,v=l.headers.get("ETag")||void 0,200!==l.status)return[3,11];m=void 0,_.label=7;case 7:return _.trys.push([7,9,,10]),[4,l.json()];case 8:return m=_.sent(),[3,10];case 9:throw b=_.sent(),nb.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:y=m.entries,g=m.state,_.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===g?d=500:"NO_CHANGE"===g?d=304:"NO_TEMPLATE"!==g&&"EMPTY_CONFIG"!==g||(y={}),304!==d&&200!==d)throw nb.create("fetch-status",{httpStatus:d});return[2,{status:d,eTag:v,config:y}]}var w}))}))},t}(),ib=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),ob=["1","true","t","yes","y","on"],sb=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&ob.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),ab=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=x.in.DEBUG;break;case"silent":this._logger.logLevel=x.in.SILENT;break;default:this._logger.logLevel=x.in.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r=this;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:t=new ib,setTimeout((function(){return(0,Br.mG)(r,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=function(t,e){return t instanceof L.ZR&&-1!==t.code.indexOf("fetch-throttle")}(e)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return(0,Br.mG)(this,void 0,void 0,(function(){return(0,Br.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys((0,Br.pi)((0,Br.pi)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new sb("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new sb("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new sb("static"))},t}();function ub(t,e){var n=t.target.error||void 0;return nb.create(e,{originalErrorMessage:n&&n.message})}var cb="app_namespace_store",hb=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(ub(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(cb,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([cb],"readonly").objectStore(cb),s=n.createCompositeKey(t);try{var a=o.get(s);a.onerror=function(t){i(ub(t,"storage-get"))},a.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(nb.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return(0,Br.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,Br.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var s=n.transaction([cb],"readwrite").objectStore(cb),a=r.createCompositeKey(t);try{var u=s.put({compositeKey:a,value:e});u.onerror=function(t){o(ub(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(nb.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,Br.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([cb],"readwrite").objectStore(cb),s=n.createCompositeKey(t);try{var a=o.delete(s);a.onerror=function(t){i(ub(t,"storage-delete"))},a.onsuccess=function(){r()}}catch(t){i(nb.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),lb=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return(0,Br.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=s.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=s.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=s.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function fb(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(nb.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var pb,db=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return(0,Br.mG)(this,void 0,void 0,(function(){var e;return(0,Br.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return(0,Br.mG)(this,void 0,void 0,(function(){var e,i,o;return(0,Br.Jh)(this,(function(s){switch(s.label){case 0:return[4,fb(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof L.ZR&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+(0,L.$s)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),vb="@firebase/remote-config";function yb(t){document.getElementById("plusProject"),document.getElementById("plusTask"),"hide"===t?(plusTask.style.display="none",plusProject.style.display="none"):"show"===t&&(plusTask.style.display="block",plusProject.style.display="block")}(pb=b.Z).INTERNAL.registerComponent(new fd.wA("remoteConfig",(function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw nb.create("registration-window");var i=n.options,o=i.projectId,s=i.apiKey,a=i.appId;if(!o)throw nb.create("registration-project-id");if(!s)throw nb.create("registration-api-key");if(!a)throw nb.create("registration-app-id");e=e||"firebase";var u=new hb(a,n.name,e),c=new lb(u),h=new x.Yd(vb);h.logLevel=x.in.ERROR;var l=new rb(r,pb.SDK_VERSION,e,o,s,a),f=new db(l,u),p=new tb(f,u,c,h),d=new ab(n,p,c,u,h);return d.ensureInitialized(),d}),"PUBLIC").setMultipleInstances(!0)),pb.registerVersion(vb,"0.1.30"),b.Z.registerVersion("firebase","8.2.7","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),b.Z.registerVersion("firebase","8.2.7"),n(690);let gb=document.getElementById("privacy-policy-div"),mb=document.getElementById("privacy-policy-link");function bb(t){for(let e=0;e<t.length;e++)"none"===t[e].style.display?t[e].style.display="block":t[e].style.display="none";!function(){let t=document.getElementById("inputProject");for(;t.firstChild;)t.removeChild(t.firstChild);for(let e=0;e<w.length;e++){let n=document.createElement("option");n.value=w[e],n.text=w[e],t.appendChild(n)}}()}function _b(t){let e="task"===t?plusTask:plusProject;"Hide Form"===e.textContent?e.textContent="New "+t:e.textContent="Hide Form"}n(690);b.Z.initializeApp({apiKey:"AIzaSyB2MEBcXnFbykRaGGyt8bDbiVEJKVCscwA",authDomain:"the-today-list.firebaseapp.com",projectId:"the-today-list",storageBucket:"the-today-list.appspot.com",messagingSenderId:"305659011664",appId:"1:305659011664:web:46d090720b1e11f0d5e755",measurementId:"G-YGTM66E1WK"}),function(){const t=document.getElementById("content"),e=document.createElement("div");e.setAttribute("id","headerDiv"),t.appendChild(e);const n=document.createElement("div");n.setAttribute("id","userContainer");const r=document.createElement("div");r.setAttribute("id","userPic");const i=document.createElement("div");i.setAttribute("id","userName"),n.appendChild(r),n.appendChild(i),e.appendChild(n),r.style.display="none",i.style.display="none";const o=document.createElement("div");o.setAttribute("id","signUpDiv"),n.appendChild(o),function(){let t=document.getElementById("signUpDiv");const e=document.createElement("button");e.setAttribute("id","signInButton"),e.textContent="Sign In With Google",e.addEventListener("click",(()=>{b.Z.auth().signInWithPopup(wb).then((t=>{t.credential.accessToken,t.user,yb("show")})).catch((t=>{t.code,t.message,t.email,t.credential}))})),t.appendChild(e)}();let s=document.createElement("img");s.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAALo0lEQVR4nO3de0xb1x0H8O/vXB7umMNCsmiritrIGEfK/uhKslQLkBpIUyWR1rXT2m0V3X/dOqldKqXUhCpkJRgSaV35Y1P+22i7PNSnttK1Mbg8MqUNUfNHI8UYq60yaVUepMRhBcK9v/0BJkAw+F7fh7HPR4oUm3vO+V3Oj3sN53EJWWhDa2jNTUE+ocFHBB8TPNBEMYjdANwA3AS4Gfg2ABBwg4E4Ev+Y4hDaKDFizIgw+EKhaypy/rmHRpw8LyuQ0wGkq6y5axW5XFUM1ICxhQAfgLUWNXeFgQjAp4kozOPj/cPNO69b1JYtVlwClHV0FYqxO6o0Zj8RagBsBqA4FI4K4AwzegRRWCv6pn/4mZ0TDsViyMpIAGYqC3bfT6TUE/gxBlY7HdJiCLjGjGOsUOfw8w98DCJ2OqblZHQC+F7qXa/lqU8AqAdQ5nQ8+nAUoFcV0KsXAv4vnI4mmYxMgPJgaDMg9jHwE6djMQMB7wLawaFA3RmnY1kocxKAmcqC4WoC7QPxdqfDsQTTSQYfHA74+zLl9pARCeBtD21nTewnYKvTsdiBgVMktAPRhrqTTsfiaAJ4WnpLRZ76JzAecTIOB72pqcqeWNO2i04F4EgCVBwZzL8+cv33APYDKHIihgwyBubmVWuKXzn71KabdjduewJ427qrwfRnABvtbjvDnSfWfjvUWNdvZ6O2JUDFkcH8+MjoSwxqsKvNlYiY2u6cxIsfNfunbGnPjkY8Lb2liqIeY+DHdrS30jFwilXlF3Z8NhBWN+BtDe8WQj0nOz91BGwVQj3nbevZZUNbFjlxQvHG1gYB7LWsjVxAOBQd7wuguVmzpnoLlHV0FYobrk4m/NyK+nMNA8dRNP6kFQNNpieAr33ArfHk22DUml13jgsJUfBIpKEybmalpiaA5/AH64Sa/z4Y95lZrzSNgLNq3s2dsb07LplYpznWt3TfnadQCCtu1G6l4eiUiu2fN9V+aUZtpiSA5/AH68RU/inIzrcJR7W8qUozrgRp/xroax9wK1P5XZCdbyPyKlP5Xb72AXe6NaWVAGUdXYUaT77NQEW6gUj6MFChaZNvlXV0FaZTj/EEOHFCETdcnfLTvqPqMOb6G5qbDfej4YLe2Nqg/D3feQQ85nVVB9Mor5+3NbwbxP8w2qhkAcLu6As17+kvppOnpbdUCPUcCCV6y0oWYoxomnKv3gEkXbeAiiOD+YqiHpOdn4EIJaSoRyuODObrKaYrAabH8+WoXqYiYGv8avwPOsukprw1VMUk+vSHJdmNWKtOdWZRSgkwM4fvUxiYxvX2rzdh4/f0/b1i8OLX+OXrn+ptCgDw91/9EJtKv2OobKZJ4/vw2aqSVfelMscwpVvA9aujz8LgHD69nQ8grQ7Mls4H0jqXH8RH4s+kcuCyCeBp6S0FUbPRSCRnMPhAWXv4ruWOWzYBhKK+DDl1eyUqItZeXu6gJRPA2x7aDuBR00KS7MX0s/JguG6pQ5InADOxJvabHpRkKwYv2YdJE2B6oWZurNXLcpXetu7qZF9MmgAE2mdNPJLtOHlfLpoA5cHQ5qxdop2bHpzec+F2Sa4AQv70ZxmNqHGx929LAN9LveuzZWcO6RZienhDMHzPwvdvS4CZPXmkLKSSdlvfzk8AZsL0hkxSNmLUz/TxrHkJUBbsvh8mz+4dvPi17jLnvzK++CWdspnG/HMhb9mhj7bMfSdv3pdJqQfM3bvI6KieUT/966Ct7a00pHI9gNOzrxP/md6B0/XfTN2EUTIHAde0ovHvJxaazt4CxNgdVbLzsx8Dq0XcVZl4PZsAGrPfmZAku7G41dezCTCz8bKUE8RsXxMws+V6oWsEzu26LdlLFaJgdaShMi4AgFyuKsjOzyUKq5NVwMwtgCEv/7lGI64BEp8BGFuWPFrKOgTaAswkwMxjVqTc4gMA2tAaWqOSuOJ0NJL9Cgon14ibguRPf46aGM/zCaHJy3+uIlJ8gkgmQK4ihi+PCR6TBwDnMbJW7/xXccOjekbWImaqdL4PKSF4BDRRbF0Lxta3pdOB2dL5gPXnwuBiMfM4VSknkVtg+lm6Uk5imQC5jAC3IJkAOYsZbpF4hLqUgwhuyx8ZI2U2QcANp4OQHMKICwayZyK9pAsR4gIyAXIWQyZAjqO4AJNMgJzFcQGhjVrZhFwbaJzV50Kg0TxixCwcDJRrAzMZIyaYEXE6DskZTIgITcgEyFXMakTkaywTIEcVuqYiBADeYM9lAGsdjkey1+VooGZdYmWQvArkngiQWBlE+NjRUCTbMfhj4NbKoB5nw5HsJph6gMTi0PHxfgCqoxFJdlJJKegHZhJguHnndQBnHA1JshF9EmmojANzdghhlreB3KHN9vWtTaKIws4EI9mNtFt9fWuTqKJv+gm45kxIkl0IuKa5xwcSr2cTYPiZnRMMOu5MWJJdmHEssUcgsGCnUGa1k0j8xswG5dpA46xYG8gKdc59PW9W8HCg9jSAYTMblGsDjTP/XDg6/PwD8/7oN39aOBEDmJchUhYhdM708azb1gUooFfti0iyk8LitYXv3ZYAFwL+Lwh4156QJLsw8TsXAv4vFr6fZGWQdtDieCSbKSQW7dNFE2AoUHcGTCetDUmy0YeRBv+iv04kXRvIYHkVyBaUvC+TJsBwwN/HwClrIpJsNBB9obYv2ReTrw4mYhLaAUtCkmxDoCX7cMnl4dGGupMA3jQ1Isk+xG8MBfyhpQ5Zdn8ATVX2ABgzLSjJLmNMYs9yBy2bALGmbRfB3GxKSJJtCLR/uMH/n+WOS2mHkFVril8BcN5IIHJtoHFpnMtn7hJ3RyoH0vKHTCtvDVUxiaSfJqXMQaxVDzXW9adybMp7BA011vUTuN14WJIdiKkt1c4HdCQAALhLil8k4N/6w5LswMCpOyfxop4yKd8CEjwtvaVCqOdAKNFbVrIQY0TTlHtjTdsu6imme5u46QboSb3lJIsJ1Ovt/OliBkQb/f8EcNhIWckChEPRF2reM1LU8EaRUc+VADFOGC0vmYOB49HxvoDR8ro/A8xV1tFVSP9zvQdGbTr1SIaFuGh899xZvnqllQAA4GsfcLM2GWagIt26pNQxY1BRCmoSS7yMSjsBAMBz+IN1YipvACCvGfVJy+Eoc/7W4cbqy+nWZMpm0bG9Oy5NqdgOcNSM+qSlcHRKxXYzOh8wKQEA4POm2i+1vKlKAs6aVac0HwFntbypys+bar80q05Tt4uP7d1xiUSBH4RuM+uVAAAhEgX+2N4dl8ys1PTnBUQaKuP8rfFdDMh1hiZh4HjBxJVd6X7gW4xidoUAMPL+6+pI1fq31uTffQeArVa0kTMIh4Yn+p6+3Py7KWuqt5i3rWcXNHTKsQPdroLwpNG/8KXK8gQApgeQSFGPkrwapISBUxD0eCozetJlyzODYk3bLhaXrPITU5sd7a1kDATvmqAH7Oh8wKYrwFwzM4v+AmCj3W1nuM+Itaf1TOYwg+0JAAAVRwbzr18dfRZEzQCKnIghg4wRaL+7xN1x9qlNN+1u3JEESPC09JYKRX0ZwKNOxuEY4jeYxB67LveLhuBUw3OVB8N1DN4PoNLpWGwyQKADyy3asENGJECCt627Gkz7ADzodCwW+RDEB5daq2e3jEqAhPJgaLNG1EhMDzsdixmY+B3B3DoUqMu43VgzMgESNgTD96ikPQFG/cobauYoCJ0Ki9cW25kjU2R0AsxiprJDH20hleuJ8DgDq50OaTEzG20eZUZnNOD/ZOGGTJloZSTAHGUdXYUi7qpkwX5A1AD8I1g0ppECFaBPAK2HNApr7vGBdKZnOWHFJcBCvvYBN6uTVRpxDYG2APAB+K5FzV0GEAHRadI4TEpBvxUjdHZa8QmwmI1//FfJxHiej0jxEcMHgofBxQC5AXYT4GaGG4TpnRgZcSLEpx+kTXGA4wQaBSPGhAgLXCjMnxg6/9xDIw6fmun+Dxx13scMMafiAAAAAElFTkSuQmCC",s.setAttribute("id","logoImg"),e.appendChild(s);const a=document.createElement("h1");a.setAttribute("id","header"),a.textContent="TODAY LIST",e.appendChild(a);const u=document.createElement("div");u.setAttribute("id","plusDiv"),e.appendChild(u);const c=document.createElement("div");c.setAttribute("id","plusProjectDiv"),u.appendChild(c);const h=document.createElement("button");h.setAttribute("id","plusProject"),h.setAttribute("class","plus"),h.textContent="New Project",c.appendChild(h),h.addEventListener("click",(()=>{bb(document.getElementsByClassName("inputNewProject")),_b("Project")}));const l=document.createElement("div");l.setAttribute("id","plusTaskDiv"),u.appendChild(l);const f=document.createElement("button");f.setAttribute("id","plusTask"),f.setAttribute("class","plus"),f.textContent="New Task",l.appendChild(f),f.addEventListener("click",(()=>{bb(document.getElementsByClassName("taskForm")),_b("task")}));const p=document.createElement("div");p.setAttribute("id","formsDiv"),e.appendChild(p);const d=document.createElement("div");d.setAttribute("id","container"),t.appendChild(d),function(){let t=document.createElement("form");t.setAttribute("name","newProjectForm"),t.setAttribute("class","inputNewProject"),t.setAttribute("id","newProjectForm");let e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("name","inputNewProject"),e.setAttribute("class","inputNewProject"),e.setAttribute("id","inputNewProject"),e.setAttribute("placeholder","New Project Name");let n=document.createElement("input");n.setAttribute("type","submit"),n.setAttribute("name","submitProject"),n.setAttribute("class","inputNewProject"),n.setAttribute("id","submitProject"),n.setAttribute("class","submit"),n.setAttribute("value","Submit"),n.addEventListener("click",(()=>{R()})),document.getElementById("formsDiv").appendChild(t),t.appendChild(e),t.appendChild(n)}(),function(){let t=document.createElement("form");t.setAttribute("name","taskForm"),t.setAttribute("class","taskForm"),t.setAttribute("id","taskForm");let e=document.createElement("input");e.setAttribute("type","text"),e.setAttribute("name","title"),e.setAttribute("class","taskForm"),e.setAttribute("id","title"),e.setAttribute("placeholder","Title");let n=document.createElement("select");n.setAttribute("name","inputProject"),n.setAttribute("id","inputProject"),n.setAttribute("class","taskForm"),n.setAttribute("placeholder","Project");for(let t=0;t<w.length;t++){let e=document.createElement("option");e.value=w[t],e.text=w[t],n.appendChild(e)}let r=document.createElement("Label");r.setAttribute("for",n),r.setAttribute("class","taskForm"),r.textContent="Project";let i=document.createElement("select");i.setAttribute("name","inputPriority"),i.setAttribute("id","inputPriority"),i.setAttribute("class","taskForm"),i.setAttribute("placeholder","Priority");for(let t=0;t<S.length;t++){let e=document.createElement("option");e.value=S[t],e.text=S[t],i.appendChild(e)}let o=document.createElement("Label");o.setAttribute("for",i),o.setAttribute("class","taskForm"),o.setAttribute("class","label"),o.textContent="Task Priority";let s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("name","description"),s.setAttribute("class","taskForm"),s.setAttribute("id","description"),s.setAttribute("placeholder","Description");let a=document.createElement("input");a.setAttribute("type","date"),a.setAttribute("name","inputDueDate"),a.setAttribute("id","inputDueDate"),a.setAttribute("class","taskForm"),a.setAttribute("placeholder","Due Date");let u=document.createElement("input");u.setAttribute("type","submit"),u.setAttribute("name","submit"),u.setAttribute("id","submit"),u.setAttribute("class","taskForm"),u.setAttribute("class","submit"),u.setAttribute("value","Submit"),u.addEventListener("click",(()=>{event.preventDefault(),O(new C(function(){let t=Math.floor(1e9*Math.random()+1);return t=t.toString(),t}(),taskForm.title.value,taskForm.inputProject.value,taskForm.description.value,new Date(taskForm.inputDueDate.value),taskForm.inputPriority.value)),taskForm.reset()})),t.appendChild(e),t.appendChild(r),t.appendChild(n),t.appendChild(s),t.appendChild(a),t.appendChild(o),t.appendChild(i),t.appendChild(u),document.getElementById("formsDiv").appendChild(t)}(),function(){let t=document.getElementsByClassName("inputNewProject"),e=document.getElementsByClassName("taskForm");bb(t),bb(e)}(),function(t,e){let n=document.createElement("div");n.setAttribute("class","modal"),n.setAttribute("id","myModal");let r=document.createElement("div");r.setAttribute("id","modal-content");let i=document.createElement("div");i.setAttribute("id","modalHeader");let o=document.createElement("button");o.setAttribute("id","closeModal"),o.textContent="x";let s=document.createElement("h2");s.setAttribute("id","modalHeaderText"),s.textContent="Edit Task";let a=document.createElement("div");a.setAttribute("id","modalBody");let u=document.createElement("form");u.setAttribute("id","editForm"),u.setAttribute("name","editForm");let c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("name","editTitle"),c.setAttribute("class","editFormInput"),c.setAttribute("id","editTitle"),c.setAttribute("placeholder","Edit Title");let h=document.createElement("div");h.setAttribute("id","editPriorityDiv");let l=document.createElement("select");l.setAttribute("name","editPriority"),l.setAttribute("id","editPriority"),l.setAttribute("class","editFormInput");for(let t=0;t<S.length;t++){let e=document.createElement("option");e.value=S[t],e.text=S[t],l.appendChild(e)}let f=document.createElement("Label");f.setAttribute("for",l),f.setAttribute("class","editFormInput"),f.setAttribute("id","editPriorityLabel"),f.textContent="Priority";let p=document.createElement("input");p.setAttribute("type","text"),p.setAttribute("name","editDescription"),p.setAttribute("class","editFormInput"),p.setAttribute("id","editDescription"),p.setAttribute("placeholder","Edit Description");let d=document.createElement("input");d.setAttribute("type","date"),d.setAttribute("name","editDueDate"),d.setAttribute("id","editDueDate"),d.setAttribute("class","editFormInput"),d.setAttribute("placeholder","Due Date");let v=document.createElement("input");v.setAttribute("type","submit"),v.setAttribute("name","submitEdit"),v.setAttribute("id","submitEdit"),v.setAttribute("class","editFormInput"),v.setAttribute("value","Submit"),u.appendChild(c),u.appendChild(p),u.appendChild(d),h.appendChild(f),h.appendChild(l),u.appendChild(h),u.appendChild(v);let y=document.createElement("div");y.setAttribute("id","modalFooter");let g=document.createElement("h3");g.setAttribute("id","modalFooterText"),n.appendChild(r),r.appendChild(i),r.appendChild(o),r.appendChild(s),r.appendChild(a),a.appendChild(u),r.appendChild(y),y.appendChild(g),document.getElementById("container").appendChild(n)}(),mb.addEventListener("click",(()=>{"none"===gb.style.display?gb.style.display="block":gb.style.display="none"}))}();var wb=new b.Z.auth.GoogleAuthProvider;b.Z.auth().onAuthStateChanged((t=>{t?(t.uid,console.log("signed in"),document.getElementById("signInButton").style.display="none",function(){let t=document.getElementById("signUpDiv"),e=document.getElementById("userPic"),n=document.getElementById("userName");const r=document.createElement("button");r.setAttribute("id","signOutButton"),r.textContent="Sign Out",r.addEventListener("click",(()=>{!function(){let t=document.getElementById("container");for(let e=0;e<w.length;e++){let n=document.getElementById("project"+e);t.removeChild(n)}w=[],E=[]}(),b.Z.auth().signOut(),r.style.display="none",document.getElementById("signInButton").style.display="block",e.style.display="none",n.style.display="none",yb("hide")})),t.appendChild(r)}(),function(){let t=document.getElementById("userPic"),e=document.getElementById("userName");var n,r=b.Z.auth().currentUser.photoURL||"/images/profile_placeholder.png",i=b.Z.auth().currentUser.displayName;t.style.backgroundImage="url("+(-1!==(n=r).indexOf("googleusercontent.com")&&-1===n.indexOf("?")?n+"?sz=150":n)+")",e.textContent=i,t.style.display="block",e.style.display="block"}(),function(){let t,e=b.Z.auth().currentUser;if(null!=e){t=e.uid;let n=Eb.collection("users").doc(t);n.get().then((t=>{t.exists?(console.log("Documents Exist",t.data()),_()):(console.log("No such document. Creating document..."),n.set({projects:["Sample Project"]}),function(){let t,e=b.Z.auth().currentUser;e&&(t=e.uid,Eb.collection("users").doc(t).get().then((t=>{if(t.exists){let e=t.data().projects;w=e,console.log(w),N(),O(new C("0000001","A Sample Task","Sample Project","To complete this Sample Task",new Date,"Medium"))}else console.log("no such document")})).catch((t=>{console.log("Error getting document:",t)})))}())})).catch((t=>{console.error("Error adding document: ",t)}))}}()):(console.log("signed out"),yb("hide"))}));var Eb=b.Z.firestore()})()})();